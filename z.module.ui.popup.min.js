zjs.require("ui",function(){function F(){y||(y=!0,zjs(document).on("keyup",function(b){27==b.getKeyCode()&&z(A)}))}function G(){if(!B){B=!0;var b;zjs(document).on("touchstart",function(d){b=window.scrollY}).on("touchend",function(d){100>b&&-50>window.scrollY&&(b=9999,z(C))})}}function z(b){for(var d=!1;0<b.length&&!(d=b.pop(),d=zjs('.zui-popup[data-show-instance="'+d+'"]'),0<d.count());)d=!1;d&&(event.preventDefault(),d.popupHide())}zjs.extendCore({moduleUiPopupOption:{width:"auto",height:"auto",
autoshow:!1,autoshowDelay:0,closebutton:!0,closethenremove:!1,pagecover:!0,hidePagecoverWhenWindowWidthLessThan:0,pagecoverClass:"",clickout:!1,pressEsc:!0,pullDown:!1,center:!0,centerY:!1,fade:!0,fadeCover:!1,fadeTime:500,animate:!1,animateTime:1E3,animateName:"",longPopup:"mobileOnly",scrollPopup:!0,disableWindowScroll:!1}});var w=function(){var b=!1;try{top.document.body.offsetTop=top.document.body.offsetTop,b=!0}catch(d){}b?isNaN(top.popuplastindex)&&(top.popuplastindex=1E4):isNaN(window.popuplastindex)&&
(window.popuplastindex=1E4);return function(){return b?top.popuplastindex++:window.popuplastindex++}}(),A=[],C=[],n=[],q=0,l=zjs(window),m=!1,H=function(b,d){var c=zjs(b),a=c.getData("zmoduleuipopupoption");if(a)c.setData("zmoduleuipopupoption",zjs.extend(a,d)),a.animate&&a.animateTime&&c.setStyle("animation-duration",a.animateTime+"ms");else{a=zjs.clone(zjs.moduleUiPopupOption);var e=c.getAttr("data-option","");zjs.isString(e)&&""!=e.trim()&&(a=zjs.extend(a,e.jsonDecode()));c.removeAttr("data-option");
"undefined"!=typeof d&&(a=zjs.extend(a,d));a.fadeTime=parseInt(a.fadeTime);a.animate&&(a.fade=!(a.fadeCover=!0));a.animateTime=parseInt(a.animateTime);a.animateCoverTime=parseInt(a.animateCoverTime);"mobileOnly"===a.scrollPopup&&(a.longPopup="mobileOnly",a.scrollPopup=!1);"mobileOnly"===a.longPopup&&(a.longPopup=zjs.isMobileDevice());!0===a.longPopup&&(a.centerY=a.scrollPopup=!1);a.autoshow=!!a.autoshow;a.autoshowDelay=parseInt(a.autoshowDelay);isNaN(a.autoshowDelay)&&(a.autoshowDelay=0);a.hidePagecoverWhenWindowWidthLessThan=
parseInt(a.hidePagecoverWhenWindowWidthLessThan);0>a.hidePagecoverWhenWindowWidthLessThan&&(a.hidePagecoverWhenWindowWidthLessThan=0);c.setData("zmoduleuipopupoption",a);var f=zjs.enablehook();zjs.enablehook(!1);c.addClass("zui-popup");a.center&&c.addClass("zui-popup-center");a.animate&&c.addClass(a.animateName).setStyle("animation-duration",a.animateTime+"ms");(a.longPopup||a.scrollPopup)&&c.appendTo(document.body);e=zjs();!1!==a.scrollPopup&&(e=zjs("<div>").addClass("zui-popup-scrollwrap").hide(),
e.insertBefore(c),e.append(c));c.setData("zmoduleuipopupscrollwrapel",e);var g=zjs();if(a.pagecover){g=zjs("<div>").addClass("zui-popup-page-cover");var h=c.getAttr("id","");""!=h&&g.addClass("zui-popup-page-cover-"+h);a.pagecoverClass&&g.addClass(a.pagecoverClass)}c.setData("zmoduleuipopupcoverel",g);var p=zjs("<div>").addClass("zui-popup-wrapper");c.child().eachElement(function(a){p.append(a)});c.append(p);zjs.enablehook(f);f=c.find(".zpopupclose");0==f.count()&&a.closebutton&&(f=zjs('<a class="zui-popup-close">\u00d7</a>').prependTo(c));
f.click(function(a,c){zjs(this).hasClass("disabled")||r(b)});c.removeClass("zui-uiuninithide zui-uiuninithideh zpopupuninithide zpopupuninithideh");a.autoshow?(c.addClass("zui-popup-hide"),function(){D(b)}.delay(a.autoshowDelay)):(c.addClass("active"),r(b,!0,!0));l.on("resize",function(){t(b)}).on("scroll",function(){t(b)});a.clickout&&(g.click(function(){r(b)}),!1!==a.scrollPopup&&e.click(function(a){a.target()===this.item(0,1)&&r(b)}))}},u=!1,v=!1,D=function(b,d){var c=zjs(b),a=c.getData("zmoduleuipopupoption");
if(a&&!c.hasClass("active")){var e=!0;0<a.hidePagecoverWhenWindowWidthLessThan&&l.width()<=a.hidePagecoverWhenWindowWidthLessThan&&(e=!1);if(e)var f=c.getData("zmoduleuipopupcoverel").insertBefore(c).hide().setStyle("z-index",w());c.removeClass("zui-popup-hide").setStyle("z-index",w());var g=!!zjs(document.body).getData("zmodulescrollbaroption",!1),h=g?zjs(document.body).scrollPosition():zjs(document.body).scrollTop();c.setData("zmoduleuipopupscrolltop",h);var p=zjs.getUniqueId();c.setAttr("data-show-instance",
p);if(a.longPopup){e=zjs.enablehook();zjs.enablehook(!1);c.addClass("zui-long-popup");if(0===n.length){var k=zjs("<div></div>"),x=[];if(f=g?zjs(document.body).getData("zmodulescrollbarcontentel",!1):zjs(document.body))f.child().eachElement(function(a){if("SCRIPT"==a.tagName||"LINK"==a.tagName||zjs(a).hasClass("zui-popup")||zjs(a).hasClass("zui-popup-page-cover")||zjs(a).hasClass("zpreventlongpopup")||zjs(a).hasClass("zui-freezing")||"fb-root"==zjs(a).getAttr("id")){if(zjs(a).hasClass("zui-freezing")){zjs(a).freezepanelDisableHandler(!0);
var b=zjs("<span></span>").appendTo(k);zjs(a).setData("zlongpopupswapel",b);x.push(a)}}else k.append(a)}),m||(m=zjs("<div></div>").setStyle({position:"fixed",width:"100%",height:"100%",overflow:"hidden",top:0})),zjs(document.body).prepend(m),k.addClass("zui-long-popup-fixed-content-wrap").setStyle({position:"absolute",width:"100%"}).top(-h).appendTo(m),g?zjs(document.body).refreshScroll().scrollTo(0,!0):document.body.scrollTop=0,c.setData("zmoduleuipopupfixedbodyel",k),zjs(document.body).setStyle("scrollTop",
0).addClass("zui-long-popup-is-open");k.find(".zpreventlongpopup,.zui-freezing").eachElement(function(a){var b=zjs("<span></span>").insertBefore(a);zjs(a).setData("zlongpopupswapel",b).insertBefore(m);x.push(a)});c.setData("zlongpopuplistelswap",x)}else k=zjs("<div></div>"),g=zjs('.zui-long-popup[data-show-instance="'+n.last()+'"]'),k.append(g.getData("zmoduleuipopupcoverel")),k.append(g),k.setStyle({position:"absolute",width:"100%"}).top(-h).appendTo(m),c.setData("zmoduleuipopupfixedbodyel",k),zjs(document.body).setStyle("scrollTop",
0);n.push(p);zjs.enablehook(e)}else a.scrollPopup?(h=c.addClass("zui-long-popup").getData("zmoduleuipopupscrollwrapel").show().setStyle("scrollTop",0).setStyle("z-index",w()),e&&f.insertBefore(h),0===q&&(zjs(document.body).addClass("zui-scroll-popup-is-open"),h=I(),0<h&&(g=zjs(document.body).getStyle("padding-right").toInt(),0<g&&(zjs(document.body).setData("data-bakpdr",g),h+=g),zjs(document.body).setStyle("padding-right",h))),q++):c.removeClass("zui-long-popup");h=0;E(b);a.fade&&(c.fadeIn({time:a.fadeTime}),
h=a.fadeTime);a.fadeCover?c.getData("zmoduleuipopupcoverel").fadeIn({time:a.fadeTime}):c.getData("zmoduleuipopupcoverel").show();a.animate&&(window.clearTimeout(u),window.clearTimeout(v),c.addClass("showing zanimate zanimate-start"),u=function(){c.addClass("zanimate-end")}.delay(a.animateTime),v=function(){c.removeClass("showing zanimate zanimate-start zanimate-end")}.delay(a.animateTime+100),h=a.animateTime);c.addClass("active").trigger("ui:popup:show");c.hasClass("zui-popup-center")&&t(b);a.pressEsc&&
(F(),A.push(p));a.pullDown&&a.longPopup&&zjs.isMobileDevice()&&(G(),C.push(p));(function(){c.find(".autofocus").focus();a.disableWindowScroll&&"disableScroll"in l&&("mobileOnly"===a.disableWindowScroll?zjs.isMobileDevice()&&l.disableScroll():l.disableScroll());c.getData("zmoduleuipopupcoverel").addClass("active");d&&zjs.isFunction(d.callback)&&d.callback.call(c,b);c.trigger("ui:popup:aftershow")}).delay(h+100)}},r=function(b,d,c){var a=zjs(b),e=a.getData("zmoduleuipopupoption");if(e&&a.hasClass("active")&&
!a.hasClass("zui-popup-hide")){a.trigger("ui:popup:beforehide");a.getData("zmoduleuipopupcoverel").removeClass("active");e.disableWindowScroll&&"enableScroll"in l&&("mobileOnly"===e.disableWindowScroll?zjs.isMobileDevice()&&l.enableScroll():l.enableScroll());var f=function(){a.addClass("zui-popup-hide");a.removeClass("active").trigger("ui:popup:hide");var b=a.getData("zmoduleuipopupfixedbodyel",!1);if(b){var d=!!zjs(document.body).getData("zmodulescrollbaroption",!1),f=a.getData("zmoduleuipopupscrolltop",
0);n.length&&n.pop();0===n.length?(a.setData("zmoduleuipopupfixedbodyel",!1),d&&zjs(document.body).getData("zmodulescrollbarcontentel",!1).prepend(b),b.child().eachElement(function(a){zjs(a).insertBefore(m)}),b.remove(),m.remove(),d?zjs(document.body).refreshScroll().scrollTo(f,!0):zjs(document.body).setStyle("scrollTop",f),zjs(document.body).removeClass("zui-long-popup-is-open"),d=a.getData("zlongpopuplistelswap",[]),0<d.length&&d.eachItem(function(a){var b=zjs(a).getData("zlongpopupswapel",!1);
b&&zjs(a).insertBefore(b);b.remove();zjs(a).hasClass("zui-freezing")&&zjs(a).freezepanelDisableHandler(!1)})):(b=zjs('.zui-long-popup[data-show-instance="'+n.last()+'"]'),zjs(document.body).append(b.getData("zmoduleuipopupcoverel")),zjs(document.body).append(b),a.getData("zmoduleuipopupfixedbodyel").remove(),zjs(document.body).setStyle("scrollTop",0),d||zjs(document.body).setStyle("scrollTop",f))}!c&&e.closethenremove&&(!1!==e.scrollPopup?a.getData("zmoduleuipopupscrollwrapel").remove():a.remove())};
b=function(){if(a){var b=a.getData("zmoduleuipopupcoverel");b&&b.remove(!1);!1!==e.scrollPopup&&(a.getData("zmoduleuipopupscrollwrapel").hide(),0<q&&q--,0===q&&zjs(document.body).removeClass("zui-scroll-popup-is-open").setStyle("padding-right",""))}};d=d||!1;!d&&e.fadeCover?a.getData("zmoduleuipopupcoverel").fadeOut({time:e.fadeTime,callback:b}):b();d||!e.fade||e.animate?!d&&e.animate?(window.clearTimeout(u),window.clearTimeout(v),a.addClass("hiding zanimate zanimate-start"),u=function(){a.addClass("zanimate-end")}.delay(e.animateTime),
v=function(){a.removeClass("hiding zanimate zanimate-start zanimate-end");f()}.delay(e.animateTime+100)):f():a.fadeOut({time:e.fadeTime,callback:f});a.removeAttr("data-show-instance")}},E=function(b){var d=zjs(b);d.getData("zmoduleuipopupoption")&&!d.hasClass("zui-popup-hide")&&(d.hasClass("zui-popup-center")&&t(b),d.trigger("ui:popup:refresh"))},t=function(b){var d=zjs(b),c=d.getData("zmoduleuipopupoption");if(c&&d.hasClass("zui-popup-center"))if(b=l.height()-d.height(),c.longPopup||c.scrollPopup)0<
b?d.setStyle("margin-top",b/2):d.setStyle("margin-top",""),function(){d.find(".zfreezepanel").trigger("trigger:refreshpanel")}.delay(100);else{if(0<b){var a=-d.height()/2;c.centerY||(a-=b/6)}else c=d.getData("zmoduleuipopupscrolltop")-document.body.scrollTop,c<b&&(c=b),0<c&&(c=0),a=-d.height()/2-b/2+c;d.setStyle("margin-top",a);d.setStyle("margin-left",-d.width()/2)}},I=function(){var b=zjs('<div style="width:50px;height:50px;overflow:hidden;position:absolute;top:-200px;left:-200px;"><div style="height:100px;"></div>');
zjs(document.body).append(b);var d=b.item(0,!0).offsetWidth;b.setStyle("overflow","scroll");var c=b.item(0,!0).clientWidth;b.remove();return d-c},y=!1,B=!1;zjs.extendMethod({makePopup:function(b){return this.eachElement(function(d){H(d,b)})},popupShow:function(b){return this.eachElement(function(d){D(d,b)})},popupHide:function(){return this.eachElement(function(b){r(b)})},popupRefresh:function(){return this.eachElement(function(b){E(b)})},popupBackdrop:function(){return this.getData("zmoduleuipopupcoverel")}});
zjs.hook({after_setInnerHTML:function(b){zjs(b).find(".zpopup").makePopup();zjs(b).parent().popupRefresh().parent().popupRefresh().parent().popupRefresh()},after_insertDOM:function(b){zjs(b).hasClass("zpopup")&&zjs(b).makePopup();zjs(b).find(".zpopup").makePopup();zjs(b).parent().popupRefresh().parent().popupRefresh().parent().popupRefresh()}});zjs.onready(function(){zjs(".zpopup").makePopup()});"required"in zjs&&zjs.required("ui.popup")});