zjs.require("ui",function(){zjs.extendCore({moduleUiPopupOption:{width:"auto",height:"auto",autoshow:!1,closebutton:!0,closethenremove:!1,pagecover:!0,clickout:!1,pressEsc:!0,center:!0,centerY:!1,fade:!0,fadeCover:!1,fadeTime:500,animate:!1,animateTime:1E3,animateName:"",longPopup:!1}});var p=function(){var a=!1;try{top.document.body.offsetTop=top.document.body.offsetTop,a=!0}catch(b){}a?isNaN(top.popuplastindex)&&(top.popuplastindex=1E4):isNaN(window.popuplastindex)&&(window.popuplastindex=1E4);
return function(){return a?top.popuplastindex++:window.popuplastindex++}}();window.zpopupelementstack=[];var q=function(a){return"mobileOnly"===a?zjs.isMobileDevice():a},u=function(a,b){var d=zjs(a),c=d.getData("zmoduleuipopupoption");if(c)d.setData("zmoduleuipopupoption",zjs.extend(c,b));else{var c=zjs.clone(zjs.moduleUiPopupOption),e=d.getAttr("data-option","");zjs.isString(e)&&""!=e.trim()&&(c=zjs.extend(c,e.jsonDecode()));d.removeAttr("data-option");"undefined"!=typeof b&&(c=zjs.extend(c,b));
c.fadeTime=parseInt(c.fadeTime);c.animate&&(c.fade=!(c.fadeCover=!0));c.animateTime=parseInt(c.animateTime);c.animateCoverTime=parseInt(c.animateCoverTime);"mobileOnly"!==c.longPopup&&(c.longPopup=!!c.longPopup);c.longPopup&&(c.centerY=!1);d.setData("zmoduleuipopupoption",c);e=zjs.enablehook();zjs.enablehook(!1);d.addClass("zui-popup");c.center&&d.addClass("zui-popup-center");c.animate&&d.addClass(c.animateName).setStyle("animation-duration",c.animateTime+"ms");var f=zjs();if(c.pagecover){var f=zjs("<div>").addClass("zui-popup-page-cover"),
g=d.getAttr("id","");""!=g&&f.addClass("zui-popup-page-cover-"+g);c.clickout&&f.click(function(){k(a)})}d.setData("zmoduleuipopupcoverel",f);var h=zjs("<div>").addClass("zui-popup-wrapper");d.child().eachElement(function(a){h.append(a)});d.append(h);zjs.enablehook(e);e=d.find(".zpopupclose");0==e.count()&&c.closebutton&&(e=zjs('<a class="zui-popup-close">\u00d7</a>').prependTo(d));e.click(function(b,c){zjs(this).hasClass("disabled")||k(a)});c.autoshow?r(a):(d.addClass("active"),k(a,!0,!0));d.removeClass("zui-uiuninithide zui-uiuninithideh");
zjs(window).on("resize",function(){l(a)}).on("scroll",function(){l(a)})}},m=!1,n=!1,r=function(a){var b=zjs(a),d=b.getData("zmoduleuipopupoption");if(d&&!b.hasClass("active")){b.getData("zmoduleuipopupcoverel").insertBefore(b).setStyle("z-index",p());b.removeClass("zui-popup-hide").setStyle("z-index",p());var c=!!zjs(document.body).getData("zmodulescrollbaroption",!1),e=c?zjs(document.body).scrollPosition():document.body.scrollTop;b.setData("zmoduleuipopupscrolltop",e);if(q(d.longPopup)){b.addClass("zui-long-popup");
var f=zjs("<div></div>"),g=c?zjs(document.body).getData("zmodulescrollbarcontentel",!1):zjs(document.body);g&&(g.child().eachElement(function(a){"SCRIPT"==a.tagName||"LINK"==a.tagName||zjs(a).hasClass("zui-popup")||zjs(a).hasClass("zui-popup-page-cover")||zjs(a).hasClass("zpreventlongpopup")||"fb-root"==zjs(a).getAttr("id")||f.append(a)}),zjs(document.body).prepend(f),f.setStyle({position:"fixed",width:"100%",height:"100%"}),f.top(-e),c?zjs(document.body).refreshScroll().scrollTo(0,!0):document.body.scrollTop=
0,b.setData("zmoduleuipopupfixedbodyel",f),zjs(document.body).addClass("zui-long-popup-is-open"));var h=[];f.find(".zpreventlongpopup").eachElement(function(a){var b=zjs("<span></span>").insertBefore(a);zjs(a).setData("zlongpopupswapel",b).insertBefore(f);h.push(a)});b.setData("zlongpopuplistelswap",h)}else b.removeClass("zui-long-popup");t(a);d.fade&&b.fadeIn({time:d.fadeTime});d.fadeCover&&b.getData("zmoduleuipopupcoverel").fadeIn({time:d.fadeTime});d.animate&&(window.clearTimeout(m),window.clearTimeout(n),
b.addClass("showing zanimate zanimate-start"),m=function(){b.addClass("zanimate-end")}.delay(d.animateTime),n=function(){b.removeClass("showing zanimate zanimate-start zanimate-end")}.delay(d.animateTime+100));b.addClass("active").trigger("ui:popup:show");b.hasClass("zui-popup-center")&&l(a);d.pressEsc&&(a=zjs.getUniqueId(),b.setAttr("data-show-instance",a),window.zpopupelementstack.push(a));(function(){b.find(".autofocus").focus()}).delay(500)}},k=function(a,b,d){var c=zjs(a),e=c.getData("zmoduleuipopupoption");
if(e&&c.hasClass("active")&&!c.hasClass("zui-popup-hide")){var f=function(){c.addClass("zui-popup-hide");c.removeClass("active").trigger("ui:popup:hide");var a=c.getData("zmoduleuipopupfixedbodyel",!1);if(a){var b=!!zjs(document.body).getData("zmodulescrollbaroption",!1);c.setData("zmoduleuipopupfixedbodyel",!1);b&&zjs(document.body).getData("zmodulescrollbarcontentel",!1).prepend(a);a.child().eachElement(function(b){zjs(b).insertBefore(a)});a.remove();b?zjs(document.body).refreshScroll().scrollTo(c.getData("zmoduleuipopupscrolltop",
0),!0):document.body.scrollTop=c.getData("zmoduleuipopupscrolltop",0);zjs(document.body).removeClass("zui-long-popup-is-open");b=c.getData("zlongpopuplistelswap",[]);0<b.length&&b.eachElement(function(a){var b=zjs(a).getData("zlongpopupswapel",!1);b&&zjs(a).insertBefore(b);b.remove()})}!d&&e.closethenremove&&c.remove()};a=function(){if(c){var a=c.getData("zmoduleuipopupcoverel");a&&a.remove(!1)}};b=b||!1;!b&&e.fadeCover?c.getData("zmoduleuipopupcoverel").fadeOut({time:e.fadeTime,callback:a}):a();
b||!e.fade||e.animate?!b&&e.animate?(window.clearTimeout(m),window.clearTimeout(n),c.addClass("hiding zanimate zanimate-start"),m=function(){c.addClass("zanimate-end")}.delay(e.animateTime),n=function(){c.removeClass("hiding zanimate zanimate-start zanimate-end");f()}.delay(e.animateTime+100)):f():c.fadeOut({time:e.fadeTime,callback:f});c.removeAttr("data-show-instance")}},t=function(a){var b=zjs(a);b.getData("zmoduleuipopupoption")&&!b.hasClass("zui-popup-hide")&&(b.hasClass("zui-popup-center")&&
l(a),b.trigger("ui:popup:refresh"))},l=function(a){var b=zjs(a),d=b.getData("zmoduleuipopupoption");if(d&&b.hasClass("zui-popup-center"))if(a=zjs(window).height()-b.height(),q(d.longPopup))0<a?b.setStyle("margin-top",a/2):b.setStyle("margin-top",""),function(){b.find(".zfreezepanel").trigger("trigger:refreshpanel")}.delay(100);else{if(0<a){var c=-b.height()/2;d.centerY||(c-=a/6)}else d=b.getData("zmoduleuipopupscrolltop")-document.body.scrollTop,d<a&&(d=a),0<d&&(d=0),c=-b.height()/2-a/2+d;b.setStyle("margin-top",
c);b.setStyle("margin-left",-b.width()/2)}};zjs(document).on("keyup",function(a){if(27==a.getKeyCode()){for(var b=!1;0<window.zpopupelementstack.length&&!(b=window.zpopupelementstack.pop(),b=zjs('.zui-popup[data-show-instance="'+b+'"]'),0<b.count());)b=!1;b&&(a.preventDefault(),b.popupHide())}});zjs.extendMethod({makePopup:function(a){return this.eachElement(function(b){u(b,a)})},popupShow:function(){return this.eachElement(function(a){r(a)})},popupHide:function(){return this.eachElement(function(a){k(a)})},
popupRefresh:function(){return this.eachElement(function(a){t(a)})}});zjs.hook({after_setInnerHTML:function(a){zjs(a).find(".zpopup").makePopup();zjs(a).parent().popupRefresh().parent().popupRefresh().parent().popupRefresh()},after_insertDOM:function(a){zjs(a).hasClass("zpopup")&&zjs(a).makePopup();zjs(a).find(".zpopup").makePopup();zjs(a).parent().popupRefresh().parent().popupRefresh().parent().popupRefresh()}});zjs.onready(function(){zjs(".zpopup").makePopup()});"required"in zjs&&zjs.required("ui.popup")});