zjs.require("ui",function(){function E(){x||(x=!0,zjs(document).on("keyup",function(c){27==c.getKeyCode()&&y(z)}))}function F(){if(!A){A=!0;var c;zjs(document).on("touchstart",function(b){c=window.scrollY}).on("touchend",function(b){100>c&&-50>window.scrollY&&(c=9999,y(B))})}}function y(c){for(var b=!1;0<c.length&&!(b=c.pop(),b=zjs('.zui-popup[data-show-instance="'+b+'"]'),0<b.count());)b=!1;b&&(event.preventDefault(),b.popupHide())}zjs.extendCore({moduleUiPopupOption:{width:"auto",height:"auto",
autoshow:!1,autoshowDelay:0,closebutton:!0,closethenremove:!1,pagecover:!0,hidePagecoverWhenWindowWidthLessThan:0,pagecoverClass:"",clickout:!1,pressEsc:!0,pullDown:!1,center:!0,centerY:!1,fade:!0,fadeCover:!1,fadeTime:500,animate:!1,animateTime:1E3,animateName:"",longPopup:"mobileOnly",scrollPopup:!0,disableWindowScroll:!1}});var v=function(){var c=!1;try{top.document.body.offsetTop=top.document.body.offsetTop,c=!0}catch(b){}c?isNaN(top.popuplastindex)&&(top.popuplastindex=1E4):isNaN(window.popuplastindex)&&
(window.popuplastindex=1E4);return function(){return c?top.popuplastindex++:window.popuplastindex++}}(),z=[],B=[],m=[],p=0,k=zjs(window),l=!1,G=function(c,b){var d=zjs(c),a=d.getData("zmoduleuipopupoption");if(a)d.setData("zmoduleuipopupoption",zjs.extend(a,b));else{a=zjs.clone(zjs.moduleUiPopupOption);var e=d.getAttr("data-option","");zjs.isString(e)&&""!=e.trim()&&(a=zjs.extend(a,e.jsonDecode()));d.removeAttr("data-option");"undefined"!=typeof b&&(a=zjs.extend(a,b));a.fadeTime=parseInt(a.fadeTime);
a.animate&&(a.fade=!(a.fadeCover=!0));a.animateTime=parseInt(a.animateTime);a.animateCoverTime=parseInt(a.animateCoverTime);"mobileOnly"===a.scrollPopup&&(a.longPopup="mobileOnly",a.scrollPopup=!1);"mobileOnly"===a.longPopup&&(a.longPopup=zjs.isMobileDevice());!0===a.longPopup&&(a.centerY=a.scrollPopup=!1);a.autoshow=!!a.autoshow;a.autoshowDelay=parseInt(a.autoshowDelay);isNaN(a.autoshowDelay)&&(a.autoshowDelay=0);a.hidePagecoverWhenWindowWidthLessThan=parseInt(a.hidePagecoverWhenWindowWidthLessThan);
0>a.hidePagecoverWhenWindowWidthLessThan&&(a.hidePagecoverWhenWindowWidthLessThan=0);d.setData("zmoduleuipopupoption",a);var f=zjs.enablehook();zjs.enablehook(!1);d.addClass("zui-popup");a.center&&d.addClass("zui-popup-center");a.animate&&d.addClass(a.animateName).setStyle("animation-duration",a.animateTime+"ms");(a.longPopup||a.scrollPopup)&&d.appendTo(document.body);e=zjs();!1!==a.scrollPopup&&(e=zjs("<div>").addClass("zui-popup-scrollwrap").hide(),e.insertBefore(d),e.append(d));d.setData("zmoduleuipopupscrollwrapel",
e);var g=zjs();if(a.pagecover){g=zjs("<div>").addClass("zui-popup-page-cover");var n=d.getAttr("id","");""!=n&&g.addClass("zui-popup-page-cover-"+n);a.pagecoverClass&&g.addClass(a.pagecoverClass)}d.setData("zmoduleuipopupcoverel",g);var h=zjs("<div>").addClass("zui-popup-wrapper");d.child().eachElement(function(a){h.append(a)});d.append(h);zjs.enablehook(f);f=d.find(".zpopupclose");0==f.count()&&a.closebutton&&(f=zjs('<a class="zui-popup-close">\u00d7</a>').prependTo(d));f.click(function(a,b){zjs(this).hasClass("disabled")||
q(c)});d.removeClass("zui-uiuninithide zui-uiuninithideh zpopupuninithide zpopupuninithideh");a.autoshow?(d.addClass("zui-popup-hide"),function(){C(c)}.delay(a.autoshowDelay)):(d.addClass("active"),q(c,!0,!0));k.on("resize",function(){r(c)}).on("scroll",function(){r(c)});a.pressEsc&&E();a.pullDown&&F();a.clickout&&(g.click(function(){q(c)}),!1!==a.scrollPopup&&e.click(function(a){a.target()===this.item(0,1)&&q(c)}))}},t=!1,u=!1,C=function(c){var b=zjs(c),d=b.getData("zmoduleuipopupoption");if(d&&
!b.hasClass("active")){var a=!0;0<d.hidePagecoverWhenWindowWidthLessThan&&k.width()<=d.hidePagecoverWhenWindowWidthLessThan&&(a=!1);if(a)var e=b.getData("zmoduleuipopupcoverel").insertBefore(b).hide().setStyle("z-index",v());b.removeClass("zui-popup-hide").setStyle("z-index",v());var f=!!zjs(document.body).getData("zmodulescrollbaroption",!1),g=f?zjs(document.body).scrollPosition():zjs(document.body).scrollTop();b.setData("zmoduleuipopupscrolltop",g);var n=zjs.getUniqueId();b.setAttr("data-show-instance",
n);if(d.longPopup){a=zjs.enablehook();zjs.enablehook(!1);b.addClass("zui-long-popup");if(0===m.length){var h=zjs("<div></div>"),w=[];if(e=f?zjs(document.body).getData("zmodulescrollbarcontentel",!1):zjs(document.body))e.child().eachElement(function(a){if("SCRIPT"==a.tagName||"LINK"==a.tagName||zjs(a).hasClass("zui-popup")||zjs(a).hasClass("zui-popup-page-cover")||zjs(a).hasClass("zpreventlongpopup")||zjs(a).hasClass("zui-freezing")||"fb-root"==zjs(a).getAttr("id")){if(zjs(a).hasClass("zui-freezing")){zjs(a).freezepanelDisableHandler(!0);
var b=zjs("<span></span>").appendTo(h);zjs(a).setData("zlongpopupswapel",b);w.push(a)}}else h.append(a)}),l||(l=zjs("<div></div>").setStyle({position:"fixed",width:"100%",height:"100%",overflow:"hidden",top:0})),zjs(document.body).prepend(l),h.addClass("zui-long-popup-fixed-content-wrap").setStyle({position:"absolute",width:"100%"}).top(-g).appendTo(l),f?zjs(document.body).refreshScroll().scrollTo(0,!0):document.body.scrollTop=0,b.setData("zmoduleuipopupfixedbodyel",h),zjs(document.body).setStyle("scrollTop",
0).addClass("zui-long-popup-is-open");h.find(".zpreventlongpopup,.zui-freezing").eachElement(function(a){var b=zjs("<span></span>").insertBefore(a);zjs(a).setData("zlongpopupswapel",b).insertBefore(l);w.push(a)});b.setData("zlongpopuplistelswap",w)}else h=zjs("<div></div>"),f=zjs('.zui-long-popup[data-show-instance="'+m.last()+'"]'),h.append(f.getData("zmoduleuipopupcoverel")),h.append(f),h.setStyle({position:"absolute",width:"100%"}).top(-g).appendTo(l),b.setData("zmoduleuipopupfixedbodyel",h),zjs(document.body).setStyle("scrollTop",
0);m.push(n);zjs.enablehook(a)}else d.scrollPopup?(g=b.addClass("zui-long-popup").getData("zmoduleuipopupscrollwrapel").show().setStyle("scrollTop",0).setStyle("z-index",v()),a&&e.insertBefore(g),0===p&&(zjs(document.body).addClass("zui-scroll-popup-is-open"),g=H(),0<g&&(f=zjs(document.body).getStyle("padding-right").toInt(),0<f&&(zjs(document.body).setData("data-bakpdr",f),g+=f),zjs(document.body).setStyle("padding-right",g))),p++):b.removeClass("zui-long-popup");g=0;D(c);d.fade&&(b.fadeIn({time:d.fadeTime}),
g=d.fadeTime);d.fadeCover?b.getData("zmoduleuipopupcoverel").fadeIn({time:d.fadeTime}):b.getData("zmoduleuipopupcoverel").show();d.animate&&(window.clearTimeout(t),window.clearTimeout(u),b.addClass("showing zanimate zanimate-start"),t=function(){b.addClass("zanimate-end")}.delay(d.animateTime),u=function(){b.removeClass("showing zanimate zanimate-start zanimate-end")}.delay(d.animateTime+100),g=d.animateTime);b.addClass("active").trigger("ui:popup:show");b.hasClass("zui-popup-center")&&r(c);d.pressEsc&&
z.push(n);d.pullDown&&d.longPopup&&zjs.isMobileDevice()&&B.push(n);(function(){b.find(".autofocus").focus();d.disableWindowScroll&&"disableScroll"in k&&("mobileOnly"===d.disableWindowScroll?zjs.isMobileDevice()&&k.disableScroll():k.disableScroll())}).delay(g+100)}},q=function(c,b,d){var a=zjs(c),e=a.getData("zmoduleuipopupoption");if(e&&a.hasClass("active")&&!a.hasClass("zui-popup-hide")){a.trigger("ui:popup:beforehide");e.disableWindowScroll&&"enableScroll"in k&&("mobileOnly"===e.disableWindowScroll?
zjs.isMobileDevice()&&k.enableScroll():k.enableScroll());var f=function(){a.addClass("zui-popup-hide");a.removeClass("active").trigger("ui:popup:hide");var b=a.getData("zmoduleuipopupfixedbodyel",!1);if(b){var c=!!zjs(document.body).getData("zmodulescrollbaroption",!1),f=a.getData("zmoduleuipopupscrolltop",0);m.length&&m.pop();0===m.length?(a.setData("zmoduleuipopupfixedbodyel",!1),c&&zjs(document.body).getData("zmodulescrollbarcontentel",!1).prepend(b),b.child().eachElement(function(a){zjs(a).insertBefore(l)}),
b.remove(),l.remove(),c?zjs(document.body).refreshScroll().scrollTo(f,!0):zjs(document.body).setStyle("scrollTop",f),zjs(document.body).removeClass("zui-long-popup-is-open"),c=a.getData("zlongpopuplistelswap",[]),0<c.length&&c.eachItem(function(a){var b=zjs(a).getData("zlongpopupswapel",!1);b&&zjs(a).insertBefore(b);b.remove();zjs(a).hasClass("zui-freezing")&&zjs(a).freezepanelDisableHandler(!1)})):(b=zjs('.zui-long-popup[data-show-instance="'+m.last()+'"]'),zjs(document.body).append(b.getData("zmoduleuipopupcoverel")),
zjs(document.body).append(b),a.getData("zmoduleuipopupfixedbodyel").remove(),zjs(document.body).setStyle("scrollTop",0),c||zjs(document.body).setStyle("scrollTop",f))}!d&&e.closethenremove&&(!1!==e.scrollPopup?a.getData("zmoduleuipopupscrollwrapel").remove():a.remove())};c=function(){if(a){var b=a.getData("zmoduleuipopupcoverel");b&&b.remove(!1);!1!==e.scrollPopup&&(a.getData("zmoduleuipopupscrollwrapel").hide(),0<p&&p--,0===p&&zjs(document.body).removeClass("zui-scroll-popup-is-open").setStyle("padding-right",
""))}};b=b||!1;!b&&e.fadeCover?a.getData("zmoduleuipopupcoverel").fadeOut({time:e.fadeTime,callback:c}):c();b||!e.fade||e.animate?!b&&e.animate?(window.clearTimeout(t),window.clearTimeout(u),a.addClass("hiding zanimate zanimate-start"),t=function(){a.addClass("zanimate-end")}.delay(e.animateTime),u=function(){a.removeClass("hiding zanimate zanimate-start zanimate-end");f()}.delay(e.animateTime+100)):f():a.fadeOut({time:e.fadeTime,callback:f});a.removeAttr("data-show-instance")}},D=function(c){var b=
zjs(c);b.getData("zmoduleuipopupoption")&&!b.hasClass("zui-popup-hide")&&(b.hasClass("zui-popup-center")&&r(c),b.trigger("ui:popup:refresh"))},r=function(c){var b=zjs(c),d=b.getData("zmoduleuipopupoption");if(d&&b.hasClass("zui-popup-center"))if(c=k.height()-b.height(),d.longPopup||d.scrollPopup)0<c?b.setStyle("margin-top",c/2):b.setStyle("margin-top",""),function(){b.find(".zfreezepanel").trigger("trigger:refreshpanel")}.delay(100);else{if(0<c){var a=-b.height()/2;d.centerY||(a-=c/6)}else d=b.getData("zmoduleuipopupscrolltop")-
document.body.scrollTop,d<c&&(d=c),0<d&&(d=0),a=-b.height()/2-c/2+d;b.setStyle("margin-top",a);b.setStyle("margin-left",-b.width()/2)}},H=function(){var c=zjs('<div style="width:50px;height:50px;overflow:hidden;position:absolute;top:-200px;left:-200px;"><div style="height:100px;"></div>');zjs(document.body).append(c);var b=c.item(0,!0).offsetWidth;c.setStyle("overflow","scroll");var d=c.item(0,!0).clientWidth;c.remove();return b-d},x=!1,A=!1;zjs.extendMethod({makePopup:function(c){return this.eachElement(function(b){G(b,
c)})},popupShow:function(){return this.eachElement(function(c){C(c)})},popupHide:function(){return this.eachElement(function(c){q(c)})},popupRefresh:function(){return this.eachElement(function(c){D(c)})},popupBackdrop:function(){return this.getData("zmoduleuipopupcoverel")}});zjs.hook({after_setInnerHTML:function(c){zjs(c).find(".zpopup").makePopup();zjs(c).parent().popupRefresh().parent().popupRefresh().parent().popupRefresh()},after_insertDOM:function(c){zjs(c).hasClass("zpopup")&&zjs(c).makePopup();
zjs(c).find(".zpopup").makePopup();zjs(c).parent().popupRefresh().parent().popupRefresh().parent().popupRefresh()}});zjs.onready(function(){zjs(".zpopup").makePopup()});"required"in zjs&&zjs.required("ui.popup")});