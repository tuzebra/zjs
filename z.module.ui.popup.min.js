zjs.require("ui",function(){zjs.extendCore({moduleUiPopupOption:{width:"auto",height:"auto",autoshow:!1,closebutton:!0,closethenremove:!1,pagecover:!0,pagecoverClass:"",clickout:!1,pressEsc:!0,center:!0,centerY:!1,fade:!0,fadeCover:!1,fadeTime:500,animate:!1,animateTime:1E3,animateName:"",longPopup:!1,scrollPopup:!1}});var p=function(){var b=!1;try{top.document.body.offsetTop=top.document.body.offsetTop,b=!0}catch(c){}b?isNaN(top.popuplastindex)&&(top.popuplastindex=1E4):isNaN(window.popuplastindex)&&
(window.popuplastindex=1E4);return function(){return b?top.popuplastindex++:window.popuplastindex++}}();window.zpopupelementstack=[];var q=function(b){return"mobileOnly"===b?zjs.isMobileDevice():b},u=function(b,c){var d=zjs(b),a=d.getData("zmoduleuipopupoption");if(a)d.setData("zmoduleuipopupoption",zjs.extend(a,c));else{var a=zjs.clone(zjs.moduleUiPopupOption),e=d.getAttr("data-option","");zjs.isString(e)&&""!=e.trim()&&(a=zjs.extend(a,e.jsonDecode()));d.removeAttr("data-option");"undefined"!=typeof c&&
(a=zjs.extend(a,c));a.fadeTime=parseInt(a.fadeTime);a.animate&&(a.fade=!(a.fadeCover=!0));a.animateTime=parseInt(a.animateTime);a.animateCoverTime=parseInt(a.animateCoverTime);"mobileOnly"!==a.longPopup&&(a.longPopup=!!a.longPopup);a.longPopup&&(a.centerY=!1);"mobileOnly"==a.scrollPopup&&(a.longPopup="mobileOnly",a.scrollPopup=!1);d.setData("zmoduleuipopupoption",a);e=zjs.enablehook();zjs.enablehook(!1);d.addClass("zui-popup");a.center&&d.addClass("zui-popup-center");a.animate&&d.addClass(a.animateName).setStyle("animation-duration",
a.animateTime+"ms");(a.longPopup||a.scrollPopup)&&d.appendTo(document.body);var f=zjs();!1!==a.scrollPopup&&(f=zjs("<div>").addClass("zui-popup-scrollwrap").hide(),f.insertBefore(d),f.append(d));d.setData("zmoduleuipopupscrollwrapel",f);f=zjs();if(a.pagecover){var f=zjs("<div>").addClass("zui-popup-page-cover"),g=d.getAttr("id","");""!=g&&f.addClass("zui-popup-page-cover-"+g);a.pagecoverClass&&f.addClass(a.pagecoverClass);a.clickout&&f.click(function(){k(b)})}d.setData("zmoduleuipopupcoverel",f);
var h=zjs("<div>").addClass("zui-popup-wrapper");d.child().eachElement(function(a){h.append(a)});d.append(h);zjs.enablehook(e);e=d.find(".zpopupclose");0==e.count()&&a.closebutton&&(e=zjs('<a class="zui-popup-close">\u00d7</a>').prependTo(d));e.click(function(a,c){zjs(this).hasClass("disabled")||k(b)});a.autoshow?r(b):(d.addClass("active"),k(b,!0,!0));d.removeClass("zui-uiuninithide zui-uiuninithideh zpopupuninithide zpopupuninithideh");zjs(window).on("resize",function(){l(b)}).on("scroll",function(){l(b)})}},
m=!1,n=!1,r=function(b){var c=zjs(b),d=c.getData("zmoduleuipopupoption");if(d&&!c.hasClass("active")){c.getData("zmoduleuipopupcoverel").insertBefore(c).setStyle("z-index",p());c.removeClass("zui-popup-hide").setStyle("z-index",p());var a=!!zjs(document.body).getData("zmodulescrollbaroption",!1),e=a?zjs(document.body).scrollPosition():document.body.scrollTop;c.setData("zmoduleuipopupscrolltop",e);if(q(d.longPopup)){c.addClass("zui-long-popup");var f=zjs("<div></div>"),g=a?zjs(document.body).getData("zmodulescrollbarcontentel",
!1):zjs(document.body);g&&(g.child().eachElement(function(a){"SCRIPT"==a.tagName||"LINK"==a.tagName||zjs(a).hasClass("zui-popup")||zjs(a).hasClass("zui-popup-page-cover")||zjs(a).hasClass("zpreventlongpopup")||"fb-root"==zjs(a).getAttr("id")||f.append(a)}),zjs(document.body).prepend(f),f.setStyle({position:"fixed",width:"100%",height:"100%"}),f.top(-e),a?zjs(document.body).refreshScroll().scrollTo(0,!0):document.body.scrollTop=0,c.setData("zmoduleuipopupfixedbodyel",f),zjs(document.body).addClass("zui-long-popup-is-open"));
var h=[];f.find(".zpreventlongpopup").eachElement(function(a){var b=zjs("<span></span>").insertBefore(a);zjs(a).setData("zlongpopupswapel",b).insertBefore(f);h.push(a)});c.setData("zlongpopuplistelswap",h)}else!1!==d.scrollPopup?(c.addClass("zui-long-popup").getData("zmoduleuipopupscrollwrapel").show(),zjs(document.body).addClass("zui-scroll-popup-is-open"),a=v(),0<a&&(e=zjs(document.body).getStyle("padding-right").toInt(),0<e&&(zjs(document.body).setData("data-bakpdr",e),a+=e),zjs(document.body).setStyle("padding-right",
a))):c.removeClass("zui-long-popup");t(b);d.fade&&c.fadeIn({time:d.fadeTime});d.fadeCover&&c.getData("zmoduleuipopupcoverel").fadeIn({time:d.fadeTime});d.animate&&(window.clearTimeout(m),window.clearTimeout(n),c.addClass("showing zanimate zanimate-start"),m=function(){c.addClass("zanimate-end")}.delay(d.animateTime),n=function(){c.removeClass("showing zanimate zanimate-start zanimate-end")}.delay(d.animateTime+100));c.addClass("active").trigger("ui:popup:show");c.hasClass("zui-popup-center")&&l(b);
d.pressEsc&&(b=zjs.getUniqueId(),c.setAttr("data-show-instance",b),window.zpopupelementstack.push(b));(function(){c.find(".autofocus").focus()}).delay(500)}},k=function(b,c,d){var a=zjs(b),e=a.getData("zmoduleuipopupoption");if(e&&a.hasClass("active")&&!a.hasClass("zui-popup-hide")){var f=function(){a.addClass("zui-popup-hide");a.removeClass("active").trigger("ui:popup:hide");var b=a.getData("zmoduleuipopupfixedbodyel",!1);if(b){var c=!!zjs(document.body).getData("zmodulescrollbaroption",!1);a.setData("zmoduleuipopupfixedbodyel",
!1);c&&zjs(document.body).getData("zmodulescrollbarcontentel",!1).prepend(b);b.child().eachElement(function(a){zjs(a).insertBefore(b)});b.remove();c?zjs(document.body).refreshScroll().scrollTo(a.getData("zmoduleuipopupscrolltop",0),!0):document.body.scrollTop=a.getData("zmoduleuipopupscrolltop",0);zjs(document.body).removeClass("zui-long-popup-is-open");c=a.getData("zlongpopuplistelswap",[]);0<c.length&&c.eachElement(function(a){var b=zjs(a).getData("zlongpopupswapel",!1);b&&zjs(a).insertBefore(b);
b.remove()})}!d&&e.closethenremove&&(!1!==e.scrollPopup?a.getData("zmoduleuipopupscrollwrapel").remove():a.remove())};b=function(){if(a){var b=a.getData("zmoduleuipopupcoverel");b&&b.remove(!1);!1!==e.scrollPopup&&(a.getData("zmoduleuipopupscrollwrapel").hide(),zjs(document.body).removeClass("zui-scroll-popup-is-open").setStyle("padding-right",""))}};c=c||!1;!c&&e.fadeCover?a.getData("zmoduleuipopupcoverel").fadeOut({time:e.fadeTime,callback:b}):b();c||!e.fade||e.animate?!c&&e.animate?(window.clearTimeout(m),
window.clearTimeout(n),a.addClass("hiding zanimate zanimate-start"),m=function(){a.addClass("zanimate-end")}.delay(e.animateTime),n=function(){a.removeClass("hiding zanimate zanimate-start zanimate-end");f()}.delay(e.animateTime+100)):f():a.fadeOut({time:e.fadeTime,callback:f});a.removeAttr("data-show-instance")}},t=function(b){var c=zjs(b);c.getData("zmoduleuipopupoption")&&!c.hasClass("zui-popup-hide")&&(c.hasClass("zui-popup-center")&&l(b),c.trigger("ui:popup:refresh"))},l=function(b){var c=zjs(b),
d=c.getData("zmoduleuipopupoption");if(d&&c.hasClass("zui-popup-center"))if(b=zjs(window).height()-c.height(),q(d.longPopup)||!1!==d.scrollPopup)0<b?c.setStyle("margin-top",b/2):c.setStyle("margin-top",""),function(){c.find(".zfreezepanel").trigger("trigger:refreshpanel")}.delay(100);else{if(0<b){var a=-c.height()/2;d.centerY||(a-=b/6)}else a=c.getData("zmoduleuipopupscrolltop"),a-=document.body.scrollTop,a<b&&(a=b),0<a&&(a=0),a=-c.height()/2-b/2+a;c.setStyle("margin-top",a);c.setStyle("margin-left",
-c.width()/2)}},v=function(){var b=zjs('<div style="width:50px;height:50px;overflow:hidden;position:absolute;top:-200px;left:-200px;"><div style="height:100px;"></div>');zjs(document.body).append(b);var c=b.item(0,!0).offsetWidth;b.setStyle("overflow","scroll");var d=b.item(0,!0).clientWidth;b.remove();return c-d};zjs(document).on("keyup",function(b){if(27==b.getKeyCode()){for(var c=!1;0<window.zpopupelementstack.length&&!(c=window.zpopupelementstack.pop(),c=zjs('.zui-popup[data-show-instance="'+
c+'"]'),0<c.count());)c=!1;c&&(b.preventDefault(),c.popupHide())}});zjs.extendMethod({makePopup:function(b){return this.eachElement(function(c){u(c,b)})},popupShow:function(){return this.eachElement(function(b){r(b)})},popupHide:function(){return this.eachElement(function(b){k(b)})},popupRefresh:function(){return this.eachElement(function(b){t(b)})}});zjs.hook({after_setInnerHTML:function(b){zjs(b).find(".zpopup").makePopup();zjs(b).parent().popupRefresh().parent().popupRefresh().parent().popupRefresh()},
after_insertDOM:function(b){zjs(b).hasClass("zpopup")&&zjs(b).makePopup();zjs(b).find(".zpopup").makePopup();zjs(b).parent().popupRefresh().parent().popupRefresh().parent().popupRefresh()}});zjs.onready(function(){zjs(".zpopup").makePopup()});"required"in zjs&&zjs.required("ui.popup")});