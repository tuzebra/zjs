zjs.require("ui",function(){function y(){t||(t=!0,zjs(document).on("keyup",function(b){27==b.getKeyCode()&&u(window.zpopupelementstackesc)}))}function z(){if(!v){v=!0;var b;zjs(document).on("touchstart",function(c){b=window.scrollY}).on("touchend",function(c){100>b&&-50>window.scrollY&&(b=9999,u(window.zpopupelementstackpull))})}}function u(b){for(var c=!1;0<b.length&&!(c=b.pop(),c=zjs('.zui-popup[data-show-instance="'+c+'"]'),0<c.count());)c=!1;c&&(event.preventDefault(),c.popupHide())}zjs.extendCore({moduleUiPopupOption:{width:"auto",
height:"auto",autoshow:!1,autoshowDelay:0,closebutton:!0,closethenremove:!1,pagecover:!0,hidePagecoverWhenWindowWidthLessThan:0,pagecoverClass:"",clickout:!1,pressEsc:!0,pullDown:!1,center:!0,centerY:!1,fade:!0,fadeCover:!1,fadeTime:500,animate:!1,animateTime:1E3,animateName:"",longPopup:"mobileOnly",scrollPopup:!0,disableWindowScroll:!1}});var q=function(){var b=!1;try{top.document.body.offsetTop=top.document.body.offsetTop,b=!0}catch(c){}b?isNaN(top.popuplastindex)&&(top.popuplastindex=1E4):isNaN(window.popuplastindex)&&
(window.popuplastindex=1E4);return function(){return b?top.popuplastindex++:window.popuplastindex++}}();window.zpopupelementstackesc=[];window.zpopupelementstackpull=[];var h=zjs(window),A=function(b,c){var d=zjs(b),a=d.getData("zmoduleuipopupoption");if(a)d.setData("zmoduleuipopupoption",zjs.extend(a,c));else{a=zjs.clone(zjs.moduleUiPopupOption);var f=d.getAttr("data-option","");zjs.isString(f)&&""!=f.trim()&&(a=zjs.extend(a,f.jsonDecode()));d.removeAttr("data-option");"undefined"!=typeof c&&(a=
zjs.extend(a,c));a.fadeTime=parseInt(a.fadeTime);a.animate&&(a.fade=!(a.fadeCover=!0));a.animateTime=parseInt(a.animateTime);a.animateCoverTime=parseInt(a.animateCoverTime);"mobileOnly"===a.scrollPopup&&(a.longPopup="mobileOnly",a.scrollPopup=!1);"mobileOnly"===a.longPopup&&(a.longPopup=zjs.isMobileDevice());!0===a.longPopup&&(a.centerY=a.scrollPopup=!1);a.autoshow=!!a.autoshow;a.autoshowDelay=parseInt(a.autoshowDelay);isNaN(a.autoshowDelay)&&(a.autoshowDelay=0);a.hidePagecoverWhenWindowWidthLessThan=
parseInt(a.hidePagecoverWhenWindowWidthLessThan);0>a.hidePagecoverWhenWindowWidthLessThan&&(a.hidePagecoverWhenWindowWidthLessThan=0);d.setData("zmoduleuipopupoption",a);f=zjs.enablehook();zjs.enablehook(!1);d.addClass("zui-popup");a.center&&d.addClass("zui-popup-center");a.animate&&d.addClass(a.animateName).setStyle("animation-duration",a.animateTime+"ms");(a.longPopup||a.scrollPopup)&&d.appendTo(document.body);var e=zjs();!1!==a.scrollPopup&&(e=zjs("<div>").addClass("zui-popup-scrollwrap").hide(),
e.insertBefore(d),e.append(d));d.setData("zmoduleuipopupscrollwrapel",e);e=zjs();if(a.pagecover){e=zjs("<div>").addClass("zui-popup-page-cover");var k=d.getAttr("id","");""!=k&&e.addClass("zui-popup-page-cover-"+k);a.pagecoverClass&&e.addClass(a.pagecoverClass)}d.setData("zmoduleuipopupcoverel",e);var g=zjs("<div>").addClass("zui-popup-wrapper");d.child().eachElement(function(a){g.append(a)});d.append(g);zjs.enablehook(f);f=d.find(".zpopupclose");0==f.count()&&a.closebutton&&(f=zjs('<a class="zui-popup-close">\u00d7</a>').prependTo(d));
f.click(function(a,c){zjs(this).hasClass("disabled")||l(b)});d.removeClass("zui-uiuninithide zui-uiuninithideh zpopupuninithide zpopupuninithideh");a.autoshow?(d.addClass("zui-popup-hide"),function(){w(b)}.delay(a.autoshowDelay)):(d.addClass("active"),l(b,!0,!0));h.on("resize",function(){m(b)}).on("scroll",function(){m(b)});a.pressEsc&&y();a.pullDown&&z();a.clickout&&d.clickout(function(){this.getData("popupreadyclickout")&&l(this)})}},n=!1,p=!1,w=function(b){var c=zjs(b),d=c.getData("zmoduleuipopupoption");
if(d&&!c.hasClass("active")){var a=!0;0<d.hidePagecoverWhenWindowWidthLessThan&&h.width()<=d.hidePagecoverWhenWindowWidthLessThan&&(a=!1);if(a)var f=c.getData("zmoduleuipopupcoverel").insertBefore(c).hide().setStyle("z-index",q());c.removeClass("zui-popup-hide").setStyle("z-index",q());var e=!!zjs(document.body).getData("zmodulescrollbaroption",!1),k=e?zjs(document.body).scrollPosition():zjs(document.body).scrollTop();c.setData("zmoduleuipopupscrolltop",k);if(d.longPopup){a=zjs.enablehook();zjs.enablehook(!1);
c.addClass("zui-long-popup");var g=zjs("<div></div>"),r=[];if(f=e?zjs(document.body).getData("zmodulescrollbarcontentel",!1):zjs(document.body))f.child().eachElement(function(a){if("SCRIPT"==a.tagName||"LINK"==a.tagName||zjs(a).hasClass("zui-popup")||zjs(a).hasClass("zui-popup-page-cover")||zjs(a).hasClass("zpreventlongpopup")||zjs(a).hasClass("zui-freezing")||"fb-root"==zjs(a).getAttr("id")){if(zjs(a).hasClass("zui-freezing")){zjs(a).freezepanelDisableHandler(!0);var b=zjs("<span></span>").appendTo(g);
zjs(a).setData("zlongpopupswapel",b);r.push(a)}}else g.append(a)}),zjs(document.body).prepend(g),g.addClass("zui-long-popup-fixed-content-wrap"),g.setStyle({position:"fixed",width:"100%",overflow:"hidden"}),g.top(-k),e?zjs(document.body).refreshScroll().scrollTo(0,!0):document.body.scrollTop=0,c.setData("zmoduleuipopupfixedbodyel",g),zjs(document.body).setStyle("scrollTop",0).addClass("zui-long-popup-is-open");g.find(".zpreventlongpopup,.zui-freezing").eachElement(function(a){var b=zjs("<span></span>").insertBefore(a);
zjs(a).setData("zlongpopupswapel",b).insertBefore(g);r.push(a)});c.setData("zlongpopuplistelswap",r);zjs.enablehook(a)}else d.scrollPopup?(e=c.addClass("zui-long-popup").getData("zmoduleuipopupscrollwrapel").show().setStyle("scrollTop",0).setStyle("z-index",q()),a&&f.insertBefore(e),zjs(document.body).addClass("zui-scroll-popup-is-open"),e=B(),0<e&&(k=zjs(document.body).getStyle("padding-right").toInt(),0<k&&(zjs(document.body).setData("data-bakpdr",k),e+=k),zjs(document.body).setStyle("padding-right",
e))):c.removeClass("zui-long-popup");e=0;x(b);d.fade&&(c.fadeIn({time:d.fadeTime}),e=d.fadeTime);d.fadeCover?c.getData("zmoduleuipopupcoverel").fadeIn({time:d.fadeTime}):c.getData("zmoduleuipopupcoverel").show();d.animate&&(window.clearTimeout(n),window.clearTimeout(p),c.addClass("showing zanimate zanimate-start"),n=function(){c.addClass("zanimate-end")}.delay(d.animateTime),p=function(){c.removeClass("showing zanimate zanimate-start zanimate-end")}.delay(d.animateTime+100),e=d.animateTime);c.addClass("active").trigger("ui:popup:show");
c.hasClass("zui-popup-center")&&m(b);d.pressEsc&&(b=zjs.getUniqueId(),c.setAttr("data-show-instance",b),window.zpopupelementstackesc.push(b));d.pullDown&&d.longPopup&&zjs.isMobileDevice()&&(b=zjs.getUniqueId(),c.setAttr("data-show-instance",b),window.zpopupelementstackpull.push(b));(function(){c.find(".autofocus").focus();d.disableWindowScroll&&"disableScroll"in h&&("mobileOnly"===d.disableWindowScroll?zjs.isMobileDevice()&&h.disableScroll():h.disableScroll())}).delay(e+100);d.clickout&&function(){c.setData("popupreadyclickout",
!0)}.delay(1)}},l=function(b,c,d){var a=zjs(b),f=a.getData("zmoduleuipopupoption");if(f&&a.hasClass("active")&&!a.hasClass("zui-popup-hide")){a.trigger("ui:popup:beforehide");f.disableWindowScroll&&"enableScroll"in h&&("mobileOnly"===f.disableWindowScroll?zjs.isMobileDevice()&&h.enableScroll():h.enableScroll());var e=function(){a.addClass("zui-popup-hide");a.removeClass("active").trigger("ui:popup:hide");var b=a.getData("zmoduleuipopupfixedbodyel",!1);if(b){var c=!!zjs(document.body).getData("zmodulescrollbaroption",
!1);a.setData("zmoduleuipopupfixedbodyel",!1);c&&zjs(document.body).getData("zmodulescrollbarcontentel",!1).prepend(b);b.child().eachElement(function(a){zjs(a).insertBefore(b)});b.remove();var e=a.getData("zmoduleuipopupscrolltop",0);c?zjs(document.body).refreshScroll().scrollTo(e,!0):zjs(document.body).setStyle("scrollTop",e);zjs(document.body).removeClass("zui-long-popup-is-open");c=a.getData("zlongpopuplistelswap",[]);0<c.length&&c.eachItem(function(a){var b=zjs(a).getData("zlongpopupswapel",!1);
b&&zjs(a).insertBefore(b);b.remove();zjs(a).hasClass("zui-freezing")&&zjs(a).freezepanelDisableHandler(!1)})}!d&&f.closethenremove&&(!1!==f.scrollPopup?a.getData("zmoduleuipopupscrollwrapel").remove():a.remove())};b=function(){if(a){var b=a.getData("zmoduleuipopupcoverel");b&&b.remove(!1);!1!==f.scrollPopup&&(a.getData("zmoduleuipopupscrollwrapel").hide(),zjs(document.body).removeClass("zui-scroll-popup-is-open").setStyle("padding-right",""))}};c=c||!1;!c&&f.fadeCover?a.getData("zmoduleuipopupcoverel").fadeOut({time:f.fadeTime,
callback:b}):b();c||!f.fade||f.animate?!c&&f.animate?(window.clearTimeout(n),window.clearTimeout(p),a.addClass("hiding zanimate zanimate-start"),n=function(){a.addClass("zanimate-end")}.delay(f.animateTime),p=function(){a.removeClass("hiding zanimate zanimate-start zanimate-end");e()}.delay(f.animateTime+100)):e():a.fadeOut({time:f.fadeTime,callback:e});a.removeAttr("data-show-instance").setData("popupreadyclickout",!1)}},x=function(b){var c=zjs(b);c.getData("zmoduleuipopupoption")&&!c.hasClass("zui-popup-hide")&&
(c.hasClass("zui-popup-center")&&m(b),c.trigger("ui:popup:refresh"))},m=function(b){var c=zjs(b),d=c.getData("zmoduleuipopupoption");if(d&&c.hasClass("zui-popup-center"))if(b=h.height()-c.height(),d.longPopup||d.scrollPopup)0<b?c.setStyle("margin-top",b/2):c.setStyle("margin-top",""),function(){c.find(".zfreezepanel").trigger("trigger:refreshpanel")}.delay(100);else{if(0<b){var a=-c.height()/2;d.centerY||(a-=b/6)}else d=c.getData("zmoduleuipopupscrolltop")-document.body.scrollTop,d<b&&(d=b),0<d&&
(d=0),a=-c.height()/2-b/2+d;c.setStyle("margin-top",a);c.setStyle("margin-left",-c.width()/2)}},B=function(){var b=zjs('<div style="width:50px;height:50px;overflow:hidden;position:absolute;top:-200px;left:-200px;"><div style="height:100px;"></div>');zjs(document.body).append(b);var c=b.item(0,!0).offsetWidth;b.setStyle("overflow","scroll");var d=b.item(0,!0).clientWidth;b.remove();return c-d},t=!1,v=!1;zjs.extendMethod({makePopup:function(b){return this.eachElement(function(c){A(c,b)})},popupShow:function(){return this.eachElement(function(b){w(b)})},
popupHide:function(){return this.eachElement(function(b){l(b)})},popupRefresh:function(){return this.eachElement(function(b){x(b)})},popupBackdrop:function(){return this.getData("zmoduleuipopupcoverel")}});zjs.hook({after_setInnerHTML:function(b){zjs(b).find(".zpopup").makePopup();zjs(b).parent().popupRefresh().parent().popupRefresh().parent().popupRefresh()},after_insertDOM:function(b){zjs(b).hasClass("zpopup")&&zjs(b).makePopup();zjs(b).find(".zpopup").makePopup();zjs(b).parent().popupRefresh().parent().popupRefresh().parent().popupRefresh()}});
zjs.onready(function(){zjs(".zpopup").makePopup()});"required"in zjs&&zjs.required("ui.popup")});