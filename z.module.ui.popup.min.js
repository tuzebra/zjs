zjs.require("ui",function(){"use strict";function e(){Y||(Y=!0,zjs(document).on("keyup",function(e){27==e.getKeyCode()&&o(P)}))}function a(){var e;q||(q=!0,zjs(document).on("touchstart{passive}",function(a){e=window.scrollY}).on("touchend{passive}",function(a){e<100&&window.scrollY<-50&&(e=9999,o(W))}))}function o(e){for(var a=!1;e.length>0;){var o=e.pop();if(a=zjs('.zui-popup[data-show-instance="'+o+'"]'),a.count()>0)break;a=!1}a&&(event.preventDefault(),a.popupHide())}var t="zmoduleuipopupoption",s="zmoduleuipopupcoverel",n="zmoduleuipopupscrollwrapel",i="zmoduleuipopupscrolltop",p="zmoduleuipopupfixedbodyel",l="zmodulescrollbaroption",d="zmodulescrollbarcontentel",r=9e3;zjs.extendCore({moduleUiPopupOption:{width:"auto",height:"auto",autoshow:!1,autoshowDelay:0,closebutton:!0,closethenremove:!1,pagecover:!0,hidePagecoverWhenWindowWidthLessThan:0,pagecoverClass:"",clickout:!1,pressEsc:!0,pullDown:!1,center:!0,centerY:!1,fade:!0,fadeCover:!1,fadeTime:500,animate:!1,animateTime:1e3,animateName:"",longPopup:"mobileOnly",scrollPopup:!0,disableWindowScroll:!1}});var u="zui-popup",c="zui-popup-hide",m="zui-long-popup",h="zui-long-popup-is-open",z="zui-scroll-popup-is-open",f="zui-long-popup-fixed-content-wrap",v="zui-popup-scrollwrap",g="zui-popup-page-cover",j="zui-popup-wrapper",y="zui-popup-center",w="active",b='<a class="zui-popup-close">Ã—</a>',C="zui-uiuninithide zui-uiuninithideh zpopupuninithide zpopupuninithideh",D="zpreventlongpopup",T="zui-freezing",S=function(){var e=!1;try{top.document;top.document.body.offsetTop=top.document.body.offsetTop,e=!0}catch(e){}return e?isNaN(top.popuplastindex)&&(top.popuplastindex=r):isNaN(window.popuplastindex)&&(window.popuplastindex=r),function(){return e?top.popuplastindex++:window.popuplastindex++}}(),P=[],W=[],k=[],x=0,I=zjs(window),N=!1,O=function(e,a){var o=zjs(e),i=o.getData(t);if(i)return o.setData(t,zjs.extend(i,a)),void(i.animate&&i.animateTime&&o.setStyle("animation-duration",i.animateTime+"ms"));i=zjs.clone(zjs.moduleUiPopupOption);var p=o.getAttr("data-option","");zjs.isString(p)&&""!=p.trim()&&(i=zjs.extend(i,p.jsonDecode())),o.removeAttr("data-option"),void 0!==a&&(i=zjs.extend(i,a)),i.fadeTime=parseInt(i.fadeTime),i.animate&&(i.fade=!(i.fadeCover=!0)),i.animateTime=parseInt(i.animateTime),i.animateCoverTime=parseInt(i.animateCoverTime),"mobileOnly"===i.scrollPopup&&(i.longPopup="mobileOnly",i.scrollPopup=!1),"mobileOnly"===i.longPopup&&(i.longPopup=zjs.isMobileDevice()),!0===i.longPopup&&(i.centerY=i.scrollPopup=!1),i.autoshow=!!i.autoshow,i.autoshowDelay=parseInt(i.autoshowDelay),isNaN(i.autoshowDelay)&&(i.autoshowDelay=0),i.hidePagecoverWhenWindowWidthLessThan=parseInt(i.hidePagecoverWhenWindowWidthLessThan),i.hidePagecoverWhenWindowWidthLessThan<0&&(i.hidePagecoverWhenWindowWidthLessThan=0),o.setData(t,i);var l=zjs.enablehook();zjs.enablehook(!1),o.addClass(u),i.center&&o.addClass(y),i.animate&&o.addClass(i.animateName).setStyle("animation-duration",i.animateTime+"ms"),(i.longPopup||i.scrollPopup)&&o.appendTo(document.body);var d=zjs();!1!==i.scrollPopup&&(d=zjs("<div>").addClass(v).hide(),d.insertBefore(o),d.append(o)),o.setData(n,d);var r=zjs();if(i.pagecover){r=zjs("<div>").addClass(g);var m=o.getAttr("id","");""!=m&&r.addClass(g+"-"+m),i.pagecoverClass&&r.addClass(i.pagecoverClass)}o.setData(s,r);var h=zjs("<div>").addClass(j);o.child().eachElement(function(e){h.append(e)}),o.append(h),zjs.enablehook(l);var z=o.find(".zpopupclose");0==z.count()&&i.closebutton&&(z=zjs(b).prependTo(o)),z.click(function(a,o){zjs(this).hasClass("disabled")||R(e)}),o.removeClass(C),i.autoshow?(o.addClass(c),function(){B(e)}.delay(i.autoshowDelay)):(o.addClass(w),R(e,!0,!0)),I.on("resize{passive}",function(){A(e)}).on("wheel{passive}",function(){A(e)}),i.clickout&&(r.click(function(){R(e)}),!1!==i.scrollPopup&&d.click(function(a){a.target()===this.item(0,1)&&R(e)}))},E=!1,L=!1,B=function(o,r){var v=zjs(o),j=v.getData(t);if(j&&!v.hasClass(w)){var b=!0;if(j.hidePagecoverWhenWindowWidthLessThan>0&&I.width()<=j.hidePagecoverWhenWindowWidthLessThan&&(b=!1),b)var C=v.getData(s).insertBefore(v).hide().setStyle("z-index",S());v.removeClass(c).setStyle("z-index",S());var O=!!zjs(document.body).getData(l,!1),B=O?zjs(document.body).scrollPosition():zjs(document.body).scrollTop();v.setData(i,B);var R=zjs.getUniqueId();if(v.setAttr("data-show-instance",R),j.longPopup){var Y=zjs.enablehook();if(zjs.enablehook(!1),v.addClass(m),0===k.length){var q=zjs("<div></div>"),U=[],K=O?zjs(document.body).getData(d,!1):zjs(document.body);K&&(K.child().eachElement(function(e){if("SCRIPT"==e.tagName||"LINK"==e.tagName||zjs(e).hasClass(u)||zjs(e).hasClass(g)||zjs(e).hasClass(D)||zjs(e).hasClass(T)||"fb-root"==zjs(e).getAttr("id")){if(zjs(e).hasClass(T)){zjs(e).freezepanelDisableHandler(!0);var a=zjs("<span></span>").appendTo(q);zjs(e).setData("zlongpopupswapel",a),U.push(e)}}else q.append(e)}),N||(N=zjs("<div></div>").setStyle({position:"fixed",width:"100%",height:"100%",overflow:"hidden",top:0})),zjs(document.body).prepend(N),q.addClass(f).setStyle({position:"absolute",width:"100%"}).top(-B).appendTo(N),O?zjs(document.body).refreshScroll().scrollTo(0,!0):document.body.scrollTop=0,v.setData(p,q),zjs(document.body).setStyle("scrollTop",0).addClass(h)),q.find("."+D+",."+T).eachElement(function(e){var a=zjs("<span></span>").insertBefore(e);zjs(e).setData("zlongpopupswapel",a).insertBefore(N),U.push(e)}),v.setData("zlongpopuplistelswap",U)}else{q=zjs("<div></div>");var _=zjs('.zui-long-popup[data-show-instance="'+k.last()+'"]');q.append(_.getData(s)),q.append(_),q.setStyle({position:"absolute",width:"100%"}).top(-B).appendTo(N),v.setData(p,q),zjs(document.body).setStyle("scrollTop",0)}k.push(R),zjs.enablehook(Y)}else if(j.scrollPopup){var F=v.addClass(m).getData(n).show().setStyle("scrollTop",0).setStyle("z-index",S());if(b&&C.insertBefore(F),0===x){zjs(document.body).addClass(z);var G=H();if(G>0){var J=zjs(document.body).getStyle("padding-right").toInt();J>0&&(zjs(document.body).setData("data-bakpdr",J),G+=J),zjs(document.body).setStyle("padding-right",G)}}x++}else v.removeClass(m);var Q=0;M(o),j.fade&&(v.fadeIn({time:j.fadeTime}),Q=j.fadeTime),j.fadeCover?v.getData(s).fadeIn({time:j.fadeTime}):v.getData(s).show(),j.animate&&(window.clearTimeout(E),window.clearTimeout(L),v.addClass("showing zanimate zanimate-start"),E=function(){v.addClass("zanimate-end")}.delay(j.animateTime),L=function(){v.removeClass("showing zanimate zanimate-start zanimate-end")}.delay(j.animateTime+100),Q=j.animateTime),v.addClass(w).trigger("ui:popup:show"),v.hasClass(y)&&A(o),j.pressEsc&&(e(),P.push(R)),j.pullDown&&j.longPopup&&zjs.isMobileDevice()&&(a(),W.push(R)),function(){v.find(".autofocus").focus(),j.disableWindowScroll&&"disableScroll"in I&&("mobileOnly"===j.disableWindowScroll?zjs.isMobileDevice()&&I.disableScroll():I.disableScroll()),v.getData(s).addClass(w),r&&zjs.isFunction(r.callback)&&r.callback.call(v,o),v.trigger("ui:popup:aftershow")}.delay(Q+100)}},R=function(e,a,o){var r=zjs(e),u=r.getData(t);if(u&&r.hasClass(w)&&!r.hasClass(c)){r.trigger("ui:popup:beforehide"),r.getData(s).removeClass(w),u.disableWindowScroll&&"enableScroll"in I&&("mobileOnly"===u.disableWindowScroll?zjs.isMobileDevice()&&I.enableScroll():I.enableScroll());var m=function(){r.addClass(c),r.removeClass(w).trigger("ui:popup:hide");var e=r.getData(p,!1);if(e){var a=!!zjs(document.body).getData(l,!1),t=r.getData(i,0);if(k.length&&k.pop(),0===k.length){if(r.setData(p,!1),a){var m=zjs(document.body).getData(d,!1);m.prepend(e)}e.child().eachElement(function(e){zjs(e).insertBefore(N)}),e.remove(),N.remove(),a?zjs(document.body).refreshScroll().scrollTo(t,!0):zjs(document.body).setStyle("scrollTop",t),zjs(document.body).removeClass(h);var z=r.getData("zlongpopuplistelswap",[]);z.length>0&&z.eachItem(function(e){var a=zjs(e).getData("zlongpopupswapel",!1);a&&zjs(e).insertBefore(a),a.remove(),zjs(e).hasClass(T)&&zjs(e).freezepanelDisableHandler(!1)})}else{var f=zjs('.zui-long-popup[data-show-instance="'+k.last()+'"]');zjs(document.body).append(f.getData(s)),zjs(document.body).append(f),r.getData(p).remove(),zjs(document.body).setStyle("scrollTop",0),a||zjs(document.body).setStyle("scrollTop",t)}}!o&&u.closethenremove&&(!1!==u.scrollPopup?r.getData(n).remove():r.remove())},f=function(){if(r){var e=r.getData(s);e&&e.remove(!1),!1!==u.scrollPopup&&(r.getData(n).hide(),x>0&&x--,0===x&&zjs(document.body).removeClass(z).setStyle("padding-right",""))}};a=a||!1,!a&&u.fadeCover?r.getData(s).fadeOut({time:u.fadeTime,callback:f}):f();a||!u.fade||u.animate?!a&&u.animate?(window.clearTimeout(E),window.clearTimeout(L),r.addClass("hiding zanimate zanimate-start"),E=function(){r.addClass("zanimate-end")}.delay(u.animateTime),L=function(){r.removeClass("hiding zanimate zanimate-start zanimate-end"),m()}.delay(u.animateTime+100),u.animateTime):m():(r.fadeOut({time:u.fadeTime,callback:m}),u.fadeTime),r.removeAttr("data-show-instance")}},M=function(e){var a=zjs(e);a.getData(t)&&(a.hasClass(c)||(a.hasClass(y)&&A(e),a.trigger("ui:popup:refresh")))},A=function(e){var a=zjs(e),o=a.getData(t);if(o&&a.hasClass(y)){var s=I.height()-a.height();if(o.longPopup||o.scrollPopup)return s>0?a.setStyle("margin-top",s/2):a.setStyle("margin-top",""),void function(){a.find(".zfreezepanel").trigger("trigger:refreshpanel")}.delay(100);if(s>0){var n=-a.height()/2;o.centerY||(n-=s/6)}else{var p=a.getData(i),l=p-document.body.scrollTop;l<s&&(l=s),l>0&&(l=0);n=-a.height()/2-s/2+l}a.setStyle("margin-top",n),a.setStyle("margin-left",-a.width()/2)}},H=function(){var e=zjs('<div style="width:50px;height:50px;overflow:hidden;position:absolute;top:-200px;left:-200px;"><div style="height:100px;"></div>');zjs(document.body).append(e);var a=e.item(0,!0).offsetWidth;e.setStyle("overflow","scroll");var o=e.item(0,!0).clientWidth;return e.remove(),a-o},Y=!1,q=!1;zjs.extendMethod({makePopup:function(e){return this.eachElement(function(a){O(a,e)})},popupShow:function(e){return this.eachElement(function(a){B(a,e)})},popupHide:function(){return this.eachElement(function(e){R(e)})},popupRefresh:function(){return this.eachElement(function(e){M(e)})},popupBackdrop:function(){return this.getData(s)}}),zjs.hook({after_setInnerHTML:function(e){zjs(e).find(".zpopup").makePopup(),zjs(e).parent().popupRefresh().parent().popupRefresh().parent().popupRefresh()},after_insertDOM:function(e){zjs(e).hasClass("zpopup")&&zjs(e).makePopup(),zjs(e).find(".zpopup").makePopup(),zjs(e).parent().popupRefresh().parent().popupRefresh().parent().popupRefresh()}}),zjs.onready(function(){zjs(".zpopup").makePopup()}),"required"in zjs&&zjs.required("ui.popup")});