zjs.require("ui",function(){var e="zmoduleuislideroption",i="zmoduleuisliderwrapel";zjs.extendCore({moduleUiSliderOption:{min:0,max:1,step:0,indicator:!1,indicatorAsSelectList:!1,referer:!1,valueArray:!1,checkMobileDevice:zjs.isMobileDevice}});var t="zui-slider",r="zui-slider-touch",a="zui-slider-wrapper",s="zui-slider-tray-wrapper",n="zui-slider-tray",l="zui-slider-button",d='<div class="'+t+'"><div class="'+a+'"><div class="'+s+'"><div class="'+n+'"></div></div><div class="'+l+'"></div></div></div>',o="zui-uihide",u=function(t,a){function u(e){var i=k.width(),t=S.width();if(e<0&&(e=0),e>i-t&&(e=i-t),w=e/(i-t)*(f.max-f.min)+f.min,!isNaN(f.step)&&f.step>0&&(w=Math.round((w-f.min)/f.step)*f.step+f.min,w<f.min&&(w=f.min),w>f.max&&(w=f.max),e=(w-f.min)/(f.max-f.min)*(i-t)),zjs.isArray(f.valueArray)){var r;for(r=1;r<f.valueArray.length&&!(f.valueArray[r]>=w);r++);w=w-f.valueArray[r-1]<f.valueArray[r]-w?f.valueArray[r-1]:f.valueArray[r],e=(w-f.min)/(f.max-f.min)*(i-t)}S.left(e),b.width(e),A&&A.count()&&(A.find("span").removeClass("active"),A.find(".num-"+w).addClass("active"));var a=c.getValue(),s=zjs.enablehook();zjs.enablehook(!1),c.setValue(w),zjs.enablehook(s),a!=w&&c.trigger("ui:slider:change",{value:w,via:"movebutton"}),f.referer&&zjs(f.referer).setInnerHTML(w)}var c=zjs(t),f=c.getData(e);if(f)return void c.setData(e,zjs.extend(f,a));f=zjs.clone(zjs.moduleUiSliderOption);var m=c.getAttr("data-option","");if(zjs.isString(m)&&""!=m.trim()&&(f=zjs.extend(f,m.jsonDecode())),"undefined"!=typeof a&&(f=zjs.extend(f,a)),""!==c.getAttr("min","")&&(f.min=c.getAttr("min").toInt()),""!==c.getAttr("max","")&&(f.max=c.getAttr("max").toInt()),""!==c.getAttr("step","")&&(f.step=c.getAttr("step").toInt()),zjs.isArray(f.valueArray)){var p=[];zjs.foreach(f.valueArray,function(e){e=parseFloat(e),zjs.isNumeric(e)&&p.push(e)}),p=p.sort(function(e,i){return e-i}),f.valueArray=p,f.valueArray.length<=1&&(f.valueArray=!1)}zjs.isArray(f.valueArray)&&(f.min=f.valueArray[0],f.max=f.valueArray[f.valueArray.length-1],f.step=0),f.indicatorAsSelectList&&(f.indicator=!0),c.setData(e,f);var j=zjs(d).insertAfter(c),A=!1;if(f.indicator&&f.step>0){A=z('<div class="indicators">').appendTo(j);for(var h=f.min;h<=f.max;h+=f.step)zjs("<span>").addClass("num-"+h).html(h+"").appendTo(A).on("click",function(){var e=h;return function(i){i.preventDefault(),v(c,e)}}());A.child().item(0).addClass("num-first")}var g=!1,y=!1;if(f.indicatorAsSelectList&&f.step>0&&f.checkMobileDevice()){g=zjs('<div class="select-wrapper">').appendTo(j);var x="_uisliderselect"+zjs.getUniqueId();y=zjs("<select>").appendTo(g).setAttr("id",x).addClass("prevent"),zjs('<label class="select-label">').setAttr("for",x).appendTo(g);for(var h=f.min;h<=f.max;h+=f.step)zjs("<option>").setAttr("value",h).html(""+h).appendTo(y);y.on("change",function(){v(c,y.getValue())})}var D=c.getAttr("id","");""!=D&&j.setAttr("id","slider-for-"+D),c.setData(i,j),f.checkMobileDevice()&&j.addClass(r),j.on("selectstart",function(e){return e.preventDefault(),e.stop(),!1}),c.addClass(o);var k=j.find("."+s),b=j.find("."+n).width(0),S=j.find("."+l).left(0),w=0;S.drag({onStart:function(e,i){zjs(i).addClass("moving")},onDrag:function(e,i,t,r){u(t.x+r.left)},onDrop:function(e,i,t,r){zjs(i).removeClass("moving")}}),zjs(window).on("resize",function(){v(t,c.getValue())}).trigger("resize")},v=function(t,r){var a=zjs(t),d=a.getData(e);if(d){var o=r,u=a.getData(i),v=u.find("."+s),c=u.find("."+n),f=u.find("."+l),m=v.width(),z=f.width();if(!isNaN(d.step)&&d.step>0&&(o=Math.round((o-d.min)/d.step)*d.step+d.min),zjs.isArray(d.valueArray)){var p;for(p=1;p<d.valueArray.length&&!(d.valueArray[p]>=o);p++);o=o-d.valueArray[p-1]<d.valueArray[p]-o?d.valueArray[p-1]:d.valueArray[p]}o<d.min&&(o=d.min),o>d.max&&(o=d.max);var j=(o-d.min)/(d.max-d.min)*(m-z);f.left(j),c.width(j);var A=u.find(".indicators");A.count()&&(A.find("span").removeClass("active"),A.find(".num-"+o).addClass("active"));var h=a.getValue(),g=zjs.enablehook();zjs.enablehook(!1),a.setValue(o),zjs.enablehook(g),h!=o&&a.trigger("ui:slider:change",{value:o,via:"setvalue"}),d.referer&&zjs(d.referer).setInnerHTML(o)}};zjs.extendMethod({makeUiSlider:function(e){return this.eachElement(function(i){u(i,e)})},getUiSliderElement:function(){return this.item(0).getData(i)},sliderSetValue:function(e){return this.eachElement(function(i){v(i,e)})}}),zjs.hook({after_setInnerHTML:function(e){zjs(e).find(".zuislider").makeUiSlider()},after_insertDOM:function(e){zjs(e).hasClass("zuislider")&&zjs(e).makeUiSlider(),zjs(e).find(".zuislider").makeUiSlider()},after_setValue:function(e){v(e,zjs(e).getValue())}}),zjs.onready(function(){zjs(".zuislider").makeUiSlider()}),"required"in zjs&&zjs.required("ui.slider")});