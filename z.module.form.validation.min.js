(function(e){"use strict";function t(e,t,a,n){k[t]=a,w.push(t)}var a="zjsmoduleformvalidationoption",n="zjsmoduleformvalidationtipel",i="zjsmoduleformvalidationinputel",r="zjsmoduleformvalidationpassStatus",u="zmoduleuidatepickerwrapel",s="zui-datepicker-input",o="zjsmoduleimagepickerwrapel",d="zmoduleautosuggestionwrapel",l="zui-autosuggestion-input",F="ckeditorinstance",c=e("html").getAttr("lang","en").split("-");c=c[0];var g={en:{required:"Field is required",email:"Not a valid email",url:"Not a valid url",date:"Not a valid date",number:"Not a number",phonenumber:"Not a phone number",digits:"Not a digits",minlength:"Value as least minlength",repassword:"The specified passwords do not match"},es:{required:"Campo obligatorio",email:"No es un correo electrónico válido",url:"No es una URL válida",date:"No es una fecha válida",number:"No un número",phonenumber:"No es un número de teléfono",digits:"No un dígito",minlength:"Valor como mínimo minlength",repassword:"Las contraseñas especificadas no coinciden"},de:{required:"Feld ist erforderlich",email:"Keine gültige E-Mail",url:"Nicht eine gültige URL",date:"Nicht gültiges Datum",number:"Nicht eine Nummer",phonenumber:"Nicht eine Telefonnummer",digits:"Nicht eine Ziffern",minlength:"Wert so wenig minderlth",repassword:"Die eingegebenen Passwörter stimmen nicht überein"},it:{required:"Campo obbligatorio",email:"Non è un'e-mail valida",url:"Non un URL valido",date:"Non è una data valida",number:"non un numero",phonenumber:"Non un numero di telefono",digits:"Non una cifra",minlength:"Valore minima di lunghezza minima",repassword:"Le password specificate non corrispondono"},vi:{required:"Còn thiếu thông tin này",email:"Sai định dạng email",url:"Sai định dạng url",date:"Sai định dạng ngày",number:"Không phải là số",phonenumber:"Không phải là số điện thoại",digits:"Không phải là số",minlength:"Không đủ chiều dài quy định",repassword:"Mật khẩu nhập lại không chính xác"}};e.extendCore({moduleFormValidationOption:{errorClass:"error",successClass:"success",language:c,tips:{},preventClass:"prevent",checkboxClass:"checkbox",radiogroupClass:"radiogroup",dategroupClass:"dategroup",customInputClass:"zvalidation-custom-input",preventPressEnterToSubmit:!1,autoCheckWhenBlur:!0,autoCheckWhenInput:!1,onlyone:!1}});var p="z-form-validation",f="z-form-field",m="checktip",h="text",C='<div class="'+m+'"><div class="'+h+'"></div></div>',D="",v=function(e,t){return"TEXTAREA"===e.tagName()&&"CKEDITOR"in window&&""!==e.getAttr("id","")&&e.getAttr("id")in window.CKEDITOR.instances&&window.CKEDITOR.instances[e.getAttr("id")].element.$===t},x=function(t,o){var c=e(t),h=c.getData(a);if(h)c.setData(a,e.extend(h,o));else{h=e.clone(e.moduleFormValidationOption);var x=c.getAttr("data-option","");e.isString(x)&&""!=x.trim()&&(h=e.extend(h,x.jsonDecode())),c.removeAttr("data-option"),void 0!==o&&(h=e.extend(h,o)),!h.language in g&&(h.language="en"),h.tips=e.extend(g[h.language],h.tips),h.preventPressEnterToSubmit=!!h.preventPressEnterToSubmit,h.onlyone=!!h.onlyone,h.onlyone&&(h.autoCheckWhenBlur=!1),c.setData(a,h),D="input[type=text], input[type=email], input[type=password], input.zimagepicker, textarea, select, ."+h.checkboxClass+", ."+h.radiogroupClass+", ."+h.dategroupClass,c.addClass(p);var b=function(){var t=e.enablehook();e.enablehook(!1),c.find(D+", ."+h.customInputClass).eachElement(function(t){var a=e(t);if(!a.hasClass(l)&&!a.hasClass(s)&&!a.hasClass("js-dategroup-item"))if(a.findUp("."+h.dategroupClass).count())a.addClass("js-dategroup-item");else if(!a.getData(i,!1)){a.setData(i,!0);var r=e(C).hide(),o=a.getAttr("name");a.hasClass(h.checkboxClass)&&!a.is("input")&&(o=a.find("> input[type=checkbox]").getAttr("name")),r.addClass(m+"-"+o),r.insertAfter(a);var g=a.getData(d);g&&r.insertAfter(g);var p=a.getData(u);p&&r.insertAfter(p);var D=!1;v(a,t)&&(D=window.CKEDITOR.instances[a.getAttr("id")],a.setData(F,D)),a.setData(n,r),h.autoCheckWhenBlur&&a.on("blur, ui:autosuggestion:blur, ui:datepicker:blur",function(e){E(a,y(a,h,c),h)}),h.autoCheckWhenInput&&a.on("input, ui:autosuggestion:input",function(){E(a,y(a,h,c),h)}),a.is("select")&&a.on("change, ui:selectbox:change, ui:selectbox:blur, ui:autosuggestion:choice, ui:autosuggestion:blur",function(){E(a,y(a,h,c),h)}),a.hasClass(h.radiogroupClass)&&a.on("click","input[type=radio]",function(){E(a,y(a,h,c),h)}),a.hasClass(h.checkboxClass)&&(a.is("input")?a.on("click",function(){E(a,y(a,h,c),h)}):a.on("click","input[type=checkbox]",function(){E(a,y(a,h,c),h)})),a.hasClass(h.dategroupClass)&&(h.autoCheckWhenBlur&&a.find("input").on("blur",function(){E(a,y(a,h,c),h)}),h.autoCheckWhenInput&&a.find("input").on("input",function(){E(a,y(a,h,c),h)})),a.parent().addClass(f)}}),e.enablehook(t)};b(),e.hook({after_insertDOM:function(e){b()}});var z=!1;c.on("submit",function(e){if(A(t,e)){if(this.removeClass("zvalidation-invalid"),z)return z=!1,e.preventDefault(),void e.stopPropagation();this.trigger("form:validation:success",{},function(t){t.isDefaultPrevented&&e.preventDefault()})}else this.addClass("zvalidation-invalid").trigger("form:validation:failed",{status:c.getData(r)})}),e(window).on("keydown",function(t){if(13==t.getKeyCode()){var n=e(t.target()).findUp("form");if(n.count()>0){var i=n.getData(a,!1);if(!i)return;i.preventPressEnterToSubmit&&(z=!0)}}}),function(){c.find(".autofocus").focus()}.delay(100)}},A=function(t,n,i){i=i||!1;var u=e(t),o=u.getData(a);if(o){"moduleEditorOption"in e&&u.find("textarea").editorSave();var c,g=!0,p={};if(u.find("input,textarea,select,."+o.checkboxClass+",."+o.radiogroupClass+",."+o.dategroupClass+",."+o.customInputClass).eachElement(function(t){var a=e(t);if((a.is(D+", ."+o.customInputClass)||a.getData(d,!1))&&!a.hasClass("js-dategroup-item"))if(a.findUp("."+o.dategroupClass).count())a.addClass("js-dategroup-item");else if(!a.hasClass(l)&&!a.hasClass(s)){if(!a.getData(F,!1)&&v(a,t)){var n=window.CKEDITOR.instances[a.getAttr("id")];a.setData(F,n),o.autoCheckWhenInput&&n.on("change",function(e){e.editor.updateElement(),E(a,y(a,o,u),o)}),o.autoCheckWhenBlur&&n.on("blur",function(e){e.editor.updateElement(),E(a,y(a,o,u),o)})}a.getData(F,!1)&&a.getData(F).updateElement(),E(t,c=y(t,o,u),o,i);var r=a.getAttr("name","");return""!==r&&(p[r]=c),!(!c.pass&&(g=!1,o.onlyone))&&void 0}}),u.setData(r,p),!g){try{void 0!==n&&n&&n.preventDefault()}catch(e){}if(i)return!1;var f=u.find("."+o.errorClass).item(0);return f.getData(F,!1)?f.getData(F).focus():"isAutosuggestion"in f&&f.isAutosuggestion()?f.autosuggestionFocus():f.is("input")||f.is("textarea")||f.is("select")?f.focus():f.hasClass("radiogroup")&&"moduleTransition"in e&&e(document.body).playTransition("scrollTop",f.getAbsoluteTop()-100,{time:800}),!1}return!0}},b=function(t){var i=e(t),r=i.getData(a,!1);r&&i.find("input,textarea,select,."+r.checkboxClass).eachElement(function(t){var a=e(t),i=a.getData(n,!1);if(i){i.hide(),a.removeClass(r.errorClass);var s=a.getData(u,!1);s&&s.removeClass(r.errorClass);var l=a.getData(o,!1);l&&l.removeClass(r.errorClass);var c=a.getData(d,!1);c&&c.removeClass(r.errorClass);var g=a.getData(F,!1);g&&e(g.container.$).removeClass(r.errorClass)}})},E=function(t,a,i,r){var s=e(t);if(a.pass){var l=r?"":i.successClass;s.removeClass(i.errorClass),s.hasClass("required")&&s.addClass(l);var c=s.getData(n);c&&c.hide();var g=s.getData(u,!1);g&&g.removeClass(i.errorClass).addClass(l);var p=s.getData(o,!1);p&&p.removeClass(i.errorClass).addClass(l);var f=s.getData(d,!1);f&&f.removeClass(i.errorClass).addClass(l);var m=s.getData(F,!1);m&&e(m.container.$).removeClass(i.errorClass).addClass(i.successClass)}else if(!r){s.addClass(i.errorClass).removeClass(i.successClass);c=s.getData(n);if(c){var C="";""!=s.getAttr("data-tip-"+a.type,"")?C=s.getAttr("data-tip-"+a.type,""):void 0!==i.tips[a.type]&&(C=i.tips[a.type]),c.show().find("."+h).setInnerHTML(C).setAttr("data-type",a.type)}g=s.getData(u,!1);g&&g.addClass(i.errorClass).removeClass(i.successClass);p=s.getData(o,!1);p&&p.addClass(i.errorClass).removeClass(i.successClass);f=s.getData(d,!1);f&&f.addClass(i.errorClass).removeClass(i.successClass);m=s.getData(F,!1);m&&(e(m.container.$).addClass(i.errorClass).removeClass(i.successClass),"required"===a.type&&m.document.getBody().setHtml("")),s.trigger("form:validation:error",{type:a.type})}},y=function(t,a,n){var i=e(t);if(i.hasClass(a.preventClass))return{pass:!0};i.getAttr("id","").trim().toLowerCase();var r=i.getAttr("name","").trim().toLowerCase(),s=i.getAttr("type","").trim().toLowerCase(),d=i.getAttr("class","").trim().toLowerCase(),l=i.getValue("").trim();if(i.getData(F,!1)&&(l=i.getData(F).document.getBody().getText().trim()),i.hasClass(a.radiogroupClass)&&(l=i.find("input[type=radio]:checked").getValue("").trim()),i.hasClass(a.checkboxClass)&&(i.is("input")?i.is(":checked")||(l=""):l=i.find("input[type=checkbox]:checked").getValue("").trim()),i.hasClass(a.dategroupClass)){var c=null,g=null,p=null;i.find("input").eachElement(function(e){var t=z(e).getAttr("name","").trim().toLowerCase();t.indexOf("year")>=0?p=z(e):t.indexOf("month")>=0?g=z(e):t.indexOf("day")>=0&&(c=z(e))});var f=[];p&&p.getValue()&&f.push(p.getValue()),g&&g.getValue()&&f.push(g.getValue()),c&&c.getValue()&&f.push(c.getValue()),l=f.length>2?f.join("-"):""}if(i.hasClass(a.customInputClass)&&(l=i.getAttr("data-value","")),i.getData(u,!1)&&(l=i.getValue()),i.getData(o,!1)&&(l=i.getValue(),l=l?parseInt(l):0,l<=0&&(l="")),""==l&&(d.indexOf("required")>=0||""!=i.getAttr("data-tip-required","")))return{pass:!1,type:"required"};if(""!=l){if(i.hasClass(a.dategroupClass)&&!k.yearmonthday(l,t))return{pass:!1,type:"date"};var m="";if(r.indexOf("email")>=0||d.indexOf("email")>=0||""!=i.getAttr("data-tip-email","")||"email"==s?m="email":r.indexOf("url")>=0||d.indexOf("url")>=0||""!=i.getAttr("data-tip-url","")?m="url":r.indexOf("phonenumber")>=0||d.indexOf("phonenumber")>=0||""!=i.getAttr("data-tip-phonenumber","")?m="phonenumber":r.indexOf("number")>=0||d.indexOf("number")>=0||""!=i.getAttr("data-tip-number","")||"number"==s?m="number":r.indexOf("digits")>=0||d.indexOf("digits")>=0||""!=i.getAttr("data-tip-digits","")?m="digits":(r.indexOf("date")>=0||d.indexOf("zdatepicker")>=0||""!=i.getAttr("data-tip-date","")||"date"==s)&&(m="date"),"number"==m&&i.hasClass("allow-alphabet")&&(m=""),""!=m&&!k[m](l,t))return{pass:!1,type:m}}if(""!=l&&((r.indexOf("minlength")>=0||d.indexOf("minlength")>=0||""!=i.getAttr("data-tip-minlength","")||null!==i.getAttr("minlength",null)||null!==i.getAttr("data-minlength",null))&&(m="minlength"),""!=m&&!k[m](l,t)))return{pass:!1,type:m};if("password"==s&&(r.indexOf("repassword")>=0||r.indexOf("pass[pass2]")>=0||d.indexOf("repassword")>=0||""!=i.getAttr("data-tip-repassword",""))){var h=n.find('input[type="password"]');if(h.count()>1){var C=-1;if(h.eachElement(function(e,t){i.isTheSame(e)&&(C=t)}),C>=1&&i.getValue("")!=h.item(C-1).getValue())return{pass:!1,type:"repassword"}}}if(""!=l)for(var D=0;D<w.length;D++){var v=w[D];if(i.is("[data-"+v+"]")){var x=i.getAttr("data-"+v,"");if(!k[v](l,t,x,n))return{pass:!1,type:v}}}return n.trigger("form:validation:checking",{element:t,option:a},function(e){}),{pass:!0}},k={email:function(e,t){return/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(e)},url:function(e,t){return/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(e)},date:function(e,t){return!/Invalid|NaN/.test(new Date(e).toString())},yearmonthday:function(e,t){if(!k.dateISO(e))return!1;var a=e.split("-"),n=[parseInt(a[0]),parseInt(a[1]).toPaddedString(2),parseInt(a[2]).toPaddedString(2)].join("-"),i=new Date(n+"T00:00:00Z");return!isNaN(i.getDate())&&n===i.toISOString().slice(0,10)},dateISO:function(e,t){return/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}$/.test(e)},number:function(e,t){return/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(e)},phonenumber:function(e,t){return!((e+" ").trim().length<3)&&/^(?:(?:\(?(?:00|\+)([1-4]\d\d|[1-9]\d?)\)?)?[\-\.\ \\\/]?)?((?:\(?\d{1,}\)?[\-\.\ \\\/]?){0,})(?:[\-\.\ \\\/]?(?:#|ext\.?|extension|x)[\-\.\ \\\/]?(\d+))?$/.test(e)},digits:function(e,t){return/^\d+$/.test(e)},creditcard:function(e,t){if(/[^0-9 \-]+/.test(e))return!1;var a=0,n=0,i=!1;e=e.replace(/\D/g,"");for(var r=e.length-1;r>=0;r--){var u=e.charAt(r);n=parseInt(u,10),i&&(n*=2)>9&&(n-=9),a+=n,i=!i}return a%10==0},minlength:function(t,a){var n=e(a).getAttr("data-minlength",null);return null===n&&(n=e(a).getAttr("minlength",null)),null===n&&(n=0),n=parseInt(n),!isNaN(n)&&(t+" ").trim().length>=n},maxlength:function(e,t,a){return!1},rangelength:function(e,t,a){return!1},min:function(e,t,a){return!1},max:function(e,t,a){return!1},range:function(e,t,a){return!1},equalTo:function(e,t,a){return!1}},w=[];e.extendMethod({formValidation:function(e){return this.eachElement(function(t){x(t,e)})},formValidationReset:function(){return this.eachElement(function(e){b(e)})},formValidationCheck:function(e){var t=!1;return this.eachElement(function(a){t=A(a,!1,e)}),t},formValidationCheckInSilent:function(){return this.formValidationCheck(!0)},formValidationAddTestType:function(e,a,n){return this.eachElement(function(i){t(i,e,a,n)})}}),e.hook({after_setInnerHTML:function(t){var a=e(t);a.find(".zvalidation").formValidation()},after_insertDOM:function(t){e(t).hasClass("zvalidation")&&e(t).formValidation(),e(t).find(".zvalidation").formValidation()}}),e.onready(function(){e(".zvalidation").formValidation()}),"required"in e&&e.required("form.validation")})(zjs);