zjs.require("ui",function(){zjs.extendCore({moduleUiTocOption:{marginTop:15,scrollTime:800,scrollTransition:"ease",allowUpdateUrl:!0,autoAddlevelClass:!0}});var u=function(){return!zjs(document.body).hasClass("zui-scrollbar-usedefault")&&0<parseInt(zjs(document.body).getData("zmodulescrollbarid",0))},x=function(b,h){function y(){var a=e.marginTop;"freezepanelGetVisibleFreezingHeight"in zjs&&(a+=zjs.freezepanelGetVisibleFreezingHeight());return parseInt(a)}function p(){d=[];v(c,null,-1)}function v(a,
f,q){a=zjs(a);f=f||[];zjs.isArray(f)||(f=[]);var c=zjs.extend([],f);if(a.find("> a").count()){f=a.find('> a[href^="#"], > [data-target-element]');if(0<f.count()){var b=!1,g=f.item(0).getAttr("href",""),k;0===g.indexOf("#")&&(k=zjs(g),0<k.count()&&(b=k));k=f.item(0).getAttr("data-target-element","");b||(k=zjs(k),0<k.count()&&(b=k));d.push({nav:f.item(0,!0),item:b?b.item(0,!0):!1,itemTop:0,parentNavs:c,href:g});f.addClass("zui-toc-link");f.setData("zmoduleuitocacontainerel",a);c=zjs.extend([],c);c.push(f.item(0,
!0))}q++;e.autoAddlevelClass&&a.addClass("toc-level-"+q);a.find(">ul,>div").each(function(a){v(a,c,q)})}else a.child().each(function(a){v(a,c,q)})}function l(){for(var a=0;a<d.length;a++)d[a].itemTop=zjs(d[a].item).getAbsoluteTop();d.sort(function(a,c){return a.itemTop-c.itemTop})}function m(){for(var a=0,b=w.scrollTop()+y()+10;a<d.length&&!(d[a].itemTop>b);a++);a--;c.find("div,ul,li").removeClass("active");0>a||(zjs(d[a].nav).getData("zmoduleuitocacontainerel").addClass("active"),zjs.foreach(d[a].parentNavs,
function(a){zjs(a).getData("zmoduleuitocacontainerel").addClass("active")}))}var c=zjs(b),e=c.getData("zmoduleuitocoption");if(e)c.setData("zmoduleuitocoption",zjs.extend(e,h));else{var e=zjs.clone(zjs.moduleUiTocOption),g=c.getAttr("data-option","");zjs.isString(g)&&""!=g.trim()&&(e=zjs.extend(e,g.jsonDecode()));"undefined"!=typeof h&&(e=zjs.extend(e,h));c.setData("zmoduleuitocoption",e);c.addClass("zui-toc");var w=zjs(window),g=zjs(document.body),r=!0;u()&&(r=!1,g.on("scrollbar.ready",function(){r=
!0}));var d=[];c.on("click","a.zui-toc-link",function(a){for(var c=a.target(),b=0,g=!1;b<d.length;b++)if(d[b].nav==c){g=!0;a.preventDefault();break}if(g){var h=!1;zjs(d[b].item).trigger("ui:toc:out:trigger",{},function(a){h=a.isDefaultPrevented});h||(p(),l(),x(d[b].itemTop),zjs(d[b].nav).findUp("li").addClass("pre-active"),e.allowUpdateUrl&&""!=d[b].href&&zjs.supportHistory&&history.pushState("",document.title,d[b].href))}});var n=!1,t=zjs.timer({onProcess:function(a){window.scrollTo(0,a)},onFinish:function(){n=
!1;c.find("li").removeClass("pre-active")},onStop:function(){n=!1;c.find("li").removeClass("pre-active")}}),x=function(a){a=(a||0)-y();0>a&&(a=0);t.stop();t.set({from:w.scrollTop(),to:a,time:e.scrollTime,transition:e.scrollTransition});t.run();n=!0};if(u())g.on("scrollbar.scroll",function(){m()});w.on("scroll",function(){u()||(!r&&zjs(document.body).hasClass("zui-scrollbar-usedefault")&&(r=!0),m())}).on("mousewheel",function(a){n&&(t.stop(),n=!1)}).on("resize",function(){l();m()});p();l();m();zjs.hook({after_setInnerHTML:function(a){},
after_insertDOM:function(a){a=zjs(a).findUp(".zui-toc");0<a.count()&&a.isTheSame(c)&&(p(),l())}});c.trigger("ui:toc:load");c.on("ui:toc:refresh",function(){p();l();m()})}};zjs.extendMethod({makeToc:function(b){return this.each(function(h){x(h,b)})},tocRefresh:function(){return this.each(function(b){zjs(b).trigger("ui:toc:refresh")})}});zjs.hook({after_setInnerHTML:function(b){zjs(b).find(".ztoc").makeToc()},after_insertDOM:function(b){zjs(b).hasClass("ztoc")&&zjs(b).makeToc();zjs(b).find(".ztoc").makeToc()}});
zjs.onready(function(){zjs(".ztoc").makeToc()});"required"in zjs&&zjs.required("ui.toc")});