(function(d,f){var e={},g=function(a){this.img=!1;this.src=a;this.localCache=!0};d.extend(g.prototype,{load:function(a,c){this.callback=a;this.errorCallback=c||!1;var b=this,d=function(a){if(a)return b.onLoad();b.img||(b.img=new Image);b.img.src=b.src;if(b.img.complete){a=b.img.naturalWidth;a===f&&(a=b.img.width);var c=b.img.naturalHeight;c===f&&(c=b.img.height);b.onLoad(a,c)}else b.img.onload=function(){b.onLoad(this.width,this.height)},b.img.onerror=function(){b.onError()}};b.localCache&&"undefined"!=
typeof ImgCache?ImgCache.isCached(b.src,function(a,c){c?(ImgCache.options.debug&&console.log("[img loader] is cached! ",a),ImgCache.getCachedFileURL(b.src,function(a,c){ImgCache.options.debug&&console.log("[img loader] getCachedFileURL:",a,c);e[b.src]=c;b.src=c;d(!0)})):(ImgCache.options.debug&&console.log("[img loader] not cached! ",a),ImgCache.cacheFile(b.src,function(){ImgCache.options.debug&&console.log("[img loader] cacheFile:",b.src);ImgCache.getCachedFileURL(b.src,function(a,c){ImgCache.options.debug&&
console.log("[img loader] cacheFile -> getCachedFileURL:",a,c);e[b.src]=c;b.src=c;d(!0)})}))}):(e[b.src]=b.src,d())},onLoad:function(a,c){this.img=f;this.callback&&this.callback({src:this.src,width:a,height:c})},onError:function(){this.img=f;this.errorCallback&&this.errorCallback({src:this.src})},setOptionLocalCache:function(a){this.localCache=a;return this}});d.extendCore({loadImage:function(a){a=d.extend({image:"",localCache:!0,onError:function(a){},onLoaded:function(a){}},a);(new g(a.image)).setOptionLocalCache(a.localCache).load(function(c){a.onLoaded(c)},
function(c){a.onError(c)})},loadImages:function(a){a=d.extend({path:"",images:[],delay:800,localCache:!0,onError:function(a){},onLoaded:function(a){},onLoading:function(a){},onFinish:function(){}},a);0>=a.delay&&(a.delay=1);for(var c=a.images.length,b=0,f=0,e=!1,h=0;h<c;h++)(new g(a.path+a.images[h])).setOptionLocalCache(a.localCache).load(function(g){!1!==e&&e.stop();(e=d.timer({from:f,to:++b/c*100,time:a.delay,transition:"linear",onProcess:function(b){b=b.toInt();100<b&&(b=100);a.onLoading(f=b)},
onStop:function(){a.onLoaded(g)},onFinish:function(){if(b>=c)a.onFinish()}})).run()},function(b){a.onError(b)})},imageLoaderGetCacheUrl:function(a){return e[a]}});"required"in d&&d.required("image.loader")})(zjs);