zjs.require("ui, transition",function(){var k=!1,q=!1;zjs.extendCore({moduleParallaxOption:{property:"margin",horizontal:!1,sectionclass:"zparallax-section",elementclass:"zparallax-element",keyframes:!1,indicator:!1,indicatorTemplate:'<a class="indicator">.</a>',autoscaleusecss:!1,scrolltime:800,transition:2,timewaittofocus:200,debug:!1}});var C=function(e,c){var a=zjs(e),d=a.getData("zmoduleparallaxoption");if(d)a.setData("zmoduleparallaxoption",zjs.extend(d,c));else{var d=zjs.clone(zjs.moduleParallaxOption),
b=a.getData("inlineoption","");""==b&&(b=a.getAttr("data-option",""));zjs.isString(b)&&""!=b.trim()&&(d=zjs.extend(d,b.jsonDecode()),a.setData("inlineoption",b));a.removeAttr("data-option");"undefined"!=typeof c&&(d=zjs.extend(d,c));a.setData("zmoduleparallaxoption",d);a.addClass("zparallax");a.addClass(d.horizontal?"zparallax-horizontal":"zparallax-vertical");d.autoscaleusecss&&a.addClass("zparallax-autoscale");var g=!1;d.indicator&&(a.append('<div class="zparallax-indicator-wrapper"><div class="zparallax-indicator-container"></div></div>'),
g=a.find(".zparallax-indicator-container"));var f=[];zSectionEls=a.find("."+d.sectionclass);zSectionEls.each(function(a,c){var b=zjs(a);d.autoscaleusecss&&b.top(100*c+"%");b.setData("zmoduleparallaxautoscale",b.getAttr("data-autoscale"));b.removeAttr("data-autoscale");var h=b.getAttr("data-name","");""==h&&(h="section"+(c+1),b.setAttr("data-name",h));f.push(h);d.indicator&&(b=d.indicatorTemplate,zjs.isFunction(b)&&(b=b(c,h)),b=b.format({index:c,name:h}),zjs(b).addClass("zparallax-indicator").setAttr("data-name",
h).appendTo(g).click(function(a,d){var b=zjs(d).getAttr("data-name","");n(e,b)}))});a.setData("zmoduleparallaxlistsectionname",f);var x=a.find(".zparallax-navigation[data-name]").click(function(){var a=this.getAttr("data-name");n(e,a)});zElementEls=a.find("."+d.elementclass);var y=0,z=0,l=0,r="",A="",t="";zElementEls.each(function(a){a=zjs(a);var b=0,c=0;"margin"==d.property&&(b=a.getStyle("margin-top",0),c=a.getStyle("margin-left",0));a.setData("originalPropertyTop",b).setData("originalPropertyLeft",
c);b=a.getAttr("data-ratio-vertical",0).toFloat();c=a.getAttr("data-ratio-horizontal",0).toFloat();a.setData("ratioVertical",b).setData("ratioHorizontal",c).removeAttr("data-ratio-vertical").removeAttr("data-ratio-horizontal");b=a.getAttr("data-keyframes","");c=!1;zjs.isString(b)&&""!=b.trim()&&(c=b.jsonDecode());a.removeAttr("data-keyframes");zjs.isObject(c)&&"setKeyframes"in a&&a.setKeyframes("zmoduleparallaxautokeyframe",c);b=a.getAttr("data-keyframes-name","");""!=b&&zjs.isObject(d.keyframes)&&
b in d.keyframes&&a.setKeyframes("zmoduleparallaxautokeyframe",d.keyframes[b])});var p=!1,w=function(){!q&&k&&k.stop();q=!1;p||(l=d.horizontal?a.scrollLeft():a.scrollTop());if(!p&&(p=a.getData("zmodulescrollbaroption"))||p)l=a.scrollPosition();a.setData("zmoduleparallaxcurrentscroll",l);zElementEls.each(function(a){a=zjs(a);var b=a.getData("originalPropertyTop").toFloat(),c=a.getData("originalPropertyLeft").toFloat(),e=a.getData("ratioVertical"),g=a.getData("ratioHorizontal"),f=a.findUp("."+d.sectionclass),
h=f.count()?parseFloat(f.getAttr("data-gap-start-at",0),10):0,k=0;f.count()&&(k=d.horizontal?f.left():f.top());var m=(l-k-h)*e,h=(l-k-h)*g,b=b-m,c=c-h;"margin"==d.property&&(e&&a.setStyle("margin-top",b),g&&a.setStyle("margin-left",c));a.isExistsKeyframes("zmoduleparallaxautokeyframe")&&(e=f.count()?parseFloat(f.getAttr("data-keyframe-start-at",0),10):0,a.setStyleByKeyframes("zmoduleparallaxautokeyframe",l-e));a.trigger("parallax.scroll",{currentScroll:l,gapVertical:m,gapHorizontal:h})});var b=u(e);
r=a.getData("zmoduleparallaxcurrentsection","");b!=r&&(d.indicator&&(g.find(".zparallax-indicator.active").removeClass("active"),g.find('.zparallax-indicator[data-name="'+b+'"]').addClass("active")),x.removeClass("active"),x.filter('[data-name="'+b+'"]').addClass("active"),a.setData("zmoduleparallaxcurrentsection",b),a.trigger("parallax.changesection",{currentSection:b,prevSection:r}));A=a.getData("zmoduleparallaxfocussection");b!=A&&.9<v(e,b)&&function(){a.getData("zmoduleparallaxcurrentsection")==
b&&a.getData("zmoduleparallaxfocussection")!=b&&(a.setData("zmoduleparallaxfocussection",b),a.trigger("parallax.changefocussection",{focusSection:b}))}.delay(d.timewaittofocus);var c=B(e);t=a.getData("zmoduleparallaxlastfullscreensection","");var m=a.find("."+d.sectionclass+'[data-name="'+c+'"]').item(0);c!=t&&(a.setData("zmoduleparallaxlastfullscreensection",c),a.trigger("parallax.risingsection",{prevSection:f[f.indexOf(c)-1],nextSection:c,percent:1}),a.trigger("parallax.changefullscreensection",
{lastFullScreenSection:c,prevFullScreenSection:t}));var h=f.indexOf(c);h<f.length-1&&a.trigger("parallax.risingsection",{prevSection:c,nextSection:f[h+1],percent:(l-m.top())/m.height()})},b=function(){y=zjs(window).width();z=zjs(window).height();var b=0;zSectionEls.each(function(a){a=zjs(a);var c=a.getData("zmoduleparallaxautoscale");d.autoscaleusecss||"0"==c||0==c||"false"==c||a.width(y).height(z);b+=a.width()});d.horizontal&&(a.width(b),a.getData("zmodulescrollbaroption")&&a.refreshScroll());w()};
b();a.on("scrollbar.scroll",w);zjs(window).on("scroll",w);zjs(window).on("resize",b);p&&a.refreshScroll();""!=document.location.hash&&function(){n(e,document.location.hash.replace("#",""))}.delay(1E3)}},n=function(e,c){c=c||"";var a=zjs(e),d=a.getData("zmoduleparallaxoption");if(!d)return!1;var b=a.find("."+d.sectionclass+'[data-name="'+c+'"]').item(0);if(1>b.count())return!1;b=b.top();if(a.getData("zmodulescrollbaroption"))return a.scrollTo(b),!0;if(0<d.scrolltime)return k?k.stop():k=zjs.timer({onProcess:function(a){q=
!0;window.scrollTo(d.horizontal?a:0,d.horizontal?0:a)},onFinish:function(){}}),k.set({from:d.horizontal?zjs(window).scrollLeft():zjs(window).scrollTop(),to:b,time:d.scrolltime,transition:d.transition}).run(),!0;window.scrollTo(d.horizontal?b:0,d.horizontal?0:b)},v=function(e,c){c=c||"";var a=zjs(e),d=a.getData("zmoduleparallaxoption");if(!d)return 0;var b=a.find("."+d.sectionclass+'[data-name="'+c+'"]').item(0);if(1>b.count())return 0;var d=b.top(),b=b.height(),a=a.getData("zmoduleparallaxcurrentscroll"),
g=zjs(window).height();if(0>=g)return 0;d=a>=d?(b-a+d)/g:(a+g-d)/g;0>d&&(d=0);return d},u=function(e){var c=zjs(e).getData("zmoduleparallaxlistsectionname",!1);if(!c||!zjs.isArray(c))return"";for(var a="",d=0,b=0;b<c.length;b++){var g=v(e,c[b]);g>d&&(a=c[b],d=g)}return a},B=function(e){e=zjs(e);var c=e.getData("zmoduleparallaxlistsectionname",!1);if(!c||!zjs.isArray(c))return"";for(var a=e.getData("zmoduleparallaxoption"),d=e.getData("zmoduleparallaxcurrentscroll",0),b="",g,f=0;f<c.length-1;f++)g=
e.find("."+a.sectionclass+'[data-name="'+c[f]+'"]').item(0),1>g.count()||d>=g.top()&&(b=c[f]);return b};zjs.extendMethod({makeParallax:function(e){return this.each(function(c){C(c,e)})},parallaxScrollToSection:function(e){return this.each(function(c){n(c,e)})},parallaxScrollToNextSection:function(){return this.each(function(e){var c=zjs(e).getData("zmoduleparallaxlistsectionname",!1);if(c||zjs.isArray(c)){var a=u(e);a&&(c=c[c.indexOf(a)+1])&&n(e,c)}})},parallaxGetRatioVisible:function(e){return v(this.item(0,
!0),e)},parallaxGetCurrentSection:function(){return u(this.item(0,!0))},parallaxGetLastFullScreenSection:function(){return B(this.item(0,!0))}});zjs.hook({after_setInnerHTML:function(e){zjs(e).find(".zparallax").makeParallax()},after_insertDOM:function(e){zjs(e).hasClass("zparallax")&&zjs(e).makeParallax();zjs(e).find(".zparallax").makeParallax()}});zjs.onready(function(){zjs(".zparallax").makeParallax()});"required"in zjs&&zjs.required("parallax")});