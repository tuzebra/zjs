zjs.require("ui",function(){zjs.extendCore({moduleUiHovercardOption:{timeBeforeShow:0,timeBeforeHide:200,attribute:"title",horizontal:"left",vertical:"top",autoFixPosition:!0,autoFixArrowPosition:!0,hideWhenHoverCard:!1,customCssClass:"",left:"auto",right:"auto",top:"auto",bottom:"auto",appendToBody:!1,ajaxContent:!1,ajaxContentDataStructure:"",customContentElement:!1}});var w=function(a,d){var b=zjs(a),c=b.getData("zmoduleuihovercardoption");if(c)b.setData("zmoduleuihovercardoption",zjs.extend(c,
d));else{var c=zjs.clone(zjs.moduleUiHovercardOption),e=b.getAttr("data-option","");zjs.isString(e)&&""!=e.trim()&&(c=zjs.extend(c,e.jsonDecode()));b.removeAttr("data-option");"undefined"!=typeof d&&(c=zjs.extend(c,d));b.setData("zmoduleuihovercardoption",c);b.addClass("zui-hovercard");var f=!1;if(zjs.isString(c.customContentElement))e=zjs(c.customContentElement),f=!0;else{e=zjs('<div class="zui-hovercard-panel-wrap zui-uiuninithide"><div class="zui-hovercard-panel-arrow"></div><div class="zui-hovercard-panel"><div class="zui-hovercard-panel-inner"></div></div></div>');
if(c.appendToBody){var g=zjs(document.body).getStyle("position");""!=g&&"static"!=g||zjs(document.body).setStyle("position","relative");e.appendTo(top.document.body).setStyle("z-index",10)}else e.insertAfter(b);""!=c.customCssClass&&e.addClass(c.customCssClass)}e.addClass("js-hovercard-panel").setData("zmoduleuihovercardel",b);b.setData("zmoduleuihovercardwrapel",e);g=b.findUp(".js-hovercard-panel");0<g.count()&&b.setData("zmoduleuihovercardparentwrapel",g);var l=!1;b.longHover(function(){window.clearTimeout(l);
l=!1;u(a)},function(b){l=window.setTimeout(function(){n(a,c.hideWhenHoverCard?!1:b)},c.timeBeforeHide)},c.timeBeforeShow);if(!c.hideWhenHoverCard)e.on("mouseover",function(a){window.clearTimeout(l);l=!1}).on("mouseout",function(b){l=window.setTimeout(function(){n(a,b)},c.timeBeforeHide)});if(f)b.setData("zmoduleuihovercardcustomwrapel",!0);else{f=e.find(".zui-hovercard-panel-inner");if(g=b.getAttr(c.attribute,""))"title"==c.attribute&&(e.addClass("zui-tooltip"),b.removeAttr("title")),f.setInnerHTML(g);
f.setData("zmoduleuihovercardel",b);e.addClass("zui-uihide").removeClass("zui-uiuninithide")}}},u=function(a){var d=zjs(a),b=d.getData("zmoduleuihovercardoption"),c=d.getData("zmoduleuihovercardwrapel"),e=d.getData("zmoduleuihovercardcustomwrapel");if(c){if(!e)try{var f=d.getStyle("position","");""!=f&&"static"!=f||d.is("tr")||d.addClass("zui-hovercard-fix")}catch(m){}if(e||!b.ajaxContent||d.getData("zmoduleuihovercardajaxloaded")){if(c.removeClass("zui-uihide").addClass("active"),v(a),c=d.getData("zmoduleuihovercardparentwrapel"))e=
c.getData("zmoduleuihovercardwrapelbelongcount",0).toInt()+1,c.setData("zmoduleuihovercardwrapelbelongcount",e)}else{var g=c.find(".zui-hovercard-panel-inner"),l=""!=b.ajaxContentDataStructure?"json":"html";zjs.ajax({url:b.ajaxContent,dataType:l,success:function(c){var e=c;"json"===l&&zjs.isObject(c)&&(e=zjs.getValueByKey(c,b.ajaxContentDataStructure));d.setData("zmoduleuihovercardajaxloaded",!0);g.setInnerHTML(e);n(a);u(a)}})}}},n=function(a,d){var b=zjs(a),c=b.getData("zmoduleuihovercardwrapel"),
e=b.getData("zmoduleuihovercardcustomwrapel");if(c){var f=c.getData("zmoduleuihovercardwrapelbelongcount",0).toInt();if(!(0<f)){if(d){f=c.item(0,!0);try{for(var g=d.getToTarget();g;){if(g==f)return;if(g==document)break;g=g.parentNode}}catch(l){}}e?c.removeClass("active"):(b.removeClass("zui-hovercard-fix"),c.addClass("zui-uihide").removeClass("zui-left").removeClass("zui-right").removeClass("zui-top").removeClass("zui-bottom").top("auto").bottom("auto").left("auto").top("auto"));if(b=b.getData("zmoduleuihovercardparentwrapel"))f=
b.getData("zmoduleuihovercardwrapelbelongcount",0).toInt()-1,0>f&&(f=0),b.setData("zmoduleuihovercardwrapelbelongcount",f),n(b.getData("zmoduleuihovercardel"),d)}}},v=function(a){var d=zjs(a),b=d.getData("zmoduleuihovercardwrapel"),c=d.getData("zmoduleuihovercardcustomwrapel");if(b&&!c){c=b.find(".zui-hovercard-panel-arrow");b.find(".zui-hovercard-panel-inner");var e=d.left(),f=d.right(),g=d.top(),l=d.bottom(),m=d.width(),n=d.height(),p=b.width(),r=b.height(),h=d.getData("zmoduleuihovercardoption"),
k=h.horizontal,q=h.vertical;if(h.appendToBody){for(var e=d.getAbsoluteLeft(),f=d.getAbsoluteRight(),g=d.getAbsoluteTop(),l=d.getAbsoluteBottom(),d="",t=!1;a&&a!=document.body;){try{if(d=zjs(a).getStyle("position"),"fixed"==d){t=!0;break}}catch(x){}a=a.parentNode}1==h.autoFixPosition&&(a=zjs(window),"top"==q&&zjs(document.body).height()-l-n-r<(t?0:document.body.scrollTop)&&(q="bottom"),"bottom"==q&&(d=a.height(),g+n+r>(t?0:document.body.scrollTop)+d&&(q="top")),"right"==k&&zjs(document.body).width()-
f-m-p<document.body.scrollLeft&&(k="left"),"left"==k&&(r=a.width(),e+m+p>document.body.scrollLeft+r&&(k="right")))}else 1==h.autoFixPosition&&("center"==k&&p/2>m/2+e&&(k="left"),"center"==k&&p/2>m/2+f&&(k="right"),"left"==k&&p>m+f&&(k="right"),"right"==k&&p>m+e&&(k="left"));"center"==k?(b.addClass("zui-left"),b.left(e-p/2+m/2),c.left(p/2)):"left"==k?(b.addClass("zui-left"),b.left("auto"==h.left?e:parseInt(h.left)),h.autoFixArrowPosition&&c.left("auto"==h.left?m/2:m/2+e-h.left)):"right"==k&&(b.addClass("zui-right"),
b.right("auto"==h.right?f:parseInt(h.right)),h.autoFixArrowPosition&&c.right("auto"==h.right?m/2:m/2+f-h.right));"top"==q?(b.addClass("zui-top"),b.bottom("auto"==h.bottom?l+n:h.bottom)):"bottom"==q&&(b.addClass("zui-bottom"),b.top("auto"==h.top?g+n:h.top));t?b.addClass("zui-fixed"):b.removeClass("zui-fixed")}};zjs.extendMethod({makeHovercard:function(a){return this.eachElement(function(d){w(d,a)})},hovercardShow:function(a){return this.eachElement(function(a){u(a)})},hovercardHide:function(a){return this.eachElement(function(a){n(a,
!1)})},hovercardPanel:function(){var a=[];this.eachElement(function(d){(d=zjs(d).getData("zmoduleuihovercardwrapel"))&&a.push(d.item(0,!0))});return zjs(a)}});zjs.hook({after_setInnerHTML:function(a){a=zjs(a);a.find(".zhovercard").makeHovercard();a.find(".zhovercardcenter").makeHovercard({horizontal:"center"});a.find(".zhovercardleft").makeHovercard({horizontal:"left"});a.find(".zhovercardright").makeHovercard({horizontal:"right"});a.hasClass("zui-hovercard-panel-inner")&&v(a.getData("zmoduleuihovercardel"))},
after_insertDOM:function(a){zjs(a).hasClass("zhovercard")&&zjs(a).makeHovercard();zjs(a).hasClass("zhovercardcenter")&&zjs(a).makeHovercard({horizontal:"center"});zjs(a).hasClass("zhovercardleft")&&zjs(a).makeHovercard({horizontal:"left"});zjs(a).hasClass("zhovercardright")&&zjs(a).makeHovercard({horizontal:"right"});zjs(a).find(".zhovercard").makeHovercard();zjs(a).find(".zhovercardcenter").makeHovercard({horizontal:"center"});zjs(a).find(".zhovercardleft").makeHovercard({horizontal:"left"});zjs(a).find(".zhovercardright").makeHovercard({horizontal:"right"})}});
zjs.onready(function(){zjs(".zhovercard").makeHovercard();zjs(".zhovercardcenter").makeHovercard({horizontal:"center"});zjs(".zhovercardleft").makeHovercard({horizontal:"left"});zjs(".zhovercardright").makeHovercard({horizontal:"right"})});"required"in zjs&&zjs.required("ui.hovercard")});