zjs.require("ui",function(){zjs.extendCore({moduleUiHovercardOption:{timeBeforeShow:0,timeBeforeHide:200,attribute:"title",horizontal:"left",vertical:"top",autoFixPosition:!0,autoFixArrowPosition:!0,hideWhenHoverCard:!1,customCssClass:"",left:"auto",right:"auto",top:"auto",bottom:"auto",appendToBody:!1,ajaxContent:!1,customContentElement:!1}});var w=function(b,c){var a=zjs(b),d=a.getData("zmoduleuihovercardoption");if(d)a.setData("zmoduleuihovercardoption",zjs.extend(d,c));else{var d=zjs.clone(zjs.moduleUiHovercardOption),
e=a.getAttr("data-option","");zjs.isString(e)&&""!=e.trim()&&(d=zjs.extend(d,e.jsonDecode()));a.removeAttr("data-option");"undefined"!=typeof c&&(d=zjs.extend(d,c));a.setData("zmoduleuihovercardoption",d);a.addClass("zui-hovercard");var f=!1;if(zjs.isString(d.customContentElement))e=zjs(d.customContentElement),f=!0;else{e=zjs('<div class="zui-hovercard-panel-wrap zui-uiuninithide"><div class="zui-hovercard-panel-arrow"></div><div class="zui-hovercard-panel"><div class="zui-hovercard-panel-inner"></div></div></div>');
if(d.appendToBody){var g=zjs(document.body).getStyle("position");""!=g&&"static"!=g||zjs(document.body).setStyle("position","relative");e.appendTo(top.document.body).setStyle("z-index",10)}else e.insertAfter(a);""!=d.customCssClass&&e.addClass(d.customCssClass)}e.addClass("js-hovercard-panel").setData("zmoduleuihovercardel",a);a.setData("zmoduleuihovercardwrapel",e);g=a.findUp(".js-hovercard-panel");0<g.count()&&a.setData("zmoduleuihovercardparentwrapel",g);var l=!1;a.longHover(function(){window.clearTimeout(l);
l=!1;u(b)},function(a){l=window.setTimeout(function(){n(b,d.hideWhenHoverCard?!1:a)},d.timeBeforeHide)},d.timeBeforeShow);if(!d.hideWhenHoverCard)e.on("mouseover",function(a){window.clearTimeout(l);l=!1}).on("mouseout",function(a){l=window.setTimeout(function(){n(b,a)},d.timeBeforeHide)});if(f)a.setData("zmoduleuihovercardcustomwrapel",!0);else{f=e.find(".zui-hovercard-panel-inner");if(g=a.getAttr(d.attribute,""))"title"==d.attribute&&(e.addClass("zui-tooltip"),a.removeAttr("title")),f.html(g);f.setData("zmoduleuihovercardel",
a);e.addClass("zui-uihide").removeClass("zui-uiuninithide")}}},u=function(b){var c=zjs(b),a=c.getData("zmoduleuihovercardoption"),d=c.getData("zmoduleuihovercardwrapel"),e=c.getData("zmoduleuihovercardcustomwrapel");if(d){if(!e)try{var f=c.getStyle("position","");""!=f&&"static"!=f||c.is("tr")||c.addClass("zui-hovercard-fix")}catch(l){}if(e||!a.ajaxContent||c.getData("zmoduleuihovercardajaxloaded")){if(d.removeClass("zui-uihide").addClass("active"),v(b),a=c.getData("zmoduleuihovercardparentwrapel"))d=
a.getData("zmoduleuihovercardwrapelbelongcount",0).toInt()+1,a.setData("zmoduleuihovercardwrapelbelongcount",d)}else{var g=d.find(".zui-hovercard-panel-inner");zjs.ajax({url:a.ajaxContent,type:"raw",cache:!1,onComplete:function(a){c.setData("zmoduleuihovercardajaxloaded",!0);g.html(a);n(b);u(b)}})}}},n=function(b,c){var a=zjs(b),d=a.getData("zmoduleuihovercardwrapel"),e=a.getData("zmoduleuihovercardcustomwrapel");if(d){var f=d.getData("zmoduleuihovercardwrapelbelongcount",0).toInt();if(!(0<f)){if(c){f=
d.item(0,!0);try{for(var g=c.toTarget();g;){if(g==f)return;if(g==document)break;g=g.parentNode}}catch(l){}}e?d.removeClass("active"):(a.removeClass("zui-hovercard-fix"),d.addClass("zui-uihide").removeClass("zui-left").removeClass("zui-right").removeClass("zui-top").removeClass("zui-bottom").top("auto").bottom("auto").left("auto").top("auto"));if(a=a.getData("zmoduleuihovercardparentwrapel"))f=a.getData("zmoduleuihovercardwrapelbelongcount",0).toInt()-1,0>f&&(f=0),a.setData("zmoduleuihovercardwrapelbelongcount",
f),n(a.getData("zmoduleuihovercardel"),c)}}},v=function(b){var c=zjs(b),a=c.getData("zmoduleuihovercardwrapel"),d=c.getData("zmoduleuihovercardcustomwrapel");if(a&&!d){d=a.find(".zui-hovercard-panel-arrow");a.find(".zui-hovercard-panel-inner");var e=c.left(),f=c.right(),g=c.top(),l=c.bottom(),m=c.width(),n=c.height(),p=a.width(),r=a.height(),h=c.getData("zmoduleuihovercardoption"),k=h.horizontal,q=h.vertical;if(h.appendToBody){for(var e=c.getAbsoluteLeft(),f=c.getAbsoluteRight(),g=c.getAbsoluteTop(),
l=c.getAbsoluteBottom(),c="",t=!1;b&&b!=document.body;){try{if(c=zjs(b).getStyle("position"),"fixed"==c){t=!0;break}}catch(x){}b=b.parentNode}1==h.autoFixPosition&&(b=zjs(window),"top"==q&&zjs(document.body).height()-l-n-r<(t?0:document.body.scrollTop)&&(q="bottom"),"bottom"==q&&(c=b.height(),g+n+r>(t?0:document.body.scrollTop)+c&&(q="top")),"right"==k&&zjs(document.body).width()-f-m-p<document.body.scrollLeft&&(k="left"),"left"==k&&(r=b.width(),e+m+p>document.body.scrollLeft+r&&(k="right")))}else 1==
h.autoFixPosition&&("center"==k&&p/2>m/2+e&&(k="left"),"center"==k&&p/2>m/2+f&&(k="right"),"left"==k&&p>m+f&&(k="right"),"right"==k&&p>m+e&&(k="left"));"center"==k?(a.addClass("zui-left"),a.left(e-p/2+m/2),d.left(p/2)):"left"==k?(a.addClass("zui-left"),a.left("auto"==h.left?e:parseInt(h.left)),h.autoFixArrowPosition&&d.left("auto"==h.left?m/2:m/2+e-h.left)):"right"==k&&(a.addClass("zui-right"),a.right("auto"==h.right?f:parseInt(h.right)),h.autoFixArrowPosition&&d.right("auto"==h.right?m/2:m/2+f-h.right));
"top"==q?(a.addClass("zui-top"),a.bottom("auto"==h.bottom?l+n:h.bottom)):"bottom"==q&&(a.addClass("zui-bottom"),a.top("auto"==h.top?g+n:h.top));t?a.addClass("zui-fixed"):a.removeClass("zui-fixed")}};zjs.extendMethod({makeHovercard:function(b){return this.each(function(c){w(c,b)})},hovercardShow:function(b){return this.each(function(b){u(b)})},hovercardHide:function(b){return this.each(function(b){n(b,!1)})},hovercardPanel:function(){var b=[];this.each(function(c){(c=zjs(c).getData("zmoduleuihovercardwrapel"))&&
b.push(c.item(0,!0))});return zjs(b)}});zjs.hook({after_setInnerHTML:function(b){b=zjs(b);b.find(".zhovercard").makeHovercard();b.find(".zhovercardcenter").makeHovercard({horizontal:"center"});b.find(".zhovercardleft").makeHovercard({horizontal:"left"});b.find(".zhovercardright").makeHovercard({horizontal:"right"});b.hasClass("zui-hovercard-panel-inner")&&v(b.getData("zmoduleuihovercardel"))},after_insertDOM:function(b){zjs(b).hasClass("zhovercard")&&zjs(b).makeHovercard();zjs(b).hasClass("zhovercardcenter")&&
zjs(b).makeHovercard({horizontal:"center"});zjs(b).hasClass("zhovercardleft")&&zjs(b).makeHovercard({horizontal:"left"});zjs(b).hasClass("zhovercardright")&&zjs(b).makeHovercard({horizontal:"right"});zjs(b).find(".zhovercard").makeHovercard();zjs(b).find(".zhovercardcenter").makeHovercard({horizontal:"center"});zjs(b).find(".zhovercardleft").makeHovercard({horizontal:"left"});zjs(b).find(".zhovercardright").makeHovercard({horizontal:"right"})}});zjs.onready(function(){zjs(".zhovercard").makeHovercard();
zjs(".zhovercardcenter").makeHovercard({horizontal:"center"});zjs(".zhovercardleft").makeHovercard({horizontal:"left"});zjs(".zhovercardright").makeHovercard({horizontal:"right"})});"required"in zjs&&zjs.required("ui.hovercard")});