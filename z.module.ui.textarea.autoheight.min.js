(function(a){a.extendCore({moduleTextareaAutoheightOption:{minHeight:"auto",smooth:!0,smoothTime:200}});var g=!1,m=function(c,f){var b=a(c),d=b.getData("zmoduletextareaautoheightoption");if(!d){var d=a.clone(a.moduleTextareaAutoheightOption),h=b.getAttr("data-option","");a.isString(h)&&""!=h.trim()&&(d=a.extend(d,h.jsonDecode()));"undefined"!=typeof f&&(d=a.extend(d,f));b.setData("zmoduletextareaautoheightoption",d);var n=a.enablehook();a.enablehook(!1);g||(g=a('<div style="position:fixed;top:-5000px;left:-5000px;opacity:0;"></div>').appendTo(a(document.body)));
var k=a("<div></div>").appendTo(g),l=0,p=0;a.enablehook(n);var q=!1,r=function(){if(!q){var a=b.getStyle("box-sizing"),c=b.width(),e=b.getStyle("padding-left",1)+b.getStyle("padding-right",1),f=b.getStyle("border-left-width",1)+b.getStyle("border-right-width",1);"content-box"==a&&(c-=e+f,l=b.getStyle("padding-top",1)+b.getStyle("padding-bottom",1)+b.getStyle("border-top-width",1)+b.getStyle("border-bottom-width",1));p=-1==d.minHeight||"auto"==d.minHeight?b.height():d.minHeight;k.setStyle({width:c,
margin:b.getStyle("margin"),padding:b.getStyle("padding"),font:b.getStyle("font"),border:b.getStyle("border"),"box-sizing":a})}};b.setStyle({overflow:"hidden",resize:"none"});if(d.smooth)var m=a.timer({time:d.smoothTime,onProcess:function(a,d,c){b.height(a)}});var e=function(){var c=b.getValue();c||(c="");a.enablehook(!1);k.setInnerHTML(c.nl2br()+"<br>");a.enablehook(n);c=Math.max(p,k.height())-l;d.smooth?m.stop().set({from:b.height()-l,to:c}).run():b.height(c)};b.on("focus",function(a,b){r();q=!0;
e()}).on("keydown",function(a,b){e()}).on("keypress",function(a,b){e()}).on("keyup",function(a,b){e()}).on("changed",function(a,b){e()});r();e()}};a.extendMethod({makeTextareaAutoheight:function(a){return this.eachElement(function(c){m(c,a)})}});a.hook({after_setInnerHTML:function(c){a(c).find(".zautoheight").makeTextareaAutoheight()},after_insertDOM:function(c){a(c).hasClass("zautoheight")&&a(c).makeTextareaAutoheight();a(c).find(".zautoheight").makeTextareaAutoheight()}});a.onready(function(){a("textarea.zautoheight").makeTextareaAutoheight()});
"required"in a&&a.required("ui.textarea.autoheight")})(zjs);