zjs.require("scrollbar, ui, ui.button",function(){zjs.extendCore({moduleUiSelectboxOption:{width:"auto",customCssClass:"",panelmaxheight:250,itemtemplate:"${text}"}});var l=/^data\-(.+)$/,q=function(b,f){var d=zjs(b),c=d.getData("zmoduleuiselectboxoption");if(c)d.setData("zmoduleuiselectboxoption",zjs.extend(c,f));else{var c=zjs.clone(zjs.moduleUiSelectboxOption),a=d.getAttr("data-option","");zjs.isString(a)&&""!=a.trim()&&(c=zjs.extend(c,a.jsonDecode()));d.removeAttr("data-option");"undefined"!=
typeof f&&(c=zjs.extend(c,f));d.setData("zmoduleuiselectboxoption",c);a=zjs('<div class="zui-selectbox"><div class="zui-selectbox__button-wrap"><a class="zui-contextual-button zui-selectbox__button"></a></div><div class="zui-contextual-panel-wrap zui-selectbox__panel-wrap zui-initing"><div class="zui-selectbox__panel-inner"><div class="zui-selectbox__panel"></div></div></div></div>');"auto"==c.width&&a.width(d.width());""!=c.customCssClass&&a.addClass(c.customCssClass);d.setData("zmoduleuiselectboxwrapel",
a);a.insertAfter(d);var g=a.find(".zui-selectbox__panel-wrap"),h=a.find(".zui-selectbox__panel"),m=0,n=0;d.find("option,optgroup").eachElement(function(e){e=zjs(e);if(e.is("optgroup")){var b=zjs('<span class="zui-selectbox__item-header"></span>').appendTo(h);""!=e.getAttr("label","")?b.setInnerHTML(e.getAttr("label")):b.addClass("zui-selectbox__item-header-line")}else if(e.is("option")){m++;var b=zjs('<a class="zui-selectbox__item"></a>').appendTo(h),a=e.is("[value]")?e.getAttr("value",""):e.getInnerHTML();
b.setAttr("data-value",a);var d=e.getAttr("data-html","");if(""==d){var f={value:a,text:e.getInnerHTML()};zjs.foreach(e.item(0,!0).attributes,function(a){if(l.test(a.nodeName)){var b=a.nodeName.match(l)[1];f[b]=a.nodeValue}});a="";"function"==typeof c.itemtemplate&&(a=c.itemtemplate(f));"string"==typeof c.itemtemplate&&(a=c.itemtemplate);"string"==typeof a&&(a=a.format(f));d=a}b.setInnerHTML(d);e.is("[disabled]")?b.addClass("zui-disabled"):(n++,a=e.getAttr("data-href",""),""!=a&&b.setAttr("href",
a),e.is("[selected]")&&b.addClass("zui-selected"),e.setAttr("value",b.getAttr("data-value")),e=e.getAttr("data-class",""),""!=e&&b.addClass(e))}});a.addClass("total-item-"+m).addClass("total-active-item-"+n);h.height()>c.panelmaxheight&&h.makeScrollbar({height:c.panelmaxheight});g.addClass("zui-hide").removeClass("zui-initing");0==h.find(".zui-selectbox__item.zui-selected").count()&&h.find(".zui-selectbox__item:not(.zui-disabled)").item(0).addClass("zui-selected");h.on("click",".zui-selectbox__item",
function(a){a=zjs(this);a.hasClass("zui-disabled")||p(d,a.getAttr("data-value"),"click")});var k=a.find(".zui-selectbox__button");zjs.isFunction(k.makeButton)?(k.makeButton(),a=k.find(".zui-button-label")):a=k;a.setInnerHTML(h.find(".zui-selectbox__item.zui-selected").item(0).getInnerHTML());k.on("click",function(a){a.preventDefault();a.stop();a=k.hasClass("activenothover");zjs(".zui-contextual-button").removeClass("activenothover");zjs(".zui-contextual-panel-wrap").addClass("zui-hide");a||(k.addClass("activenothover"),
g.removeClass("zui-hide"))});d.addClass("zui-uihide");a=d.getAttr("onchange","");""!=a&&(a=new Function("event","return "+a+".call(this, event)"),d.on("ui:selectbox:change",a))}};zjs(document).on("click",function(){zjs(".zui-selectbox__button").removeClass("activenothover");zjs(".zui-selectbox__panel-wrap").addClass("zui-hide")});var p=function(b,f,d){b=zjs(b);var c=b.getData("zmoduleuiselectboxwrapel",!1);if(c){var a=c.find(".zui-selectbox__panel"),g=c.find(".zui-selectbox__button"),c=g.find(".zui-button-label");
c.count()||(c=g);g=a.find('.zui-selectbox__item[data-value="'+f+'"]').item(0);0>=g.count()||g.hasClass("zui-disabled")||(a.find(".zui-selectbox__item").removeClass("zui-selected"),g.addClass("zui-selected"),c.setInnerHTML(g.getInnerHTML()),b.find("option[selected]").selected(!1),b.find('option[value="'+f+'"]').selected(!0),"undefined"!=typeof d&&"click"==d&&b.trigger("ui:selectbox:clickchange",{value:f,text:g.getInnerHTML()}),b.trigger("ui:selectbox:change",{value:f,text:g.getInnerHTML()}))}},r=function(b){b=
zjs(b).getData("zmoduleuiselectboxwrapel",!1);if(!b)return[];var f=[];b.find(".zui-selectbox__item").eachElement(function(b){f.push(z(b).getAttr("data-value",""))});return f};zjs.extendMethod({makeSelectbox:function(b){return this.eachElement(function(f){q(f,b)})},selectboxSelectValue:function(b){return this.eachElement(function(f){p(f,b)})},selectboxGetAllValue:function(){return r(this.item(0,!0))}});zjs.hook({after_setInnerHTML:function(b){zjs(b).find(".zselectbox").makeSelectbox()},after_insertDOM:function(b){zjs(b).hasClass("zselectbox")&&
zjs(b).makeSelectbox();zjs(b).find(".zselectbox").makeSelectbox()}});zjs.onready(function(){zjs(".zselectbox").makeSelectbox()});"required"in zjs&&zjs.required("ui.selectbox")});