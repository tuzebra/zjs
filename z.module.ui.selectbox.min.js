zjs.require("scrollbar, ui, ui.button",function(){zjs.extendCore({moduleUiSelectboxOption:{panelmaxheight:250}});var m=function(b,f){var d=zjs(b),a=d.getData("zmoduleuiselectboxoption");if(a)d.setData("zmoduleuiselectboxoption",zjs.extend(a,f));else{var a=zjs.clone(zjs.moduleUiSelectboxOption),e=d.getAttr("data-option","");zjs.isString(e)&&""!=e.trim()&&(a=zjs.extend(a,e.jsonDecode()));d.removeAttr("data-option");"undefined"!=typeof f&&(a=zjs.extend(a,f));d.setData("zmoduleuiselectboxoption",a);e=
zjs('<div class="zui-selectbox"><div class="zui-selectbox-button-wrap"><a class="zui-contextual-button zui-selectbox-button"></a></div><div class="zui-contextual-panel-wrap zui-selectbox-panel-wrap zui-initing"><div class="zui-selectbox-panel-inner"><div class="zui-selectbox-panel"></div></div></div></div>');e.width(d.width());d.setData("zmoduleuiselectboxwrapel",e);e.insertAfter(d);var g=e.find(".zui-selectbox-panel-wrap"),h=e.find(".zui-selectbox-panel");d.find("option,optgroup").each(function(c){c=
zjs(c);if(c.is("optgroup")){var a=zjs('<span class="zui-selectbox-item-header"></span>').appendTo(h);""!=c.getAttr("label","")?a.html(c.getAttr("label")):a.addClass("zui-selectbox-item-header-line")}else if(c.is("option")){a=zjs('<a class="zui-selectbox-item"></a>').appendTo(h);a.setAttr("data-value",c.is("[value]")?c.getAttr("value",""):c.getInnerHTML());var b=c.getAttr("data-html","");""==b&&(b=c.getInnerHTML());a.html(b);c.is("[disabled]")?a.addClass("zui-disabled"):(b=c.getAttr("data-href",""),
""!=b&&a.setAttr("href",b),c.is("[selected]")&&a.addClass("zui-selected"),c.attr("value",a.attr("data-value")),c=c.getAttr("data-class",""),""!=c&&a.addClass(c))}});h.height()>a.panelmaxheight&&h.makeScrollbar({height:a.panelmaxheight});g.addClass("zui-hide").removeClass("zui-initing");0==h.find(".zui-selectbox-item.zui-selected").count()&&h.find(".zui-selectbox-item:not(.zui-disabled)").item(0).addClass("zui-selected");h.on("click",".zui-selectbox-item",function(a,b){this.hasClass("zui-disabled")||
l(d,this.attr("data-value"),"click")});e.style("position","initial");g.width(e.width());var k=e.find(".zui-selectbox-button");k.makeButton();k.find(".zui-button-label").html(h.find(".zui-selectbox-item.zui-selected").item(0).getInnerHTML());k.click(function(a,b){a.preventDefault();a.stop();var d=k.hasClass("activenothover");zjs(".zui-contextual-button").removeClass("activenothover");zjs(".zui-contextual-panel-wrap").addClass("zui-hide");d||(k.addClass("activenothover"),g.removeClass("zui-hide"))});
d.addClass("zui-uihide");a=d.getAttr("onchange","");""!=a&&(a=new Function("event","return "+a+".call(this, event)"),d.on("ui.selectbox.change",a))}};zjs(document).click(function(){zjs(".zui-selectbox-button").removeClass("activenothover");zjs(".zui-selectbox-panel-wrap").addClass("zui-hide")});var l=function(b,f,d){b=zjs(b);var a=b.getData("zmoduleuiselectboxwrapel",!1);if(a){var e=a.find(".zui-selectbox-panel"),a=a.find(".zui-selectbox-button"),g=e.find('.zui-selectbox-item[data-value="'+f+'"]').item(0);
0>=g.count()||g.hasClass("zui-disabled")||(e.find(".zui-selectbox-item").removeClass("zui-selected"),g.addClass("zui-selected"),a.find(".zui-button-label").html(g.getInnerHTML()),b.find("option[selected]").selected(!1),b.find('option[value="'+f+'"]').selected(!0),"undefined"!=typeof d&&"click"==d&&b.trigger("ui.selectbox.clickchange",{value:f,text:g.getInnerHTML()}),b.trigger("ui.selectbox.change",{value:f,text:g.getInnerHTML()}))}};zjs.extendMethod({makeSelectbox:function(b){return this.each(function(f){m(f,
b)})},selectboxSelectValue:function(b){return this.each(function(f){l(f,b)})}});zjs.hook({after_setInnerHTML:function(b){zjs(b).find(".zselectbox").makeSelectbox()},after_insertDOM:function(b){zjs(b).hasClass("zselectbox")&&zjs(b).makeSelectbox();zjs(b).find(".zselectbox").makeSelectbox()}});zjs.onready(function(){zjs(".zselectbox").makeSelectbox()});"required"in zjs&&zjs.required("ui.selectbox")});