zjs.require("scrollbar, ui, ui.button",function(){zjs.extendCore({moduleUiSelectboxOption:{panelmaxheight:250,itemtemplate:"${text}"}});var m=function(b,g){var c=zjs(b),d=c.getData("zmoduleuiselectboxoption");if(d)c.setData("zmoduleuiselectboxoption",zjs.extend(d,g));else{var d=zjs.clone(zjs.moduleUiSelectboxOption),a=c.getAttr("data-option","");zjs.isString(a)&&""!=a.trim()&&(d=zjs.extend(d,a.jsonDecode()));c.removeAttr("data-option");"undefined"!=typeof g&&(d=zjs.extend(d,g));c.setData("zmoduleuiselectboxoption",
d);a=zjs('<div class="zui-selectbox"><div class="zui-selectbox-button-wrap"><a class="zui-contextual-button zui-selectbox-button"></a></div><div class="zui-contextual-panel-wrap zui-selectbox-panel-wrap zui-initing"><div class="zui-selectbox-panel-inner"><div class="zui-selectbox-panel"></div></div></div></div>');a.width(c.width());c.setData("zmoduleuiselectboxwrapel",a);a.insertAfter(c);var f=a.find(".zui-selectbox-panel-wrap"),h=a.find(".zui-selectbox-panel");c.find("option,optgroup").eachElement(function(e){e=
zjs(e);if(e.is("optgroup")){var a=zjs('<span class="zui-selectbox-item-header"></span>').appendTo(h);""!=e.getAttr("label","")?a.setInnerHTML(e.getAttr("label")):a.addClass("zui-selectbox-item-header-line")}else if(e.is("option")){var a=zjs('<a class="zui-selectbox-item"></a>').appendTo(h),b=e.is("[value]")?e.getAttr("value",""):e.getInnerHTML();a.setAttr("data-value",b);var c=e.getAttr("data-html","");""==c&&(b={value:b,text:e.getInnerHTML()},c="","function"==typeof d.itemtemplate&&(c=d.itemtemplate(b)),
"string"==typeof d.itemtemplate&&(c=d.itemtemplate),"string"==typeof c&&(c=c.format(b)));a.setInnerHTML(c);e.is("[disabled]")?a.addClass("zui-disabled"):(b=e.getAttr("data-href",""),""!=b&&a.setAttr("href",b),e.is("[selected]")&&a.addClass("zui-selected"),e.setAttr("value",a.getAttr("data-value")),e=e.getAttr("data-class",""),""!=e&&a.addClass(e))}});h.height()>d.panelmaxheight&&h.makeScrollbar({height:d.panelmaxheight});f.addClass("zui-hide").removeClass("zui-initing");0==h.find(".zui-selectbox-item.zui-selected").count()&&
h.find(".zui-selectbox-item:not(.zui-disabled)").item(0).addClass("zui-selected");h.on("click",".zui-selectbox-item",function(a){a=zjs(this);a.hasClass("zui-disabled")||l(c,a.getAttr("data-value"),"click")});a.setStyle("position","initial");f.width(a.width());var k=a.find(".zui-selectbox-button");zjs.isFunction(k.makeButton)?(k.makeButton(),a=k.find(".zui-button-label")):a=k;a.setInnerHTML(h.find(".zui-selectbox-item.zui-selected").item(0).getInnerHTML());k.on("click",function(a){a.preventDefault();
a.stop();a=k.hasClass("activenothover");zjs(".zui-contextual-button").removeClass("activenothover");zjs(".zui-contextual-panel-wrap").addClass("zui-hide");a||(k.addClass("activenothover"),f.removeClass("zui-hide"))});c.addClass("zui-uihide");a=c.getAttr("onchange","");""!=a&&(a=new Function("event","return "+a+".call(this, event)"),c.on("ui:selectbox:change",a))}};zjs(document).on("click",function(){zjs(".zui-selectbox-button").removeClass("activenothover");zjs(".zui-selectbox-panel-wrap").addClass("zui-hide")});
var l=function(b,g,c){b=zjs(b);var d=b.getData("zmoduleuiselectboxwrapel",!1);if(d){var a=d.find(".zui-selectbox-panel"),f=d.find(".zui-selectbox-button"),d=f.find(".zui-button-label");d.count()||(d=f);f=a.find('.zui-selectbox-item[data-value="'+g+'"]').item(0);0>=f.count()||f.hasClass("zui-disabled")||(a.find(".zui-selectbox-item").removeClass("zui-selected"),f.addClass("zui-selected"),d.setInnerHTML(f.getInnerHTML()),b.find("option[selected]").selected(!1),b.find('option[value="'+g+'"]').selected(!0),
"undefined"!=typeof c&&"click"==c&&b.trigger("ui:selectbox:clickchange",{value:g,text:f.getInnerHTML()}),b.trigger("ui:selectbox:change",{value:g,text:f.getInnerHTML()}))}};zjs.extendMethod({makeSelectbox:function(b){return this.eachElement(function(g){m(g,b)})},selectboxSelectValue:function(b){return this.eachElement(function(g){l(g,b)})}});zjs.hook({after_setInnerHTML:function(b){zjs(b).find(".zselectbox").makeSelectbox()},after_insertDOM:function(b){zjs(b).hasClass("zselectbox")&&zjs(b).makeSelectbox();
zjs(b).find(".zselectbox").makeSelectbox()}});zjs.onready(function(){zjs(".zselectbox").makeSelectbox()});"required"in zjs&&zjs.required("ui.selectbox")});