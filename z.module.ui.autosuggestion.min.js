zjs.require("dictionary, scrollbar",function(){"use strict";var e="zjsmoduleautosuggestionoption",t="zmoduleautosuggestionwrapel",s="zmoduleautosuggestionwrapinputel",i="zjsmoduleautosuggestionnewinput",a="zjsmoduleautosuggestiondictionary",o="zjsmoduleautosuggestionfuncturnonoffkey",n="zjsmoduleautosuggestionfuncsetvaluekey",u="zjsmoduleautosuggestionisstillloadingkey";zjs.extendCore({moduleUiAutosuggestionOption:{minlength:1,minheight:18,customcss:!0,labelPlaceholder:!1,focusshowsuggestion:null,showSuggestionIfNoResult:null,autofocus:!1,panelmaxheight:200,multiline:!0,multichoice:!1,forceSelectFromList:!1,create:!1,delimiter:",",mentionmode:!1,usedproperty:"text",searchproperty:"text",usedSearchRegExp:null,searchMatchStartWith:!1,usedpropertytext:!1,limit:0,noneValue:"",source:[],sourceUrl:"",initSourceUrl:"",sourceUrlValueSelector:function(e){return e},sourceDataStructure:"",sourceDataSelector:function(e,t){return e},cacheResponse:!0,useSuggestedValueWhenEnter:!0,generateAdditionalItems:null,itemtemplate:'<div class="item">${text}</div>',itemLinkFormat:"",itemhighlightclass:"highlight",defaultPanelHeight:0,selectLikeInput:!1,defaultSuggestionMoreText:"",suggestIconRightChoose:' <code class="icon-right"><b>&rarr;</b></code> press Right to choose',suggestIconEnterChoose:' <code class="icon-enter"><b>&crarr;</b></code> press Enter to choose',suggestIconEnterCreate:' <code class="icon-enter"><b>&crarr;</b></code> press Enter to add this keyword',panelScrollline:160}});var r="zui-autosuggestion-wrap",l="focus",g="zui-autosuggestion-multi-wrap",c="zui-autosuggestion-with-token",d='<div class="'+r+'"><div class="zui-autosuggestion-inputwrap"><div class="zui-autosuggestion-placeholder"></div><input class="zui-autosuggestion-input" autocomplete="off" /><textarea class="zui-autosuggestion-input" autocomplete="off"></textarea><div class="zui-autosuggestion-input-test-wrap"><div class="zui-autosuggestion-input-test"></div></div><div class="zui-estimate-height-wrap"><div class="zui-autosuggestion-input zui-estimate-height"></div></div></div><div class="zui-autosuggestion-panel-wrap zui-panel-hide"><div class="zui-autosuggestion-panel-scroll"><div class="zui-autosuggestion-panel-content"></div></div></div></div>',h="zui-autosuggestion-item",p='<div class="'+h+'"></div>',f='<a class="'+h+'"></a>',m="oninput"in document.createElement("input"),v=function(r,p){var f=zjs(r),v=f.getData(e),y=!1;if(v)return f.setData(e,zjs.extend(v,p)),void(y=!0);var S=function(){y&&(v=f.getData(e),y=!1)},j=!0,x=!1,C=!1;v=zjs.clone(zjs.moduleUiAutosuggestionOption);var w=f.getAttr("data-option","");if(zjs.isString(w)&&""!=w.trim()&&(v=zjs.extend(v,w.jsonDecode())),f.removeAttr("data-option"),!v.sourceUrl){var V=f.getAttr("data-autocomplete-path","");""!==V&&(v.sourceUrl=V)}zjs.hook({after_setAttr:function(e,t,s){if(e===r&&"data-autocomplete-path"===t){var i=f.getAttr("data-autocomplete-path","");""==i?j=!1:(j=!0,v.sourceUrl=i,X.setDataSourceUrl(v.sourceUrl))}}}),void 0!==p&&(v=zjs.extend(v,p));var I=f.getValue(""),b=!1;(zjs.isString(v.source)||f.is("select"))&&(b=zjs.isString(v.source)?zjs(v.source):f,b.count()>0?(x=f.is("select"),x&&(C=!0),v.multichoice=!1,v.usedproperty="id.text",v.source={},b.find("option").eachElement(function(e,t){var s=zjs(e).getValue(),i=zjs(e).getInnerText();s!==v.noneValue&&(v.source[s]=i,s==v.noneValue&&(s,i),0===t&&(s,s!=v.noneValue&&f.setValue(s,!0)),e.selected&&s!=v.noneValue&&(I=i,x?b.setValue(s,!0):f.setValue(i,!0)))}),b.hide(),x?v.selectLikeInput&&b.addClass("select-like-input"):b.removeAttr("required").removeClass("required")):b=!1),C||v.forceSelectFromList&&"id.text"===v.usedproperty&&(C=!0),null!==v.focusshowsuggestion||!x&&!C||v.selectLikeInput||(v.focusshowsuggestion=!0);var E=v.searchproperty;if("id.text"==v.usedproperty&&(v.searchproperty="text",v.usedproperty="id",E="id.text"),v.mentionmode&&(v.multichoice=!1),v.multichoice&&(v.multiline=!1),v.limit=parseInt(v.limit),isNaN(v.limit)&&(v.limit=0),v.defaultPanelHeight=parseInt(v.defaultPanelHeight),isNaN(v.defaultPanelHeight)&&(v.defaultPanelHeight=0),v.usedSearchRegExp&&zjs.isObject(v.usedSearchRegExp)){var k={used:/^(.+\(\d{1,}\))$/,search:/^(.+)\s\(\d{1,}\)$/};v.usedSearchRegExp.used&&(zjs.isString(v.usedSearchRegExp.used)&&(v.usedSearchRegExp.used=new RegExp(v.usedSearchRegExp.used)),zjs.isRegExp(v.usedSearchRegExp.used)&&(k.used=v.usedSearchRegExp.used)),v.usedSearchRegExp.search&&(zjs.isString(v.usedSearchRegExp.search)&&(v.usedSearchRegExp.search=new RegExp(v.usedSearchRegExp.search)),zjs.isRegExp(v.usedSearchRegExp.search)&&(k.search=v.usedSearchRegExp.search)),v.usedSearchRegExp=k}f.setData(e,v);var R=zjs(d);v.multiline?R.find("input.zui-autosuggestion-input").remove():R.find("textarea.zui-autosuggestion-input").remove(),f.setData(t,R),R.insertAfter(f);var A=R.find(".zui-autosuggestion-inputwrap"),L=R.find(".zui-autosuggestion-placeholder"),T=R.find("input.zui-autosuggestion-input,textarea.zui-autosuggestion-input"),M=R.find(".zui-autosuggestion-panel-wrap"),U=R.find(".zui-autosuggestion-panel-scroll"),H=R.find(".zui-autosuggestion-panel-content"),F=!1;if(T.findUp("form").setAttr("autocomplete","off"),f.setData(s,A),f.setData(i,T.item(0,!0)),v.multiline?(F=R.find(".zui-estimate-height"),R.addClass("multiline")):R.find(".zui-estimate-height-wrap").remove(),v.suggestIconRightChoose&&L.setData("suggestIconRightChoose",v.suggestIconRightChoose),v.suggestIconEnterChoose&&L.setData("suggestIconEnterChoose",v.suggestIconEnterChoose),v.suggestIconEnterCreate&&L.setData("suggestIconEnterCreate",v.suggestIconEnterCreate),!v.customcss){var _={width:f.width(),height:f.height(),marginLeft:f.getStyle("margin-left",!0),marginRight:f.getStyle("margin-right",!0),marginTop:f.getStyle("margin-top",!0),marginBottom:f.getStyle("margin-bottom",!0),paddingLeft:f.getStyle("padding-left",!0),paddingRight:f.getStyle("padding-right",!0),paddingTop:f.getStyle("padding-top",!0),paddingBottom:f.getStyle("padding-bottom",!0),borderLeft:f.getStyle("border-left-width",!0),borderRight:f.getStyle("border-right-width",!0),borderTop:f.getStyle("border-top-width",!0),borderBottom:f.getStyle("border-bottom",!0),font:f.getStyle("font"),boxSizing:f.getStyle("box-sizing")};"content-box"==_.boxSizing&&(_.width-=_.paddingLeft+_.paddingRight+_.borderLeft+_.borderRight,_.height-=_.paddingTop+_.paddingBottom+_.borderTop+_.borderBottom),A.copyStyleFrom(f),A.setStyle({position:"relative",cursor:"text",width:_.width,height:_.height,"-webkit-text-fill-color":"initial"}),T.setStyle({top:L.top(),font:_.font,width:_.width})}var B=!1;v.multichoice?(R.addClass(g),B=R.find(".zui-autosuggestion-input-test").setStyle({margin:T.getStyle("margin"),padding:T.getStyle("padding"),font:T.getStyle("font"),border:T.getStyle("border")})):R.find(".zui-autosuggestion-input-test-wrap").remove(),M.height(v.panelmaxheight),U.makeScrollbar({bounce:!1,usecss:!1,usekey:!1,customCssClass:"zui-autosuggestion-panel",autoUseDefaultWithMobile:!0,scrollline:v.panelScrollline}),M.addClass("zui-panel-hide");var P=function(e){var t=Math.min(e,v.panelmaxheight);M.height(t),U.scrollHeight(t).refreshScroll().scrollToTop(),M.find(".zui-scrollbar").top(0)},O="",N=function(){return f.getAttr("data-placeholder",f.getAttr("placeholder",""))},W=0,q=0,$="",K="",G=0,J="",Q=N();v.labelPlaceholder&&""!==Q&&(zjs("<span>").addClass("placeholder").html(Q).insertAfter(A),A.addClass("label-placeholder")),D(L,N()),f.hide(),""!==I&&(T.setValue($=I,!0),D(L,""),R.addClass("has-value"));var X=new zjs.dictionary(v.source,E);X.setOnStartEndLoading(function(){f.setData(u,!0),f.trigger("ui:autosuggestion:startasyncsearch")},function(){f.setData(u,!1),f.trigger("ui:autosuggestion:endasyncsearch")}),v.cacheResponse||X.setCacheResponse(!1),"function"==typeof v.sourceUrlValueSelector&&X.setDataSourceUrlValueSelector(v.sourceUrlValueSelector),""!=v.sourceUrl&&X.setDataSourceUrl(v.sourceUrl),""!=v.initSourceUrl&&(X.setDataSourceUrl(v.initSourceUrl),""===v.sourceUrl&&X.useCacheDataSource(!0),X.getDataFromDataSource()),""!=v.sourceDataStructure&&X.setDataSourceDataStructure(v.sourceDataStructure),"function"==typeof v.sourceDataSelector&&X.setDataSourceDataSelector(v.sourceDataSelector),v.limit>0&&X.setDefaultSearchResultLimit(v.limit),v.searchMatchStartWith&&X.setSearchMatchStartWith(!0),f.setData(a,X);var Y=function(e){var t=null,s=null,i=e.match(v.usedSearchRegExp.used);return i&&i.length>=2&&i[1]&&(t=i[1]),i=e.match(v.usedSearchRegExp.search),i&&i.length>=2&&i[1]&&(s=i[1]),!(!t||!s)&&{used:t,search:s}},Z=!0,ee=function(){var e=null;(x||C)&&(""===f.getValue()?($="",D(L,""),T.setValue("",!0),R.removeClass("has-value")):R.addClass("has-value"),e={id:f.getValue(),text:null}),M.addClass("zui-panel-hide"),f.trigger("ui:autosuggestion:blur"),e&&f.trigger("ui:autosuggestion:change",e)},te=function(e,t){S();var s=e.getKeyCode();if(38!=s&&40!=s)if(37!=s){if(39==s||9==s)return e.stopPropagation(),"keydown"==t&&ie(),void(9==s&&(M.addClass("zui-panel-hide"),ee()));if(13!=s){if(27==s)return v.multichoice,void ae();8!=s?(m&&"input"==t?ue(!0):"keyup"==t&&ue(!0),f.trigger("input")):ne()}else if(v.multichoice)""!=T.getValue("")&&("keydown"==t&&oe(),e.preventDefault());else{var i=M.hasClass("zui-panel-hide");"keydown"==t&&oe(),v.multiline&&(e.preventDefault(),he(),i&&function(){f.findUp("form").submit()}.delay(1))}}else e.stopPropagation();else"keydown"==t&&se(e,s)},se=function(e,t){if(e.preventDefault(),e.stopPropagation(),Z){H.find("."+h).removeClass(v.itemhighlightclass),40==t&&W++,38==t&&W--,W>q&&(W=0),W<0&&(W=q);var s="";if(0===W)s=$,D(L,K,$);else{var i=H.find("."+h+'[data-highlight="'+W+'"]'),a=i.getData("searchtempdata");i.addClass(v.itemhighlightclass),s=a[v.searchproperty],D(L,"")}T.setValue(s,!0),v.multichoice&&(T.width(B.setInnerHTML(T.getValue("")).width()+10),M.top(A.height())),a&&v.usedproperty in a?f.setValue(a[v.usedproperty],!0):("text"==v.usedproperty||v.usedpropertytext)&&f.setValue($,!0),v.multiline&&he(),U.scrollToElement(i),"object"==typeof a&&(f.trigger("ui:autosuggestion:highlight",a),""!=v.itemLinkFormat&&(O=i.getAttr("href")))}},ie=function(){if(!Z)return;if(""==K)return;if(T.setValue($=K,!0),D(L,K=""),W<=0&&(W=G),M.addClass("zui-panel-hide"),W<=0)return;var e=H.find("."+h+'[data-highlight="'+W+'"]').getData("searchtempdata");if("object"!=typeof e)return;v.multichoice?(T.setValue("",!0).width(10),e&&v.usedproperty in e&&(zjs('<div class="zui-autosuggestion-token"></div>').setInnerHTML(e[v.searchproperty]).setAttr("data-value",e[v.usedproperty]).insertBefore(T),R.addClass(c),de())):(v.multiline&&he(),e&&v.usedproperty in e&&(J=e[v.usedproperty],$=e[v.searchproperty],T.setValue($,!0),f.setValue(J,!0))),b&&b.setValue(e.id,!0);const t=Object.assign({},{_byRightKey:!0},e);f.trigger("ui:autosuggestion:choice",t),f.trigger("ui:autosuggestion:change",t)},ae=function(){Z&&(M.hasClass("zui-panel-hide")||T.setValue($,!0),"text"===v.usedproperty||v.usedpropertytext?(f.setValue($,!0),D(L,""===$?N():K="")):f.setValue("",!0),M.addClass("zui-panel-hide"),H.find("."+h).removeClass("highlight"),W=0,G=0,""!==$&&v.create&&v.suggestIconEnterCreate&&D(L,$,$,!0),v.multiline&&he())},oe=function(){if($=T.getValue(""),!Z)return;var e={text:$},t=null;if((G||W||!M.hasClass("zui-panel-hide")||v.create)&&""!=$){if(W>0)t=H.find("."+h+'[data-highlight="'+W+'"]');else if(G>0&&v.useSuggestedValueWhenEnter)t=H.find("."+h+'[data-highlight="'+G+'"]');else if("id"==v.usedproperty){var s=H.find("."+h);s.count()>0&&(t=s.item(0))}else v.create&&(X.addIndex({[v.usedproperty]:$,[v.searchproperty]:$},v.searchproperty),e={text:$,[v.usedproperty]:$,[v.searchproperty]:$});t&&(e=t.getData("searchtempdata"))}if(""!=$&&D(L,K=""),M.addClass("zui-panel-hide"),"object"!=typeof e)return;v.multichoice?(T.setValue("",!0).width(10),$="",e&&v.usedproperty in e&&(zjs('<div class="zui-autosuggestion-token"></div>').setInnerHTML(e.text).setAttr("data-value",e[v.usedproperty]).insertBefore(T),R.addClass(c)),de()):e&&(D(L,K=""),M.addClass("zui-panel-hide"),v.searchproperty in e&&T.setValue($=e[v.searchproperty],!0),v.usedproperty in e&&f.setValue(e[v.usedproperty],!0)),b&&b.setValue(e.id,!0);const i=Object.assign({},{_byEnter:!0,_element:t.item(0,1)},e);if(f.trigger("ui:autosuggestion:choice",i),f.trigger("ui:autosuggestion:change",i),""!=v.itemLinkFormat&&t){var a=t.getAttr("href");a==O&&(window.location.href=a)}},ne=function(){v.multichoice&&Z&&""==T.getValue("")&&(R.find(".zui-autosuggestion-token").lastChild().remove(),de(),""==f.getValue()&&(R.removeClass(c),K="",function(){L.top(T.top()).left(T.left()).show(),D(L,N())}.delay(80)))},ue=function(e){var t=T.getValue("");if($=t,""!==t?R.addClass("has-value"):R.removeClass("has-value"),Z){if(D(L,""),v.multichoice){if(T.width(B.setInnerHTML(t).width()+10),""==t)return""==f.getValue()?D(L.show(),N()):L.hide(),K="",D(L,N()),void M.addClass("zui-panel-hide");L.top(T.top()).left(T.left()).show()}else{if(v.multiline&&he(),"text"==v.usedproperty||v.usedpropertytext?f.setValue(t,!0):f.setValue("",!0),""==t&&(x||C))return void me();if(""==t||e&&t.length<v.minlength)return K="",""!=t?D(L,"",t):D(L,N()),void M.addClass("zui-panel-hide")}if(e&&j){W=0,K="",G=0;var s=t;f.trigger("ui:autosuggestion:beforesearch",{value:s}),f.getData(a).asyncSearch(s,function(e,i){if(T.is(":focus"))if(f.trigger("ui:autosuggestion:searchresult",{value:s,result:e,focused:!0}),zjs.isFunction(v.generateAdditionalItems)&&(e=v.generateAdditionalItems(t,e,i,f.getData(u))),$=T.getValue(),0!==e.length&&""!==$||M.addClass("zui-panel-hide"),""!==$){if(0===e.length)return v.showSuggestionIfNoResult&&me(),void($===s&&v.create&&v.suggestIconEnterCreate&&D(L,$,$,!0));q=e.length,M.removeClass("zui-panel-hide").top(A.height()),H.setInnerHTML("");var a=0;zjs.eachItem(e,function(e,s){var i=z(v,H,e,s);if(a+=i.height(),i.hover(re),i.on("mousedown",ge,{passive:!0}),""==K){var o=e[v.searchproperty].toLowerCase(),n=t.toLowerCase();0===o.indexOf(n)&&(K=t+e[v.searchproperty].substr(t.length),G=s+1)}}),D(L,K,t),P(a)}else D(L,N());else f.trigger("ui:autosuggestion:searchresult",{value:s,result:e,focused:!1})})}}else f.setValue(t,!0)},re=function(e){H.find("."+h).removeClass(v.itemhighlightclass);var t=zjs(this).addClass(v.itemhighlightclass).getData("searchtempdata");"object"==typeof t&&f.trigger("ui:autosuggestion:highlight",t)},le=function(e,t){if(t=t||!1,"object"==typeof e&&($=e.text,T.setValue($,!0),R.addClass("has-value"),v.multichoice?(T.setValue("",!0).width(10),e&&v.usedproperty in e&&(zjs('<div class="zui-autosuggestion-token"></div>').setInnerHTML(e.text).setAttr("data-value",e[v.usedproperty]).insertBefore(T),R.addClass(c),de())):(e&&v.usedproperty in e&&f.setValue(e[v.usedproperty],!0),v.multiline&&he()),b&&b.setValue(e.id,!0),W=t?t.getAttr("data-highlight",0).toInt():0,D(L,K=""),M.addClass("zui-panel-hide"),t)){T.focus();const t=Object.assign({},{_byClick:!0},e);f.trigger("ui:autosuggestion:choice",t),f.trigger("ui:autosuggestion:change",t)}},ge=function(e){var t=zjs(this),s=t.getData("searchtempdata");if(le(Object.assign({},{_byClick:!0,_element:t.item(0,1)},s),t),""!=v.itemLinkFormat&&t){var i=t.getAttr("href");i&&(window.location.href=i)}},ce=function(e){e=e||!1,Z=e,Z||D(L,"")};f.setData(o,ce);var de=function(){var e=[];R.find(".zui-autosuggestion-token").eachElement(function(t){e.push(zjs(t).getAttr("data-value",""))}),f.setValue(e.join(v.delimiter),!0)},he=function(){F.setInnerHTML(T.getValue());var e=Math.max(F.height(),v.minheight);T.height(e),M.hasClass("zui-panel-hide")||M.top(A.height())};v.multiline&&(zjs(window).on("resize",he),he.delay(1)),m?T.on("keydown",function(e,t){te(e,"keydown")}).on("input",function(e,t){te(e,"input")}):T.on("keydown",function(e,t){te(e,"keydown")}).on("keypress",function(e,t){te(e,"keypress")}).on("keyup",function(e,t){te(e,"keyup")}).on("mouseup",function(e,t){te(e,"keyup")}),T.on("blur",function(e){ee.delay(100)}),A.on("click",function(){T.focus()});var pe=function(e="",t){if(f.setValue(e,!0),x||C){var s=X.getItemById(e);s?le(s,!1):T.setValue("",!0)}else T.setValue(e,!0),ue(t)};f.setData(n,pe);var fe=!1;f.on("focus",function(){fe||T.focus()}),T.on("focus",function(){R.addClass(l),fe=!0,f.trigger("focus"),fe=!1}).on("blur",function(){R.removeClass(l),b&&""===T.getValue().trim()&&b.setValue(v.noneValue,!0),f.trigger("blur")}).on("keyup",function(){f.trigger("keyup")}),v.autofocus&&T.focus();var me=function(){var e=f.getData(a).getItemsLimit();if(0!=e.length){q=e.length,M.removeClass("zui-panel-hide").top(A.height()),H.setInnerHTML("");var t=0;zjs.eachItem(e,function(e,s){var i=z(v,H,e,s);t+=i.height(),i.hover(re),i.on("mousedown",ge,{passive:!0})}),""!==v.defaultSuggestionMoreText&&(t+=zjs("<div>").addClass(h).addClass("more-text").html(v.defaultSuggestionMoreText).appendTo(H).height()),P(v.defaultPanelHeight>0?v.defaultPanelHeight:t)}};if(v.focusshowsuggestion&&T.on("focus",function(e){if(x||C||""==$){if(e&&e.getTarget){var t=e.getTarget();if(t){if(zjs(t).hasClass("zui-autosuggestion-token"))return;if(zjs(t).hasClass(h))return}}v.defaultPanelHeight>0?me():function(){me()}.delay(100)}}),zjs(document).on("click",function(e){var t=zjs(e.target()),s=t.findUp(".zui-autosuggestion-wrap");if(s.count()>0){var i=s.find(".zui-autosuggestion-panel-wrap");if(i.count()>0&&i.item(0,!0)===M.item(0,!0))return}(function(){M.addClass("zui-panel-hide")}).delay(1)}),v.multichoice&&A.on("click",".zui-autosuggestion-token",function(e){this.remove(),de(),""==f.getValue()&&(R.removeClass(c),""==$&&(K="",D(L,N()))),function(){L.show().top(T.top()).left(T.left())}.delay(50)}),v.multichoice&&""!=$){var ve=!0;v.usedSearchRegExp?(zjs.eachItem($.split(new RegExp("\\s*"+v.delimiter+"\\s*")),function(e){var t=Y(e.trim());t&&(X.addIndex({[v.usedproperty]:t.used,[v.searchproperty]:t.search},v.searchproperty),zjs('<div class="zui-autosuggestion-token"></div>').setInnerHTML(t.search).setAttr("data-value",t.used).insertBefore(T))}),de()):"id"==v.usedproperty?zjs.eachItem($.split(new RegExp("\\s*"+v.delimiter+"\\s*")),function(e){X.asyncGetItemById(e,function(e){e&&(zjs('<div class="zui-autosuggestion-token"></div>').setInnerHTML(e.text).setAttr("data-value",e[v.usedproperty]).insertBefore(T),de())})}):"text"==v.usedproperty?zjs.eachItem($.split(new RegExp("\\s*"+v.delimiter+"\\s*")),function(e){X.asyncSearch(e,function(e){if(!(e.length<=0)){var t=e[0];zjs('<div class="zui-autosuggestion-token"></div>').setInnerHTML(t.text).setAttr("data-value",t[v.usedproperty]).insertBefore(T),de()}})}):ve=!1,ve&&(R.addClass(c),T.setValue($="",!0),L.hide())}if(!v.multichoice&&""!=$&&v.usedSearchRegExp){var ze=Y($.trim());ze&&(X.addIndex({[v.usedproperty]:ze.used,[v.searchproperty]:ze.search},v.searchproperty),f.setValue(ze.used,!0),T.setValue($=ze.search,!0))}f.setData("setValueCustomMethod","autosuggestionSetValue")},z=function(e,t,s,i){var a;if(""!=e.itemLinkFormat){var o=zjs.isFunction(e.itemLinkFormat)?e.itemLinkFormat(s,i):e.itemLinkFormat;a=zjs(f).setAttr("href",o.format(s))}else a=zjs(p);a.appendTo(t),a.setData("searchtempdata",s),a.setAttr("data-highlight",i+1);var n="";"function"==typeof e.itemtemplate&&(n=e.itemtemplate(s,i)),"string"==typeof e.itemtemplate&&(n=e.itemtemplate),"string"==typeof n&&(n=n.format(s));zjs(n).appendTo(a);return a},y=function(e){return!!zjs(e).getData(a)},S=function(t,s){var i=zjs(t),o=i.getData(a),n=i.getData(e);o&&o.addIndex(s,n.searchproperty)},j=function(e,t,s){var i=zjs(e),o=i.getData(a);o&&o.removeIndex(t,s)},x=function(e){var t=zjs(e),s=t.getData(a);s&&s.resetIndex()},C=function(e){var t=zjs(e),i=t.getData(s);i?i.trigger("click"):t.focus()},w=function(e,t){var s=zjs(e),i=s.getData(o,!1);i&&i(t)},D=function(e,t,s,i){t=t||"",s=s||"",i=i||!1;var a=t;s&&t&&(a='<span class="_hide">'+t.substr(0,s.length)+"</span>"+t.substr(s.length),t.length>s.length&&e.getData("suggestIconRightChoose")?a+='<i class="_suggest-msg _right-choose">'+e.getData("suggestIconRightChoose")+"</i>":i&&t.length===s.length&&e.getData("suggestIconEnterCreate")?a+='<i class="_suggest-msg _enter-create">'+e.getData("suggestIconEnterCreate")+"</i>":!i&&t.length===s.length&&e.getData("suggestIconEnterChoose")&&(a+='<i class="_suggest-msg _enter-choose">'+e.getData("suggestIconEnterChoose")+"</i>")),e.setInnerHTML(a)};zjs.extendMethod({isAutosuggestion:function(){return y(this.item(0,1))},makeAutosuggestion:function(e){return this.eachElement(function(t){v(t,e)})},autosuggestionAddindex:function(e){return this.eachElement(function(t){S(t,e)})},autosuggestionRemoveindex:function(e,t){return this.eachElement(function(s){j(s,e,t)})},autosuggestionResetIndex:function(){return this.eachElement(function(e){x(e)})},autosuggestionFocus:function(){return this.eachElement(function(e){C(e)})},autosuggestionTurnOff:function(){return this.eachElement(function(e){w(e,!1)})},autosuggestionTurnOn:function(){return this.eachElement(function(e){w(e,!0)})},autosuggestionSetValue:function(e,t){return e=e||"",t=t||!1,this.eachElement(function(s){var i=zjs(s).getData(n);if(i)try{i(e,t)}catch(e){}else zjs(s).setValue(e,!0)})},autosuggestionDisable:function(e){return e=e||!1,this.eachElement(function(s){var a=zjs(s).getData(i),o=zjs(s).getData(t);if(a)try{a.disabled=e,e?o.addClass("disabled"):o.removeClass("disabled")}catch(e){}})},autosuggestionSetItemFilter:function(e){return this.eachElement(function(t){var s=zjs(t).getData(a);s&&s.setItemFilterFunction(e)})}}),zjs.hook({after_setInnerHTML:function(e){zjs(e).find(".zautosuggestion").makeAutosuggestion()},after_insertDOM:function(e){zjs(e).is(".zautosuggestion")&&zjs(e).makeAutosuggestion(),zjs(e).find(".zautosuggestion").makeAutosuggestion()}}),zjs(function(){zjs(".zautosuggestion").makeAutosuggestion()}),"required"in zjs&&zjs.required("ui.autosuggestion")});