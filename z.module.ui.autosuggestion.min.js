zjs.require("dictionary, scrollbar",function(){"use strict";var e="zjsmoduleautosuggestionoption",t="zmoduleautosuggestionwrapel",s="zmoduleautosuggestionwrapinputel",a="zjsmoduleautosuggestionnewinput",i="zjsmoduleautosuggestiondictionary",o="zjsmoduleautosuggestionkeytype",n="zjsmoduleautosuggestionfuncturnonoffkey",u="zjsmoduleautosuggestionisstillloadingkey";zjs.extendCore({moduleUiAutosuggestionOption:{minlength:1,minheight:18,customcss:!0,labelPlaceholder:!1,focusshowsuggestion:!1,autofocus:!1,panelmaxheight:200,multiline:!0,multichoice:!1,forceSelectFromList:!1,create:!1,delimiter:",",mentionmode:!1,usedproperty:"text",searchproperty:"text",usedSearchRegExp:null,searchMatchStartWith:!1,usedpropertytext:!1,limit:0,noneValue:"",source:[],sourceUrl:"",initSourceUrl:"",sourceUrlValueSelector:function(e){return e},sourceDataStructure:"",sourceDataSelector:function(e,t){return e},cacheResponse:!0,useSuggestedValueWhenEnter:!0,generateTopItem:null,itemtemplate:'<div class="item">${text}</div>',itemLinkFormat:"",itemhighlightclass:"highlight",defaultPanelHeight:0,selectLikeInput:!1,defaultSuggestionMoreText:"",suggestIconRightChoose:' <code class="icon-right"><b>&rarr;</b></code> press Right to choose',suggestIconEnterChoose:' <code class="icon-enter"><b>&crarr;</b></code> press Enter to choose',suggestIconEnterCreate:' <code class="icon-enter"><b>&crarr;</b></code> press Enter to add this keyword'}});var r="zui-autosuggestion-wrap",l="focus",g="zui-autosuggestion-multi-wrap",c="zui-autosuggestion-with-token",d='<div class="'+r+'"><div class="zui-autosuggestion-inputwrap"><div class="zui-autosuggestion-placeholder"></div><input class="zui-autosuggestion-input" autocomplete="off" /><textarea class="zui-autosuggestion-input" autocomplete="off"></textarea><div class="zui-autosuggestion-input-test-wrap"><div class="zui-autosuggestion-input-test"></div></div><div class="zui-estimate-height-wrap"><div class="zui-autosuggestion-input zui-estimate-height"></div></div></div><div class="zui-autosuggestion-panel-wrap zui-panel-hide"><div class="zui-autosuggestion-panel-scroll"><div class="zui-autosuggestion-panel-content"></div></div></div></div>',h="zui-autosuggestion-item",p='<div class="'+h+'"></div>',f='<a class="'+h+'"></a>',m="oninput"in document.createElement("input"),v=function(r,p){var f=zjs(r),v=f.getData(e),y=!1;if(v)return f.setData(e,zjs.extend(v,p)),void(y=!0);var S=function(){y&&(v=f.getData(e),y=!1)},j=!0,x=!1;v=zjs.clone(zjs.moduleUiAutosuggestionOption);var C=f.getAttr("data-option","");if(zjs.isString(C)&&""!=C.trim()&&(v=zjs.extend(v,C.jsonDecode())),f.removeAttr("data-option"),!v.sourceUrl){var D=f.getAttr("data-autocomplete-path","");""!==D&&(v.sourceUrl=D)}zjs.hook({after_setAttr:function(e,t,s){if(e===r&&"data-autocomplete-path"===t){var a=f.getAttr("data-autocomplete-path","");""==a?j=!1:(j=!0,v.sourceUrl=a,Q.setDataSourceUrl(v.sourceUrl))}}}),void 0!==p&&(v=zjs.extend(v,p));var V=f.getValue(""),E=!1;(zjs.isString(v.source)||f.is("select"))&&(E=zjs.isString(v.source)?zjs(v.source):f,E.count()>0?(x=f.is("select"),v.multichoice=!1,v.usedproperty="id.text",v.source={},E.find("option").eachElement(function(e,t){var s=zjs(e).getValue(),a=zjs(e).getInnerText();s!==v.noneValue&&(v.source[s]=a,s==v.noneValue&&(s,a),0===t&&(s,s!=v.noneValue&&f.setValue(s,!0)),e.selected&&s!=v.noneValue&&(V=a,x?E.setValue(s,!0):f.setValue(a,!0)))}),E.hide(),x?v.selectLikeInput&&E.addClass("select-like-input"):E.removeAttr("required").removeClass("required")):E=!1),x&&!v.selectLikeInput&&(v.focusshowsuggestion=!0);var I=v.searchproperty;if("id.text"==v.usedproperty&&(v.searchproperty="text",v.usedproperty="id",I="id.text"),v.mentionmode&&(v.multichoice=!1),v.multichoice&&(v.multiline=!1),v.limit=parseInt(v.limit),isNaN(v.limit)&&(v.limit=0),v.defaultPanelHeight=parseInt(v.defaultPanelHeight),isNaN(v.defaultPanelHeight)&&(v.defaultPanelHeight=0),v.usedSearchRegExp&&zjs.isObject(v.usedSearchRegExp)){var b={used:/^(.+\(\d{1,}\))$/,search:/^(.+)\s\(\d{1,}\)$/};v.usedSearchRegExp.used&&(zjs.isString(v.usedSearchRegExp.used)&&(v.usedSearchRegExp.used=new RegExp(v.usedSearchRegExp.used)),zjs.isRegExp(v.usedSearchRegExp.used)&&(b.used=v.usedSearchRegExp.used)),v.usedSearchRegExp.search&&(zjs.isString(v.usedSearchRegExp.search)&&(v.usedSearchRegExp.search=new RegExp(v.usedSearchRegExp.search)),zjs.isRegExp(v.usedSearchRegExp.search)&&(b.search=v.usedSearchRegExp.search)),v.usedSearchRegExp=b}f.setData(e,v);var k=zjs(d);v.multiline?k.find("input.zui-autosuggestion-input").remove():k.find("textarea.zui-autosuggestion-input").remove(),f.setData(t,k),k.insertAfter(f);var R=k.find(".zui-autosuggestion-inputwrap"),T=k.find(".zui-autosuggestion-placeholder"),L=k.find("input.zui-autosuggestion-input,textarea.zui-autosuggestion-input"),A=k.find(".zui-autosuggestion-panel-wrap"),M=k.find(".zui-autosuggestion-panel-scroll"),U=k.find(".zui-autosuggestion-panel-content"),H=!1;if(L.findUp("form").setAttr("autocomplete","off"),f.setData(s,R),f.setData(a,L.item(0,!0)),v.multiline?(H=k.find(".zui-estimate-height"),k.addClass("multiline")):k.find(".zui-estimate-height-wrap").remove(),v.suggestIconRightChoose&&T.setData("suggestIconRightChoose",v.suggestIconRightChoose),v.suggestIconEnterChoose&&T.setData("suggestIconEnterChoose",v.suggestIconEnterChoose),v.suggestIconEnterCreate&&T.setData("suggestIconEnterCreate",v.suggestIconEnterCreate),!v.customcss){var _={width:f.width(),height:f.height(),marginLeft:f.getStyle("margin-left",!0),marginRight:f.getStyle("margin-right",!0),marginTop:f.getStyle("margin-top",!0),marginBottom:f.getStyle("margin-bottom",!0),paddingLeft:f.getStyle("padding-left",!0),paddingRight:f.getStyle("padding-right",!0),paddingTop:f.getStyle("padding-top",!0),paddingBottom:f.getStyle("padding-bottom",!0),borderLeft:f.getStyle("border-left-width",!0),borderRight:f.getStyle("border-right-width",!0),borderTop:f.getStyle("border-top-width",!0),borderBottom:f.getStyle("border-bottom",!0),font:f.getStyle("font"),boxSizing:f.getStyle("box-sizing")};"content-box"==_.boxSizing&&(_.width-=_.paddingLeft+_.paddingRight+_.borderLeft+_.borderRight,_.height-=_.paddingTop+_.paddingBottom+_.borderTop+_.borderBottom),R.copyStyleFrom(f),R.setStyle({position:"relative",cursor:"text",width:_.width,height:_.height,"-webkit-text-fill-color":"initial"}),L.setStyle({top:T.top(),font:_.font,width:_.width})}var F=!1;v.multichoice?(k.addClass(g),F=k.find(".zui-autosuggestion-input-test").setStyle({margin:L.getStyle("margin"),padding:L.getStyle("padding"),font:L.getStyle("font"),border:L.getStyle("border")})):k.find(".zui-autosuggestion-input-test-wrap").remove(),A.height(v.panelmaxheight),M.makeScrollbar({bounce:!1,usecss:!1,usekey:!1,customCssClass:"zui-autosuggestion-panel",autoUseDefaultWithMobile:!0}),A.addClass("zui-panel-hide");var P=function(e){var t=Math.min(e,v.panelmaxheight);A.height(t),M.scrollHeight(t).refreshScroll().scrollToTop(),A.find(".zui-scrollbar").top(0)},B="",O=function(){return f.getAttr("data-placeholder",f.getAttr("placeholder",""))},W=0,q=0,N="",$="",G=0,K="",J=O();v.labelPlaceholder&&""!==J&&(zjs("<span>").addClass("placeholder").html(J).insertAfter(R),R.addClass("label-placeholder")),w(T,O()),f.hide(),""!==V&&(L.setValue(N=V,!0),w(T,""),k.addClass("has-value"));var Q=new zjs.dictionary(v.source,I);Q.setOnStartEndLoading(function(){f.setData(u,!0),f.trigger("ui:autosuggestion:startasyncsearch")},function(){f.setData(u,!1),f.trigger("ui:autosuggestion:endasyncsearch")}),v.cacheResponse||Q.setCacheResponse(!1),"function"==typeof v.sourceUrlValueSelector&&Q.setDataSourceUrlValueSelector(v.sourceUrlValueSelector),""!=v.sourceUrl&&Q.setDataSourceUrl(v.sourceUrl),""!=v.initSourceUrl&&(Q.setDataSourceUrl(v.initSourceUrl),""===v.sourceUrl&&Q.useCacheDataSource(!0),Q.getDataFromDataSource()),""!=v.sourceDataStructure&&Q.setDataSourceDataStructure(v.sourceDataStructure),"function"==typeof v.sourceDataSelector&&Q.setDataSourceDataSelector(v.sourceDataSelector),v.limit>0&&Q.setDefaultSearchResultLimit(v.limit),v.searchMatchStartWith&&Q.setSearchMatchStartWith(!0),f.setData(i,Q);var X=function(e){var t=null,s=null,a=e.match(v.usedSearchRegExp.used);return a&&a.length>=2&&a[1]&&(t=a[1]),a=e.match(v.usedSearchRegExp.search),a&&a.length>=2&&a[1]&&(s=a[1]),!(!t||!s)&&{used:t,search:s}},Y=!0,Z=function(){x&&(""===f.getValue()?(N="",w(T,""),L.setValue("",!0),k.removeClass("has-value")):k.addClass("has-value")),A.addClass("zui-panel-hide"),f.trigger("ui:autosuggestion:blur")},ee=function(e,t){S();var s=e.getKeyCode();if(38!=s&&40!=s)if(37!=s){if(39==s||9==s)return e.stopPropagation(),"keydown"==t&&se(),void(9==s&&(A.addClass("zui-panel-hide"),Z()));if(13!=s){if(27==s)return v.multichoice,void ae();8!=s?(m&&"input"==t?ne(!0):"keyup"==t&&ne(!0),f.trigger("input")):oe()}else if(v.multichoice)""!=L.getValue("")&&("keydown"==t&&ie(),e.preventDefault());else{var a=A.hasClass("zui-panel-hide");"keydown"==t&&ie(),v.multiline&&(e.preventDefault(),de(),a&&function(){f.findUp("form").submit()}.delay(1))}}else e.stopPropagation();else"keydown"==t&&te(e,s)},te=function(e,t){if(e.preventDefault(),e.stopPropagation(),Y){U.find("."+h).removeClass(v.itemhighlightclass),40==t&&W++,38==t&&W--,W>q&&(W=0),W<0&&(W=q);var s="";if(0===W)s=N,w(T,$,N);else{var a=U.find("."+h+'[data-highlight="'+W+'"]'),i=a.getData("searchtempdata");a.addClass(v.itemhighlightclass),s=i[v.searchproperty],w(T,"")}L.setValue(s,!0),v.multichoice&&(L.width(F.setInnerHTML(L.getValue("")).width()+10),A.top(R.height())),i&&v.usedproperty in i?f.setValue(i[v.usedproperty],!0):("text"==v.usedproperty||v.usedpropertytext)&&f.setValue(N,!0),v.multiline&&de(),M.scrollToElement(a),"object"==typeof i&&(f.trigger("ui:autosuggestion:highlight",i),""!=v.itemLinkFormat&&(B=a.getAttr("href")))}},se=function(){if(Y&&""!=$&&(L.setValue(N=$,!0),w(T,$=""),W<=0&&(W=G),A.addClass("zui-panel-hide"),!(W<=0))){var e=U.find("."+h+'[data-highlight="'+W+'"]').getData("searchtempdata");"object"==typeof e&&(v.multichoice?(L.setValue("",!0).width(10),e&&v.usedproperty in e&&(zjs('<div class="zui-autosuggestion-token"></div>').setInnerHTML(e[v.searchproperty]).setAttr("data-value",e[v.usedproperty]).insertBefore(L),k.addClass(c),ce())):(v.multiline&&de(),e&&v.usedproperty in e&&(K=e[v.usedproperty],N=e[v.searchproperty],L.setValue(N,!0),f.setValue(K,!0))),E&&E.setValue(e.id,!0),f.trigger("ui:autosuggestion:choice",e))}},ae=function(){Y&&(A.hasClass("zui-panel-hide")||L.setValue(N,!0),"text"===v.usedproperty||v.usedpropertytext?(f.setValue(N,!0),w(T,""===N?O():$="")):f.setValue("",!0),A.addClass("zui-panel-hide"),U.find("."+h).removeClass("highlight"),W=0,G=0,""!==N&&v.create&&v.suggestIconEnterCreate&&w(T,N,N,!0),v.multiline&&de())},ie=function(){if(N=L.getValue(""),Y){var e={text:N},t=null;if((G||W||!A.hasClass("zui-panel-hide")||v.create)&&""!=N){if(W>0)t=U.find("."+h+'[data-highlight="'+W+'"]');else if(G>0&&v.useSuggestedValueWhenEnter)t=U.find("."+h+'[data-highlight="'+G+'"]');else if("id"==v.usedproperty){var s=U.find("."+h);s.count()>0&&(t=s.item(0))}else v.create&&(Q.addIndex({[v.usedproperty]:N,[v.searchproperty]:N},v.searchproperty),e={text:N,[v.usedproperty]:N,[v.searchproperty]:N});t&&(e=t.getData("searchtempdata"))}if(""!=N&&w(T,$=""),A.addClass("zui-panel-hide"),"object"==typeof e&&(v.multichoice?(L.setValue("",!0).width(10),N="",e&&v.usedproperty in e&&(zjs('<div class="zui-autosuggestion-token"></div>').setInnerHTML(e.text).setAttr("data-value",e[v.usedproperty]).insertBefore(L),k.addClass(c)),ce()):e&&(w(T,$=""),A.addClass("zui-panel-hide"),v.searchproperty in e&&L.setValue(N=e[v.searchproperty],!0),v.usedproperty in e&&f.setValue(e[v.usedproperty],!0)),E&&E.setValue(e.id,!0),f.trigger("ui:autosuggestion:choice",Object.assign({},{_byEnter:!0,_element:t.item(0,1)},e)),""!=v.itemLinkFormat&&t)){var a=t.getAttr("href");a==B&&(window.location.href=a)}}},oe=function(){v.multichoice&&Y&&""==L.getValue("")&&(k.find(".zui-autosuggestion-token").lastChild().remove(),ce(),""==f.getValue()&&(k.removeClass(c),$="",function(){T.top(L.top()).left(L.left()).show(),w(T,O())}.delay(80)))},ne=function(e){var t=L.getValue("");if(N=t,""!==t?k.addClass("has-value"):k.removeClass("has-value"),Y){if(w(T,""),v.multichoice){if(L.width(F.setInnerHTML(t).width()+10),""==t)return""==f.getValue()?w(T.show(),O()):T.hide(),$="",w(T,O()),void A.addClass("zui-panel-hide");T.top(L.top()).left(L.left()).show()}else{if(v.multiline&&de(),"text"==v.usedproperty||v.usedpropertytext?f.setValue(t,!0):f.setValue("",!0),""==t&&x)return void pe();if(""==t||e&&t.length<v.minlength)return $="",""!=t?w(T,"",t):w(T,O()),void A.addClass("zui-panel-hide")}if(e&&j){W=0,$="",G=0;var s=t;f.trigger("ui:autosuggestion:beforesearch",{value:s}),f.getData(i).asyncSearch(s,function(e,a){if(L.is(":focus")){if(f.trigger("ui:autosuggestion:searchresult",{value:s,result:e,focused:!0}),zjs.isFunction(v.generateTopItem)){var i=v.generateTopItem(t,e,a,f.getData(u));i&&(i._isGeneratedTopItem=!0,e=[i].concat(e))}if(N=L.getValue(),0!==e.length&&""!==N||A.addClass("zui-panel-hide"),""!==N)if(0!==e.length){q=e.length,A.removeClass("zui-panel-hide").top(R.height()),U.setInnerHTML("");var o=0;zjs.eachItem(e,function(e,s){var a=z(v,U,e,s);if(o+=a.height(),a.hover(ue),a.on("mousedown",le,{passive:!0}),""==$){var i=e[v.searchproperty].toLowerCase(),n=t.toLowerCase();0===i.indexOf(n)&&($=t+e[v.searchproperty].substr(t.length),G=s+1)}}),w(T,$,t),P(o)}else N===s&&v.create&&v.suggestIconEnterCreate&&w(T,N,N,!0);else w(T,O())}else f.trigger("ui:autosuggestion:searchresult",{value:s,result:e,focused:!1})})}}else f.setValue(t,!0)};f.setData(o,ne);var ue=function(e){U.find("."+h).removeClass(v.itemhighlightclass);var t=zjs(this).addClass(v.itemhighlightclass).getData("searchtempdata");"object"==typeof t&&f.trigger("ui:autosuggestion:highlight",t)},re=function(e,t){t=t||!1,"object"==typeof e&&(N=e.text,L.setValue(N,!0),k.addClass("has-value"),v.multichoice?(L.setValue("",!0).width(10),e&&v.usedproperty in e&&(zjs('<div class="zui-autosuggestion-token"></div>').setInnerHTML(e.text).setAttr("data-value",e[v.usedproperty]).insertBefore(L),k.addClass(c),ce())):(e&&v.usedproperty in e&&f.setValue(e[v.usedproperty],!0),v.multiline&&de()),E&&E.setValue(e.id,!0),W=t?t.getAttr("data-highlight",0).toInt():0,w(T,$=""),A.addClass("zui-panel-hide"),t&&(L.focus(),f.trigger("ui:autosuggestion:choice",e)))},le=function(e){var t=zjs(this),s=t.getData("searchtempdata");if(re(Object.assign({},{_byClick:!0,_element:t.item(0,1)},s),t),""!=v.itemLinkFormat&&t){var a=t.getAttr("href");a&&(window.location.href=a)}},ge=function(e){e=e||!1,Y=e,Y||w(T,"")};f.setData(n,ge);var ce=function(){var e=[];k.find(".zui-autosuggestion-token").eachElement(function(t){e.push(zjs(t).getAttr("data-value",""))}),f.setValue(e.join(v.delimiter),!0)},de=function(){H.setInnerHTML(L.getValue());var e=Math.max(H.height(),v.minheight);L.height(e),A.hasClass("zui-panel-hide")||A.top(R.height())};v.multiline&&(zjs(window).on("resize",de),de.delay(1)),m?L.on("keydown",function(e,t){ee(e,"keydown")}).on("input",function(e,t){ee(e,"input")}):L.on("keydown",function(e,t){ee(e,"keydown")}).on("keypress",function(e,t){ee(e,"keypress")}).on("keyup",function(e,t){ee(e,"keyup")}).on("mouseup",function(e,t){ee(e,"keyup")}),L.on("blur",function(e){Z.delay(100)}),R.on("click",function(){L.focus()}),f.on("_hardSelectValue",function(e){var t=Q.getItemById(this.getValue());re(t,!1)});var he=!1;f.on("focus",function(){he||L.focus()}),L.on("focus",function(){k.addClass(l),he=!0,f.trigger("focus"),he=!1}).on("blur",function(){k.removeClass(l),E&&""===L.getValue().trim()&&E.setValue(v.noneValue,!0),f.trigger("blur")}).on("keyup",function(){f.trigger("keyup")}),v.autofocus&&L.focus();var pe=function(){var e=f.getData(i).getItemsLimit();if(0!=e.length){q=e.length,A.removeClass("zui-panel-hide").top(R.height()),U.setInnerHTML("");var t=0;zjs.eachItem(e,function(e,s){var a=z(v,U,e,s);t+=a.height(),a.hover(ue),a.on("mousedown",le,{passive:!0})}),""!==v.defaultSuggestionMoreText&&(t+=zjs("<div>").addClass(h).addClass("more-text").html(v.defaultSuggestionMoreText).appendTo(U).height()),P(v.defaultPanelHeight>0?v.defaultPanelHeight:t)}};if(v.focusshowsuggestion&&L.on("focus",function(e){if(x||""==N){if(e&&e.getTarget){var t=e.getTarget();if(t){if(zjs(t).hasClass("zui-autosuggestion-token"))return;if(zjs(t).hasClass(h))return}}v.defaultPanelHeight>0?pe(v.defaultPanelHeight):function(){pe()}.delay(100)}}),zjs(document).on("click",function(e){var t=zjs(e.target()),s=t.findUp(".zui-autosuggestion-wrap");if(s.count()>0){var a=s.find(".zui-autosuggestion-panel-wrap");if(a.count()>0&&a.item(0,!0)===A.item(0,!0))return}(function(){A.addClass("zui-panel-hide")}).delay(1)}),v.multichoice&&R.on("click",".zui-autosuggestion-token",function(e){this.remove(),ce(),""==f.getValue()&&(k.removeClass(c),""==N&&($="",w(T,O()))),function(){T.show().top(L.top()).left(L.left())}.delay(50)}),v.multichoice&&""!=N){var fe=!0;v.usedSearchRegExp?(zjs.eachItem(N.split(new RegExp("\\s*"+v.delimiter+"\\s*")),function(e){var t=X(e.trim());t&&(Q.addIndex({[v.usedproperty]:t.used,[v.searchproperty]:t.search},v.searchproperty),zjs('<div class="zui-autosuggestion-token"></div>').setInnerHTML(t.search).setAttr("data-value",t.used).insertBefore(L))}),ce()):"id"==v.usedproperty?zjs.eachItem(N.split(new RegExp("\\s*"+v.delimiter+"\\s*")),function(e){Q.asyncGetItemById(e,function(e){e&&(zjs('<div class="zui-autosuggestion-token"></div>').setInnerHTML(e.text).setAttr("data-value",e[v.usedproperty]).insertBefore(L),ce())})}):"text"==v.usedproperty?zjs.eachItem(N.split(new RegExp("\\s*"+v.delimiter+"\\s*")),function(e){Q.asyncSearch(e,function(e){if(!(e.length<=0)){var t=e[0];zjs('<div class="zui-autosuggestion-token"></div>').setInnerHTML(t.text).setAttr("data-value",t[v.usedproperty]).insertBefore(L),ce()}})}):fe=!1,fe&&(k.addClass(c),L.setValue(N="",!0),T.hide())}if(!v.multichoice&&""!=N&&v.usedSearchRegExp){var me=X(N.trim());me&&(Q.addIndex({[v.usedproperty]:me.used,[v.searchproperty]:me.search},v.searchproperty),f.setValue(me.used,!0),L.setValue(N=me.search,!0))}f.setData("setValueCustomMethod","autosuggestionSetValue")},z=function(e,t,s,a){var i;if(""!=e.itemLinkFormat){var o=zjs.isFunction(e.itemLinkFormat)?e.itemLinkFormat(s,a):e.itemLinkFormat;i=zjs(f).setAttr("href",o.format(s))}else i=zjs(p);i.appendTo(t),i.setData("searchtempdata",s),i.setAttr("data-highlight",a+1);var n="";"function"==typeof e.itemtemplate&&(n=e.itemtemplate(s,a)),"string"==typeof e.itemtemplate&&(n=e.itemtemplate),"string"==typeof n&&(n=n.format(s));zjs(n).appendTo(i);return i},y=function(e){return!!zjs(e).getData(i)},S=function(t,s){var a=zjs(t),o=a.getData(i),n=a.getData(e);o&&o.addIndex(s,n.searchproperty)},j=function(e,t,s){var a=zjs(e),o=a.getData(i);o&&o.removeIndex(t,s)},x=function(e){var t=zjs(e),s=t.getData(i);s&&s.resetIndex()},C=function(e){var t=zjs(e),a=t.getData(s);a?a.trigger("click"):t.focus()},D=function(e,t){var s=zjs(e),a=s.getData(n,!1);a&&a(t)},w=function(e,t,s,a){t=t||"",s=s||"",a=a||!1;var i=t;s&&t&&(i='<span class="_hide">'+t.substr(0,s.length)+"</span>"+t.substr(s.length),t.length>s.length&&e.getData("suggestIconRightChoose")?i+='<i class="_suggest-msg _right-choose">'+e.getData("suggestIconRightChoose")+"</i>":a&&t.length===s.length&&e.getData("suggestIconEnterCreate")?i+='<i class="_suggest-msg _enter-create">'+e.getData("suggestIconEnterCreate")+"</i>":!a&&t.length===s.length&&e.getData("suggestIconEnterChoose")&&(i+='<i class="_suggest-msg _enter-choose">'+e.getData("suggestIconEnterChoose")+"</i>")),e.setInnerHTML(i)};zjs.extendMethod({isAutosuggestion:function(){return y(this.item(0,1))},makeAutosuggestion:function(e){return this.eachElement(function(t){v(t,e)})},autosuggestionAddindex:function(e){return this.eachElement(function(t){S(t,e)})},autosuggestionRemoveindex:function(e,t){return this.eachElement(function(s){j(s,e,t)})},autosuggestionResetIndex:function(){return this.eachElement(function(e){x(e)})},autosuggestionFocus:function(){return this.eachElement(function(e){C(e)})},autosuggestionTurnOff:function(){return this.eachElement(function(e){D(e,!1)})},autosuggestionTurnOn:function(){return this.eachElement(function(e){D(e,!0)})},autosuggestionSetValue:function(e,t){return e=e||"",t=t||!1,this.eachElement(function(s){var i=zjs(s).getData(a);if(i)try{zjs(s).setValue(e,!0),"SELECT"===zjs(s).tagName()?zjs(s).trigger("_hardSelectValue"):(i.value=e,zjs(s).getData(o)(t))}catch(e){}else zjs(s).setValue(e,!0)})},autosuggestionDisable:function(e){return e=e||!1,this.eachElement(function(s){var i=zjs(s).getData(a),o=zjs(s).getData(t);if(i)try{i.disabled=e,e?o.addClass("disabled"):o.removeClass("disabled")}catch(e){}})}}),zjs.hook({after_setInnerHTML:function(e){zjs(e).find(".zautosuggestion").makeAutosuggestion()},after_insertDOM:function(e){zjs(e).is(".zautosuggestion")&&zjs(e).makeAutosuggestion(),zjs(e).find(".zautosuggestion").makeAutosuggestion()}}),zjs(function(){zjs(".zautosuggestion").makeAutosuggestion()}),"required"in zjs&&zjs.required("ui.autosuggestion")});